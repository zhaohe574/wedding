import{d as e,s as t,O as a,P as s,aS as l,o as r,h as u,e as n,w as c,g as d,F as _,i as g,b as f,j as i,r as o,a as x,m as y,I as m,G as p,l as b,y as v,t as k,A as h,k as w,aP as C,aD as j,aJ as $}from"./index-e3492752.js";import{_ as z}from"./navigation-bar.2687311c.js";import{_ as F}from"./page-meta.a4be6114.js";import{_ as I}from"./empty.dfd7c9cf.js";import{g as P,a as S,b as A,c as B,d as D,e as G}from"./orderChange.66dcaaa9.js";import{_ as J}from"./_plugin-vue_export-helper.1b428a4d.js";const O=J(e({__name:"list",setup(e){const J=[{label:"变更申请",value:"change"},{label:"转让申请",value:"transfer"},{label:"暂停申请",value:"pause"}],O=t("change"),V=t([]),X=t(!1),Y=t(1),q=t(!0),E=async(e=!1)=>{if(!X.value){X.value=!0;try{e&&(Y.value=1,V.value=[]);const t={page:Y.value,page_size:10};let a;a="change"===O.value?await P(t):"transfer"===O.value?await S(t):await A(t);const s=a.lists||[];e?V.value=s:V.value.push(...s),q.value=10===s.length}catch(t){console.error(t)}finally{X.value=!1}}},H=()=>{q.value&&!X.value&&(Y.value++,E())};return a((e=>{e.type&&(O.value=e.type)})),s((()=>{E(!0)})),l((()=>{H()})),(e,t)=>{const a=o(x("navigation-bar"),z),s=o(x("page-meta"),F),l=y,P=m,S=p,A=b,Y=$;return r(),u(_,null,[n(s,{"page-style":e.$theme.pageStyle},{default:c((()=>[n(a,{title:"我的申请","front-color":e.$theme.navColor,"background-color":e.$theme.navBgColor},null,8,["front-color","background-color"])])),_:1},8,["page-style"]),n(l,{class:"change-list"},{default:c((()=>[d(" 类型筛选 "),n(l,{class:"type-tabs bg-white sticky top-0 z-10"},{default:c((()=>[n(P,{"scroll-x":"",class:"whitespace-nowrap"},{default:c((()=>[(r(),u(_,null,g(J,(e=>n(l,{key:e.value,class:v(["inline-block px-4 py-3 text-sm",O.value===e.value?"text-primary border-b-2 border-primary font-medium":"text-gray-500"]),onClick:t=>{return a=e.value,O.value=a,void E(!0);var a}},{default:c((()=>[i(k(e.label),1)])),_:2},1032,["class","onClick"]))),64))])),_:1})])),_:1}),d(" 列表 "),n(l,{class:"p-3"},{default:c((()=>[X.value&&0===V.value.length?(r(),f(l,{key:0,class:"py-20 text-center text-gray-400"},{default:c((()=>[i(" 加载中... ")])),_:1})):0===V.value.length?(r(),f(l,{key:1,class:"py-20 text-center text-gray-400"},{default:c((()=>[n(S,{src:I,class:"w-32 h-32 mx-auto mb-4",mode:"aspectFit"}),n(A,null,{default:c((()=>[i("暂无申请记录")])),_:1})])),_:1})):(r(),f(l,{key:2},{default:c((()=>[d(" 变更申请列表 "),"change"===O.value?(r(!0),u(_,{key:0},g(V.value,(e=>(r(),f(l,{key:e.id,class:"bg-white rounded-lg mb-3 p-4",onClick:t=>{return a=e.id,void w({url:`/pages/order_change/change_detail?id=${a}`});var a}},{default:c((()=>[n(l,{class:"flex justify-between items-start mb-2"},{default:c((()=>[n(l,null,{default:c((()=>[n(A,{class:"text-xs text-gray-400"},{default:c((()=>[i(k(e.change_sn),1)])),_:2},1024),n(l,{class:"flex items-center mt-1"},{default:c((()=>{return[n(l,{class:v(["tag",(a=e.change_type,{1:"bg-blue-100 text-blue-600",2:"bg-orange-100 text-orange-600",3:"bg-green-100 text-green-600"}[a]||"bg-gray-100 text-gray-600")])},{default:c((()=>[i(k(e.change_type_desc),1)])),_:2},1032,["class"]),n(l,{class:v(["tag ml-2",(t=e.change_status,{0:"bg-orange-100 text-orange-600",1:"bg-blue-100 text-blue-600",2:"bg-red-100 text-red-600",3:"bg-green-100 text-green-600",4:"bg-gray-100 text-gray-600"}[t]||"bg-gray-100 text-gray-600")])},{default:c((()=>[i(k(e.change_status_desc),1)])),_:2},1032,["class"])];var t,a})),_:2},1024)])),_:2},1024),n(A,{class:"text-xs text-gray-400"},{default:c((()=>[i(k(e.create_time),1)])),_:2},1024)])),_:2},1024),d(" 改期 "),1===e.change_type?(r(),f(l,{key:0,class:"text-sm text-gray-600 mt-2"},{default:c((()=>[n(A,null,{default:c((()=>[i("服务日期: ")])),_:1}),n(A,{class:"text-gray-400"},{default:c((()=>[i(k(e.old_service_date),1)])),_:2},1024),n(A,{class:"mx-1"},{default:c((()=>[i("→")])),_:1}),n(A,{class:"text-primary"},{default:c((()=>[i(k(e.new_service_date),1)])),_:2},1024)])),_:2},1024)):2===e.change_type?(r(),u(_,{key:1},[d(" 换人 "),n(l,{class:"text-sm text-gray-600 mt-2"},{default:c((()=>[n(A,null,{default:c((()=>[i("人员: ")])),_:1}),n(A,{class:"text-gray-400"},{default:c((()=>[i(k(e.old_staff_name),1)])),_:2},1024),n(A,{class:"mx-1"},{default:c((()=>[i("→")])),_:1}),n(A,{class:"text-primary"},{default:c((()=>[i(k(e.new_staff_name),1)])),_:2},1024),0!==e.price_diff?(r(),f(A,{key:0,class:v([e.price_diff>0?"text-red-500":"text-green-500","ml-2"])},{default:c((()=>[i(k(e.price_diff>0?"+":"")+k(e.price_diff)+"元 ",1)])),_:2},1032,["class"])):d("v-if",!0)])),_:2},1024)],2112)):3===e.change_type?(r(),u(_,{key:2},[d(" 加项 "),n(l,{class:"text-sm text-gray-600 mt-2"},{default:c((()=>[n(A,null,{default:c((()=>[i("新增: ")])),_:1}),n(A,{class:"text-primary"},{default:c((()=>[i(k(e.add_staff_name),1)])),_:2},1024),n(A,{class:"text-gray-400 ml-1"},{default:c((()=>[i("("+k(e.add_package_name)+")",1)])),_:2},1024),n(A,{class:"text-red-500 ml-2"},{default:c((()=>[i("+"+k(e.add_price)+"元",1)])),_:2},1024)])),_:2},1024)],2112)):d("v-if",!0),e.apply_reason?(r(),f(l,{key:3,class:"text-xs text-gray-400 mt-2"},{default:c((()=>[i(" 原因: "+k(e.apply_reason),1)])),_:2},1024)):d("v-if",!0),d(" 操作按钮 "),0===e.change_status?(r(),f(l,{key:4,class:"mt-3 flex justify-end"},{default:c((()=>[n(Y,{class:"btn-outline text-red-500 border-red-500",onClick:h((t=>(async e=>{if((await C({title:"提示",content:"确定要取消该变更申请吗？"})).confirm)try{await B({id:e.id}),j({title:"已取消"}),E(!0)}catch(t){j({title:t.message||"操作失败",icon:"none"})}})(e)),["stop"])},{default:c((()=>[i(" 取消申请 ")])),_:2},1032,["onClick"])])),_:2},1024)):d("v-if",!0)])),_:2},1032,["onClick"])))),128)):d("v-if",!0),d(" 转让申请列表 "),"transfer"===O.value?(r(!0),u(_,{key:1},g(V.value,(e=>(r(),f(l,{key:e.id,class:"bg-white rounded-lg mb-3 p-4",onClick:t=>{return a=e.id,void w({url:`/pages/order_change/transfer_detail?id=${a}`});var a}},{default:c((()=>[n(l,{class:"flex justify-between items-start mb-2"},{default:c((()=>[n(l,null,{default:c((()=>[n(A,{class:"text-xs text-gray-400"},{default:c((()=>[i(k(e.transfer_sn),1)])),_:2},1024),n(l,{class:"mt-1"},{default:c((()=>{return[n(l,{class:v(["tag",(t=e.transfer_status,{0:"bg-orange-100 text-orange-600",1:"bg-blue-100 text-blue-600",2:"bg-purple-100 text-purple-600",3:"bg-green-100 text-green-600",4:"bg-red-100 text-red-600",5:"bg-gray-100 text-gray-600"}[t]||"bg-gray-100 text-gray-600")])},{default:c((()=>[i(k(e.transfer_status_desc),1)])),_:2},1032,["class"])];var t})),_:2},1024)])),_:2},1024),n(A,{class:"text-xs text-gray-400"},{default:c((()=>[i(k(e.create_time),1)])),_:2},1024)])),_:2},1024),n(l,{class:"text-sm text-gray-600 mt-2"},{default:c((()=>[n(l,{class:"flex items-center"},{default:c((()=>[n(A,{class:"text-gray-400 w-16"},{default:c((()=>[i("转让方:")])),_:1}),n(A,null,{default:c((()=>[i(k(e.from_user_name)+" ("+k(e.from_user_mobile)+")",1)])),_:2},1024)])),_:2},1024),n(l,{class:"flex items-center mt-1"},{default:c((()=>[n(A,{class:"text-gray-400 w-16"},{default:c((()=>[i("接收方:")])),_:1}),n(A,{class:"text-primary"},{default:c((()=>[i(k(e.to_user_name)+" ("+k(e.to_user_mobile)+")",1)])),_:2},1024)])),_:2},1024)])),_:2},1024),e.transfer_reason?(r(),f(l,{key:0,class:"text-xs text-gray-400 mt-2"},{default:c((()=>[i(" 原因: "+k(e.transfer_reason),1)])),_:2},1024)):d("v-if",!0),d(" 操作按钮 "),e.transfer_status<=1&&e.is_from_user?(r(),f(l,{key:1,class:"mt-3 flex justify-end"},{default:c((()=>[n(Y,{class:"btn-outline text-red-500 border-red-500",onClick:h((t=>(async e=>{if((await C({title:"提示",content:"确定要取消该转让申请吗？"})).confirm)try{await D({id:e.id}),j({title:"已取消"}),E(!0)}catch(t){j({title:t.message||"操作失败",icon:"none"})}})(e)),["stop"])},{default:c((()=>[i(" 取消转让 ")])),_:2},1032,["onClick"])])),_:2},1024)):d("v-if",!0)])),_:2},1032,["onClick"])))),128)):d("v-if",!0),d(" 暂停申请列表 "),"pause"===O.value?(r(!0),u(_,{key:2},g(V.value,(e=>(r(),f(l,{key:e.id,class:"bg-white rounded-lg mb-3 p-4",onClick:t=>{return a=e.id,void w({url:`/pages/order_change/pause_detail?id=${a}`});var a}},{default:c((()=>[n(l,{class:"flex justify-between items-start mb-2"},{default:c((()=>[n(l,null,{default:c((()=>[n(A,{class:"text-xs text-gray-400"},{default:c((()=>[i(k(e.pause_sn),1)])),_:2},1024),n(l,{class:"flex items-center mt-1"},{default:c((()=>{return[n(l,{class:v(["tag",(a=e.pause_type,{1:"bg-red-100 text-red-600",2:"bg-orange-100 text-orange-600",3:"bg-blue-100 text-blue-600",4:"bg-gray-100 text-gray-600"}[a]||"bg-gray-100 text-gray-600")])},{default:c((()=>[i(k(e.pause_type_desc),1)])),_:2},1032,["class"]),n(l,{class:v(["tag ml-2",(t=e.pause_status,{0:"bg-orange-100 text-orange-600",1:"bg-blue-100 text-blue-600",2:"bg-green-100 text-green-600",3:"bg-red-100 text-red-600",4:"bg-gray-100 text-gray-600"}[t]||"bg-gray-100 text-gray-600")])},{default:c((()=>[i(k(e.pause_status_desc),1)])),_:2},1032,["class"])];var t,a})),_:2},1024)])),_:2},1024),n(A,{class:"text-xs text-gray-400"},{default:c((()=>[i(k(e.create_time),1)])),_:2},1024)])),_:2},1024),n(l,{class:"text-sm text-gray-600 mt-2"},{default:c((()=>[n(A,null,{default:c((()=>[i("暂停时间: ")])),_:1}),n(A,{class:"text-primary"},{default:c((()=>[i(k(e.pause_start_date)+" ~ "+k(e.pause_end_date),1)])),_:2},1024),n(A,{class:"text-gray-400 ml-2"},{default:c((()=>[i("("+k(e.pause_days)+"天)",1)])),_:2},1024)])),_:2},1024),e.pause_reason?(r(),f(l,{key:0,class:"text-xs text-gray-400 mt-2"},{default:c((()=>[i(" 原因: "+k(e.pause_reason),1)])),_:2},1024)):d("v-if",!0),d(" 操作按钮 "),0===e.pause_status?(r(),f(l,{key:1,class:"mt-3 flex justify-end"},{default:c((()=>[n(Y,{class:"btn-outline text-red-500 border-red-500",onClick:h((t=>(async e=>{if((await C({title:"提示",content:"确定要取消该暂停申请吗？"})).confirm)try{await G({id:e.id}),j({title:"已取消"}),E(!0)}catch(t){j({title:t.message||"操作失败",icon:"none"})}})(e)),["stop"])},{default:c((()=>[i(" 取消申请 ")])),_:2},1032,["onClick"])])),_:2},1024)):d("v-if",!0)])),_:2},1032,["onClick"])))),128)):d("v-if",!0),d(" 加载更多 "),q.value?(r(),f(l,{key:3,class:"py-4 text-center text-gray-400 text-sm"},{default:c((()=>[X.value?(r(),f(A,{key:0},{default:c((()=>[i("加载中...")])),_:1})):(r(),f(A,{key:1,onClick:H},{default:c((()=>[i("加载更多")])),_:1}))])),_:1})):V.value.length>0?(r(),f(l,{key:4,class:"py-4 text-center text-gray-400 text-sm"},{default:c((()=>[i(" 没有更多了 ")])),_:1})):d("v-if",!0)])),_:1}))])),_:1})])),_:1})],64)}}}),[["__scopeId","data-v-737789cc"]]);export{O as default};

import{d as a,s as e,O as l,o as t,h as s,e as c,w as u,b as f,j as r,F as d,g as _,y as i,t as n,i as o,k as v,aP as g,aD as m,r as y,a as p,m as h,l as b,a_ as x,G as k,aJ as w,J as j}from"./index-e3492752.js";import{_ as C}from"./navigation-bar.2687311c.js";import{_ as F}from"./page-meta.a4be6114.js";import{f as $,c as z}from"./orderChange.66dcaaa9.js";import{_ as J}from"./_plugin-vue_export-helper.1b428a4d.js";const B=J(a({__name:"change_detail",setup(a){const J=e(!0),B=e(null),D=e(0),G=a=>({0:"您的申请正在等待审核中",1:"审核已通过，等待执行中",2:"很抱歉，您的申请未通过审核",3:"变更已执行完成",4:"该申请已取消"}[a]||""),I=async()=>{J.value=!0;try{const a=await $({id:D.value});B.value=a}catch(a){console.error(a)}finally{J.value=!1}},N=async()=>{if((await g({title:"提示",content:"确定要取消该变更申请吗？"})).confirm)try{await z({id:D.value}),m({title:"已取消"}),I()}catch(a){m({title:a.message||"操作失败",icon:"none"})}};return l((a=>{a.id&&(D.value=Number(a.id),I())})),(a,e)=>{const l=y(p("navigation-bar"),C),g=y(p("page-meta"),F),m=h,$=b,z=x("uni-icons"),D=k,I=w;return t(),s(d,null,[c(g,{"page-style":a.$theme.pageStyle},{default:u((()=>[c(l,{title:"变更详情","front-color":a.$theme.navColor,"background-color":a.$theme.navBgColor},null,8,["front-color","background-color"])])),_:1},8,["page-style"]),c(m,{class:"change-detail"},{default:u((()=>{return[J.value?(t(),f(m,{key:0,class:"py-20 text-center text-gray-400"},{default:u((()=>[r(" 加载中... ")])),_:1})):B.value?(t(),s(d,{key:1},[_(" 状态卡片 "),c(m,{class:i(["status-card",(a=B.value.change_status,{0:"bg-orange",1:"bg-blue",2:"bg-red",3:"bg-green",4:"bg-gray"}[a]||"bg-gray")])},{default:u((()=>[c(m,{class:"text-lg font-bold"},{default:u((()=>[r(n(B.value.change_status_desc),1)])),_:1}),c(m,{class:"text-sm mt-1 opacity-80"},{default:u((()=>[r(n(G(B.value.change_status)),1)])),_:1})])),_:1},8,["class"]),_(" 基本信息 "),c(m,{class:"bg-white mt-3 p-4"},{default:u((()=>[c(m,{class:"section-title"},{default:u((()=>[r("变更信息")])),_:1}),c(m,{class:"info-row"},{default:u((()=>[c($,{class:"label"},{default:u((()=>[r("变更单号")])),_:1}),c($,{class:"value"},{default:u((()=>[r(n(B.value.change_sn),1)])),_:1})])),_:1}),c(m,{class:"info-row"},{default:u((()=>{return[c($,{class:"label"},{default:u((()=>[r("变更类型")])),_:1}),c(m,{class:i(["tag",(a=B.value.change_type,{1:"bg-blue-100 text-blue-600",2:"bg-orange-100 text-orange-600",3:"bg-green-100 text-green-600"}[a]||"bg-gray-100 text-gray-600")])},{default:u((()=>[r(n(B.value.change_type_desc),1)])),_:1},8,["class"])];var a})),_:1}),c(m,{class:"info-row"},{default:u((()=>[c($,{class:"label"},{default:u((()=>[r("申请时间")])),_:1}),c($,{class:"value"},{default:u((()=>[r(n(B.value.create_time),1)])),_:1})])),_:1}),B.value.audit_time?(t(),f(m,{key:0,class:"info-row"},{default:u((()=>[c($,{class:"label"},{default:u((()=>[r("审核时间")])),_:1}),c($,{class:"value"},{default:u((()=>[r(n(B.value.audit_time),1)])),_:1})])),_:1})):_("v-if",!0),B.value.execute_time?(t(),f(m,{key:1,class:"info-row"},{default:u((()=>[c($,{class:"label"},{default:u((()=>[r("执行时间")])),_:1}),c($,{class:"value"},{default:u((()=>[r(n(B.value.execute_time),1)])),_:1})])),_:1})):_("v-if",!0)])),_:1}),_(" 变更内容 "),c(m,{class:"bg-white mt-3 p-4"},{default:u((()=>[c(m,{class:"section-title"},{default:u((()=>[r("变更内容")])),_:1}),_(" 改期 "),1===B.value.change_type?(t(),f(m,{key:0,class:"change-content"},{default:u((()=>[c(m,{class:"change-item"},{default:u((()=>[c(m,{class:"change-label"},{default:u((()=>[r("原服务日期")])),_:1}),c(m,{class:"change-value old"},{default:u((()=>[r(n(B.value.old_service_date),1)])),_:1})])),_:1}),c(m,{class:"change-arrow"},{default:u((()=>[c(z,{type:"arrowright",size:"20",color:"#999"})])),_:1}),c(m,{class:"change-item"},{default:u((()=>[c(m,{class:"change-label"},{default:u((()=>[r("新服务日期")])),_:1}),c(m,{class:"change-value new"},{default:u((()=>[r(n(B.value.new_service_date),1)])),_:1})])),_:1})])),_:1})):2===B.value.change_type?(t(),s(d,{key:1},[_(" 换人 "),c(m,{class:"change-content"},{default:u((()=>[c(m,{class:"change-item"},{default:u((()=>[c(m,{class:"change-label"},{default:u((()=>[r("原工作人员")])),_:1}),B.value.old_staff?(t(),f(m,{key:0,class:"staff-info"},{default:u((()=>[c(D,{src:B.value.old_staff.avatar,class:"staff-avatar",mode:"aspectFill"},null,8,["src"]),c($,{class:"staff-name"},{default:u((()=>[r(n(B.value.old_staff.name),1)])),_:1})])),_:1})):_("v-if",!0),c(m,{class:"change-price"},{default:u((()=>[r("¥"+n(B.value.old_price),1)])),_:1})])),_:1}),c(m,{class:"change-arrow"},{default:u((()=>[c(z,{type:"arrowright",size:"20",color:"#999"})])),_:1}),c(m,{class:"change-item"},{default:u((()=>[c(m,{class:"change-label"},{default:u((()=>[r("新工作人员")])),_:1}),B.value.new_staff?(t(),f(m,{key:0,class:"staff-info"},{default:u((()=>[c(D,{src:B.value.new_staff.avatar,class:"staff-avatar",mode:"aspectFill"},null,8,["src"]),c($,{class:"staff-name"},{default:u((()=>[r(n(B.value.new_staff.name),1)])),_:1})])),_:1})):_("v-if",!0),c(m,{class:"change-price"},{default:u((()=>[r("¥"+n(B.value.new_price),1)])),_:1})])),_:1})])),_:1}),0!==B.value.price_diff?(t(),f(m,{key:0,class:"price-diff mt-4 text-center"},{default:u((()=>[c($,{class:"text-gray-500"},{default:u((()=>[r("差价: ")])),_:1}),c($,{class:i([B.value.price_diff>0?"text-red-500":"text-green-500","text-lg font-bold"])},{default:u((()=>[r(n(B.value.price_diff>0?"+":"")+n(B.value.price_diff)+"元 ",1)])),_:1},8,["class"]),c(m,{class:"text-xs text-gray-400 mt-1"},{default:u((()=>[r(n(B.value.price_diff>0?"需补差价":"差价将退还"),1)])),_:1})])),_:1})):_("v-if",!0)],64)):3===B.value.change_type?(t(),s(d,{key:2},[_(" 加项 "),c(m,{class:"add-item-content"},{default:u((()=>[B.value.add_staff?(t(),f(m,{key:0,class:"staff-card"},{default:u((()=>[c(D,{src:B.value.add_staff.avatar,class:"staff-avatar-large",mode:"aspectFill"},null,8,["src"]),c(m,{class:"staff-info-detail"},{default:u((()=>[c(m,{class:"staff-name-large"},{default:u((()=>[r(n(B.value.add_staff.name),1)])),_:1}),c(m,{class:"text-gray-400 text-sm"},{default:u((()=>[r(n(B.value.add_package_name),1)])),_:1}),c(m,{class:"text-gray-400 text-sm"},{default:u((()=>[r(n(B.value.add_service_date),1)])),_:1})])),_:1}),c(m,{class:"add-price"},{default:u((()=>[c($,{class:"text-red-500 font-bold text-lg"},{default:u((()=>[r("+¥"+n(B.value.add_price),1)])),_:1})])),_:1})])),_:1})):_("v-if",!0)])),_:1})],64)):_("v-if",!0)])),_:1}),_(" 申请原因 "),B.value.apply_reason?(t(),f(m,{key:0,class:"bg-white mt-3 p-4"},{default:u((()=>[c(m,{class:"section-title"},{default:u((()=>[r("申请原因")])),_:1}),c(m,{class:"text-gray-600 text-sm"},{default:u((()=>[r(n(B.value.apply_reason),1)])),_:1})])),_:1})):_("v-if",!0),_(" 附件图片 "),B.value.attach_images&&B.value.attach_images.length>0?(t(),f(m,{key:1,class:"bg-white mt-3 p-4"},{default:u((()=>[c(m,{class:"section-title"},{default:u((()=>[r("附件图片")])),_:1}),c(m,{class:"image-list"},{default:u((()=>[(t(!0),s(d,null,o(B.value.attach_images,((a,e)=>(t(),f(D,{key:e,src:a,class:"attach-image",mode:"aspectFill",onClick:a=>(a=>{j({current:a,urls:B.value.attach_images})})(e)},null,8,["src","onClick"])))),128))])),_:1})])),_:1})):_("v-if",!0),_(" 审核结果 "),B.value.change_status>=2?(t(),f(m,{key:2,class:"bg-white mt-3 p-4"},{default:u((()=>[c(m,{class:"section-title"},{default:u((()=>[r("审核结果")])),_:1}),B.value.audit_remark?(t(),f(m,{key:0,class:"info-row"},{default:u((()=>[c($,{class:"label"},{default:u((()=>[r("审核备注")])),_:1}),c($,{class:"value"},{default:u((()=>[r(n(B.value.audit_remark),1)])),_:1})])),_:1})):_("v-if",!0),B.value.reject_reason?(t(),f(m,{key:1,class:"info-row"},{default:u((()=>[c($,{class:"label"},{default:u((()=>[r("拒绝原因")])),_:1}),c($,{class:"value text-red-500"},{default:u((()=>[r(n(B.value.reject_reason),1)])),_:1})])),_:1})):_("v-if",!0)])),_:1})):_("v-if",!0),_(" 关联订单 "),B.value.order?(t(),f(m,{key:3,class:"bg-white mt-3 p-4"},{default:u((()=>[c(m,{class:"section-title"},{default:u((()=>[r("关联订单")])),_:1}),c(m,{class:"order-card",onClick:e[0]||(e[0]=a=>{return e=B.value.order.id,void v({url:`/pages/order_detail/order_detail?id=${e}`});var e})},{default:u((()=>[c(m,{class:"flex justify-between items-center"},{default:u((()=>[c($,{class:"text-sm text-gray-500"},{default:u((()=>[r(n(B.value.order.order_sn),1)])),_:1}),c($,{class:"text-sm text-primary"},{default:u((()=>[r("查看订单 >")])),_:1})])),_:1}),c(m,{class:"text-sm text-gray-600 mt-2"},{default:u((()=>[r(" 服务日期: "+n(B.value.order.service_date),1)])),_:1})])),_:1})])),_:1})):_("v-if",!0),_(" 底部操作 "),0===B.value.change_status?(t(),f(m,{key:4,class:"bottom-actions"},{default:u((()=>[c(I,{class:"btn-cancel",onClick:N},{default:u((()=>[r("取消申请")])),_:1})])),_:1})):_("v-if",!0)],64)):(t(),f(m,{key:2,class:"py-20 text-center text-gray-400"},{default:u((()=>[r(" 数据不存在 ")])),_:1}))];var a})),_:1})],64)}}}),[["__scopeId","data-v-5300bad9"]]);export{B as default};

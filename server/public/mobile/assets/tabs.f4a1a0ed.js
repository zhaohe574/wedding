import{$ as e,q as t,c as a,bq as s,s as l,v as o,U as r,x as i,Y as n,M as d,a7 as u,V as c,at as f,as as h,d as b,o as m,b as v,w as p,g,y,f as w,n as S,e as C,z as x,m as I,I as $}from"./index-e3492752.js";import{b as _,u as j,a as B,f as T,g as V,d as k}from"./index.f1be293a.js";import{U as L,C as z}from"./event.5568c9d8.js";import{i as N}from"./is-number.7ef6fec2.js";import"./index.89b6df5d.js";import{i as U}from"./is-boolean.00bf65dc.js";import{u as W}from"./index.04c93aab.js";import{_ as q}from"./_plugin-vue_export-helper.1b428a4d.js";const F=()=>{const t={},a=e([]);return{children:a,addChild:e=>{t[e.uid]=e,a.value.push(e)},removeChild:e=>{delete t[e],a.value=a.value.filter((t=>t.uid!==e))}}},O=Symbol("tabsContextKey"),A=_({color:String,activeColor:String,fontSize:String,activeFontSize:String}),K=e=>{const t=c(),{emit:h}=t,b=s(),{children:m,addChild:v,removeChild:p}=F(),{getSelectorNodeInfo:g}=W(t),y=`tt-${V()}`,w=`${y}-b`,S=a((()=>e.bar||!!b.bar)),C=l(-1),x={width:0,height:0,left:0},I={width:0,height:0,left:0},$=l(0),_=l(0),j=(t,a=!1)=>{C.value=t;const s=m.value.findIndex((e=>e.uid===t)),l=m.value[s].name?m.value[s].name:s;(t=>{if(!e.scroll&&!e.bar&&!b.bar)return;const a=m.value[t].elementRect;if((e.bar||b.bar)&&($.value=a.left-x.left+(a.width-I.width)/2),e.scroll){const e=a.left-x.left-(x.width-a.width)/2;_.value=e<0?0:e}})(s),h(L,l),a&&h(z,l)};o((()=>e.modelValue),(e=>{(e=>{var t;if(void 0===e)return void j(m.value[0].uid);let a;"number"==typeof e&&(a=null==(t=m.value)?void 0:t[e]),a||(a=m.value.find((t=>t.name===e))),j(a?a.uid:m.value[0].uid)})(e)}));let B=0;const T=async()=>{try{const e=await g(`#${y}`);B=0,x.width=e.width||0,x.height=e.height||0,x.left=e.left||0}catch(e){if(B>10)return void(B=0);B++,setTimeout((()=>{T()}),150)}},k=async()=>{if(e.bar||b.bar)try{const e=await g(`#${w}`);B=0,I.width=e.width||0,I.height=e.height||0,I.left=e.left||0}catch(t){if(B>10)return void(B=0);B++,setTimeout((()=>{k()}),150)}};return r((()=>{i((()=>{T(),k()}))})),n(O,d({...u(e),items:m,activeUid:C,showBar:S,addItem:t=>{void 0!==e.modelValue&&-1===C.value&&(e.modelValue!==t.name&&e.modelValue!==m.value.length||i((()=>{j(t.uid)}))),v(t)},removeItem:p,setActiveItem:t=>{if(!e.beforeSwitch)return void j(t,!0);const a=m.value.findIndex((e=>e.uid===t)),s=e.beforeSwitch(a);[f(s),U(s)].includes(!0)&&(f(s)?s.then((e=>{e&&j(t,!0)})).catch((e=>{})):s&&j(t,!0))}})),{tabItems:m,componentId:y,barComponentId:w,barOffsetLeft:$,scrollLeft:_,showBar:S}},M=q(b({__name:"tabs",props:_({...A,modelValue:{type:[String,Number],default:0},height:{type:String,default:"80rpx"},barWidth:{type:String,default:"40rpx"},bgColor:String,barColor:String,bottomShadow:{type:Boolean,default:!0},scroll:{type:Boolean,default:!0},bar:{type:Boolean,default:!0},activeBold:{type:Boolean,default:!0},offsetTop:{type:Number,default:0},beforeSwitch:{type:k(Function)}}),emits:{[L]:e=>h(e)||N(e),[z]:e=>h(e)||N(e)},setup(e){const s=e,{tabItems:l,componentId:o,barComponentId:r,barOffsetLeft:i,scrollLeft:n,showBar:d}=K(s),{ns:u,tabsClass:c,tabsStyle:f,barClass:h,barStyle:b}=(e=>{const s=j("tabs"),[l,o]=B(t(e,"bgColor"),"bg"),[r,i]=B(t(e,"barColor"),"bg"),n=a((()=>{const t=[s.b()];return e.bottomShadow&&t.push(s.m("bottom-shadow")),l.value&&t.push(l.value),t.join(" ")})),d=a((()=>{const t={};return l.value||(t.backgroundColor=o.value||"var(--tn-color-white)"),e.height&&(t.height=T(e.height),e.offsetTop&&(t.height=`calc(${t.height} + ${e.offsetTop}px)`)),t})),u=a((()=>{const e=[s.e("bar")];return r.value&&e.push(r.value),e.join(" ")})),c=a((()=>{const t={};return r.value||(t.backgroundColor=i.value||"var(--tn-color-primary)"),e.barWidth&&(t.width=T(e.barWidth)),t}));return{ns:s,tabsClass:n,tabsStyle:d,barClass:u,barStyle:c}})(s);return(e,t)=>{const a=I,s=$;return m(),v(a,{id:w(o),class:y([w(c)]),style:S(w(f))},{default:p((()=>[g(" 距离顶部的距离占位 "),e.offsetTop?(m(),v(a,{key:0,class:y([w(u).e("top-placeholder")]),style:S({height:`${e.offsetTop}px`})},null,8,["class","style"])):g("v-if",!0),g(" 内容区域 "),C(s,{class:y([w(u).e("scroll-view")]),style:S({height:w(T)(e.height||"100%")}),"scroll-x":e.scroll,"scroll-with-animation":"","scroll-left":w(n)},{default:p((()=>[C(a,{class:y([w(u).e("container"),w(u).is("scroll",e.scroll),w(u).is("no-bar",!w(d))])},{default:p((()=>[x(e.$slots,"default",{},void 0,!0),g(" 滑块 "),e.bar||e.$slots.bar?(m(),v(a,{key:0,id:w(r),class:y([w(u).e("bar-container")]),style:S({left:`${w(i)}px`,opacity:""+(w(i)&&w(l).length?1:0)})},{default:p((()=>[x(e.$slots,"bar",{},(()=>[C(a,{class:y([w(h)]),style:S(w(b))},null,8,["class","style"])]),!0)])),_:3},8,["id","class","style"])):g("v-if",!0)])),_:3},8,["class"])])),_:3},8,["class","style","scroll-x","scroll-left"])])),_:3},8,["id","class","style"])}}}),[["__scopeId","data-v-8c4e1f20"]]);export{M as _,O as a,A as t,F as u};

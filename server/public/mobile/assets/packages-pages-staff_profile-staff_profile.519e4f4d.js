import{d as e,s as l,M as a,c as r,P as t,o,h as s,e as i,w as n,j as d,t as m,f as p,F as u,aD as c,r as x,a as f,m as b,l as _,b0 as g}from"./index-e3492752.js";import{_ as v}from"./navigation-bar.2687311c.js";import{_ as y}from"./page-meta.a4be6114.js";import{_ as h}from"./avatar-upload.38c139c2.js";import{_ as j}from"./input.1776ceae.js";import{_ as V}from"./icon.e613abcd.js";import{_ as w}from"./button.c1dc664f.js";import{_ as U}from"./action-sheet.306657ea.js";import{e as N,s as k,a as C}from"./staff-center.563e3f5c.js";import{a as z}from"./service.e2327710.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./_commonjsHelpers.02d3be64.js";import"./index.f1be293a.js";import"./is-number.7ef6fec2.js";import"./_objectToString.c905654b.js";import"./event.5568c9d8.js";import"./index.23c2867d.js";import"./install.8446dea8.js";import"./is-empty.c0d66e4a.js";import"./is-boolean.00bf65dc.js";import"./index.89b6df5d.js";import"./index.04c93aab.js";import"./debounce.096fb07a.js";import"./clone-deep.2124c060.js";import"./loading.2b80eb94.js";import"./popup.b8b85cf1.js";import"./z-index.5f93cfb9.js";const A=e({__name:"staff_profile",setup(e){const A=l(!1),S=l(!1),P=l([]),$=a({name:"",avatar:"",mobile:"",category_id:0,price:"",experience_years:"",profile:"",service_desc:""}),D=r((()=>P.value.map((e=>({text:e.name,value:e.id}))))),H=r((()=>{const e=P.value.find((e=>e.id===Number($.category_id)));return(null==e?void 0:e.name)||"请选择"})),M=(e,l)=>{e.forEach((e=>{l.push({id:Number(e.id),name:e.name}),Array.isArray(e.children)&&e.children.length>0&&M(e.children,l)}))},B=async()=>{const e=await z(),l=[];Array.isArray(e)&&M(e,l),P.value=l},E=async()=>{const e=await k();$.name=(null==e?void 0:e.name)||"",$.avatar=(null==e?void 0:e.avatar)||"",$.mobile=(null==e?void 0:e.mobile_full)||(null==e?void 0:e.mobile)||"",$.category_id=Number((null==e?void 0:e.category_id)||0),$.price=void 0!==(null==e?void 0:e.price)&&null!==(null==e?void 0:e.price)?String(null==e?void 0:e.price):"",$.experience_years=void 0!==(null==e?void 0:e.experience_years)&&null!==(null==e?void 0:e.experience_years)?String(null==e?void 0:e.experience_years):"",$.profile=(null==e?void 0:e.profile)||"",$.service_desc=(null==e?void 0:e.service_desc)||""},F=e=>{const l=D.value[e];l&&($.category_id=Number(l.value))},G=async()=>{if(!$.name.trim())return void c({title:"请输入姓名",icon:"none"});if(!$.category_id)return void c({title:"请选择服务分类",icon:"none"});const e={name:$.name.trim(),avatar:$.avatar,category_id:$.category_id,profile:$.profile,service_desc:$.service_desc};$.mobile&&(e.mobile=$.mobile),""!==$.price&&(e.price=Number($.price)),""!==$.experience_years&&(e.experience_years=Number($.experience_years)),A.value=!0;try{await C(e),c({title:"保存成功",icon:"success"})}catch(l){const e="string"==typeof l?l:(null==l?void 0:l.msg)||(null==l?void 0:l.message)||"保存失败";c({title:e,icon:"none"})}finally{A.value=!1}};return t((async()=>{await N()&&await Promise.all([B(),E()])})),(e,l)=>{const a=x(f("navigation-bar"),v),r=x(f("page-meta"),y),t=b,c=x(f("avatar-upload"),h),N=x(f("tn-input"),j),k=_,C=x(f("tn-icon"),V),z=g,P=x(f("tn-button"),w),M=x(f("tn-action-sheet"),U);return o(),s(u,null,[i(r,{"page-style":e.$theme.pageStyle},{default:n((()=>[i(a,{title:"个人资料","front-color":e.$theme.navColor,"background-color":e.$theme.navBgColor},null,8,["front-color","background-color"])])),_:1},8,["page-style"]),i(t,{class:"min-h-screen bg-[#f6f6f6] pb-[40rpx]"},{default:n((()=>[i(t,{class:"bg-white mx-[24rpx] mt-[24rpx] rounded-lg p-[24rpx]"},{default:n((()=>[i(t,{class:"text-sm font-medium mb-[20rpx]"},{default:n((()=>[d("头像")])),_:1}),i(c,{modelValue:$.avatar,"onUpdate:modelValue":l[0]||(l[0]=e=>$.avatar=e),round:!0,size:120},null,8,["modelValue"])])),_:1}),i(t,{class:"bg-white mx-[24rpx] mt-[20rpx] rounded-lg"},{default:n((()=>[i(t,{class:"flex items-center justify-between px-[24rpx] py-[26rpx] border-b border-solid border-0 border-light"},{default:n((()=>[i(t,{class:"text-sm text-[#333]"},{default:n((()=>[d("姓名")])),_:1}),i(N,{modelValue:$.name,"onUpdate:modelValue":l[1]||(l[1]=e=>$.name=e),placeholder:"请输入姓名",class:"text-right"},null,8,["modelValue"])])),_:1}),i(t,{class:"flex items-center justify-between px-[24rpx] py-[26rpx] border-b border-solid border-0 border-light",onClick:l[2]||(l[2]=e=>S.value=!0)},{default:n((()=>[i(t,{class:"text-sm text-[#333]"},{default:n((()=>[d("服务分类")])),_:1}),i(t,{class:"flex items-center text-sm text-gray-500"},{default:n((()=>[i(k,null,{default:n((()=>[d(m(p(H)),1)])),_:1}),i(C,{name:"right",size:"24",color:"#999999",class:"ml-[6rpx]"})])),_:1})])),_:1}),i(t,{class:"flex items-center justify-between px-[24rpx] py-[26rpx] border-b border-solid border-0 border-light"},{default:n((()=>[i(t,{class:"text-sm text-[#333]"},{default:n((()=>[d("手机号")])),_:1}),i(N,{modelValue:$.mobile,"onUpdate:modelValue":l[3]||(l[3]=e=>$.mobile=e),placeholder:"请输入手机号",class:"text-right"},null,8,["modelValue"])])),_:1}),i(t,{class:"flex items-center justify-between px-[24rpx] py-[26rpx] border-b border-solid border-0 border-light"},{default:n((()=>[i(t,{class:"text-sm text-[#333]"},{default:n((()=>[d("服务价格")])),_:1}),i(N,{modelValue:$.price,"onUpdate:modelValue":l[4]||(l[4]=e=>$.price=e),type:"number",placeholder:"请输入价格",class:"text-right"},null,8,["modelValue"])])),_:1}),i(t,{class:"flex items-center justify-between px-[24rpx] py-[26rpx]"},{default:n((()=>[i(t,{class:"text-sm text-[#333]"},{default:n((()=>[d("从业年限")])),_:1}),i(N,{modelValue:$.experience_years,"onUpdate:modelValue":l[5]||(l[5]=e=>$.experience_years=e),type:"number",placeholder:"请输入年限",class:"text-right"},null,8,["modelValue"])])),_:1})])),_:1}),i(t,{class:"bg-white mx-[24rpx] mt-[20rpx] rounded-lg p-[24rpx]"},{default:n((()=>[i(t,{class:"text-sm font-medium mb-[16rpx]"},{default:n((()=>[d("个人简介")])),_:1}),i(z,{modelValue:$.profile,"onUpdate:modelValue":l[6]||(l[6]=e=>$.profile=e),class:"w-full text-sm leading-6 text-[#333] bg-[#fafafa] rounded-lg p-[20rpx]",placeholder:"请简要介绍自己的风格与经验",maxlength:500},null,8,["modelValue"])])),_:1}),i(t,{class:"bg-white mx-[24rpx] mt-[20rpx] rounded-lg p-[24rpx]"},{default:n((()=>[i(t,{class:"text-sm font-medium mb-[16rpx]"},{default:n((()=>[d("服务说明")])),_:1}),i(z,{modelValue:$.service_desc,"onUpdate:modelValue":l[7]||(l[7]=e=>$.service_desc=e),class:"w-full text-sm leading-6 text-[#333] bg-[#fafafa] rounded-lg p-[20rpx]",placeholder:"填写服务内容、流程或注意事项",maxlength:1e3},null,8,["modelValue"])])),_:1}),i(t,{class:"mx-[24rpx] mt-[30rpx]"},{default:n((()=>[i(P,{type:"primary",shape:"round",size:"lg",loading:A.value,onClick:G},{default:n((()=>[d(" 保存 ")])),_:1},8,["loading"])])),_:1})])),_:1}),i(M,{modelValue:S.value,"onUpdate:modelValue":l[8]||(l[8]=e=>S.value=e),data:p(D),onClick:F},null,8,["modelValue","data"])],64)}}});export{A as default};

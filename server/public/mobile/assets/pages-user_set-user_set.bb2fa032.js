import{d as e,C as a,a1 as s,u as t,c as l,s as o,ac as r,P as n,O as c,af as u,ax as i,o as d,h as m,e as f,f as _,w as p,g,j as h,t as v,n as F,b as C,F as y,ai as b,r as k,a as w,m as z,p as j,l as x,ad as V,ag as $}from"./index-e3492752.js";import{_ as T}from"./page-meta.a4be6114.js";import{T as E}from"./avatar.b1292efe.js";import{_ as I}from"./icon.e613abcd.js";import{_ as U}from"./popup.b8b85cf1.js";import{u as B}from"./useLockFn.c836b103.js";import{_ as R}from"./_plugin-vue_export-helper.1b428a4d.js";import"./badge.46a4bc76.js";import"./index.f1be293a.js";import"./index.89b6df5d.js";import"./is-number.7ef6fec2.js";import"./_objectToString.c905654b.js";import"./is-empty.c0d66e4a.js";import"./index.04c93aab.js";import"./z-index.5f93cfb9.js";import"./is-boolean.00bf65dc.js";import"./event.5568c9d8.js";import"./install.8446dea8.js";var S=(e=>(e.PRIVACY="privacy",e.SERVICE="service",e))(S||{});const P=R(e({__name:"user_set",setup(e){const R=b(),P=a(),A=s(),Y=t(),q=l((()=>A.userInfo)),H=o(!0);H.value=r();const J=o(!1),L=o(!1),O=e=>{const a={primary:Y.primaryColor,secondary:Y.secondaryColor,cta:Y.ctaColor,accent:Y.accentColor,info:"#909399",warning:"#FF9900",success:"#19BE6B"};return`linear-gradient(135deg, ${a[e]} 0%, ${a[e]} 100%)`},D=e=>({success:"rgba(25, 190, 107, 0.1)",warning:"rgba(255, 153, 0, 0.1)",error:"rgba(255, 44, 60, 0.1)"}[e]||"rgba(0, 0, 0, 0.05)"),G=e=>{switch(J.value=!1,e){case 0:R.navigateTo("/pages/change_password/change_password");break;case 1:R.navigateTo("/pages/forget_pwd/forget_pwd")}},K=()=>{if(!q.value.has_password)return R.navigateTo("/pages/change_password/change_password?type=set");J.value=!0},M=()=>{A.logout(),R.redirectTo("/pages/login/login")},{lockFn:N}=B((async()=>{if(!q.value.is_auth)try{u({title:"请稍后..."}),H.value&&V.getUrl(),await A.getUser(),$()}catch(e){$(),uni.$u.toast(e)}}));return n((()=>{A.getUser()})),c((async e=>{const{code:a}=e;if(H.value&&a){u({title:"请稍后..."});try{await i({code:a}),await A.getUser()}catch(s){}R.redirectTo("/pages/user_set/user_set")}})),(e,a)=>{const s=k(w("page-meta"),T),t=k(w("tn-avatar"),E),l=z,o=k(w("tn-icon"),I),r=j,n=x,c=k(w("tn-popup"),U);return d(),m(y,null,[f(s,{"page-style":_(Y).pageStyle},null,8,["page-style"]),f(l,{class:"user-set-page"},{default:p((()=>[g(" 用户信息卡片 "),f(r,{url:"/pages/user_data/user_data","hover-class":"none"},{default:p((()=>[f(l,{class:"user-info-card"},{default:p((()=>[f(l,{class:"card-content"},{default:p((()=>[f(t,{url:_(q).avatar||"/static/images/user/default_avatar.png",shape:"square",size:120,"border-radius":16},null,8,["url"]),f(l,{class:"user-details"},{default:p((()=>[f(l,{class:"user-name"},{default:p((()=>[h(v(_(q).nickname),1)])),_:1}),f(l,{class:"user-account"},{default:p((()=>[h("账号："+v(_(q).account),1)])),_:1})])),_:1}),f(l,{class:"arrow-icon"},{default:p((()=>[f(o,{name:"right",size:32,color:"#999"})])),_:1})])),_:1})])),_:1})])),_:1}),g(" 账号安全区域 "),f(l,{class:"section-card"},{default:p((()=>[f(l,{class:"section-title"},{default:p((()=>[h("账号安全")])),_:1}),f(l,{class:"menu-item","hover-class":"menu-item-hover",onClick:K},{default:p((()=>[f(l,{class:"menu-left"},{default:p((()=>[f(l,{class:"menu-icon",style:F({background:O("primary")})},{default:p((()=>[f(o,{name:"lock",size:36,color:"#FFFFFF"})])),_:1},8,["style"]),f(n,{class:"menu-text"},{default:p((()=>[h("登录密码")])),_:1})])),_:1}),f(l,{class:"menu-right"},{default:p((()=>[f(n,{class:"menu-value"},{default:p((()=>[h(v(_(q).has_password?"已设置":"未设置"),1)])),_:1}),f(o,{name:"right",size:32,color:"#C8C9CC"})])),_:1})])),_:1}),H.value?(d(),C(l,{key:0,class:"menu-item","hover-class":"menu-item-hover",onClick:_(N)},{default:p((()=>[f(l,{class:"menu-left"},{default:p((()=>[f(l,{class:"menu-icon",style:F({background:O("secondary")})},{default:p((()=>[f(o,{name:"wechat-fill",size:36,color:"#FFFFFF"})])),_:1},8,["style"]),f(n,{class:"menu-text"},{default:p((()=>[h("绑定微信")])),_:1})])),_:1}),f(l,{class:"menu-right"},{default:p((()=>[f(l,{class:"status-badge",style:F({background:_(q).is_auth?D("success"):D("warning"),color:_(q).is_auth?"#19BE6B":"#FF9900"})},{default:p((()=>[h(v(_(q).is_auth?"已绑定":"未绑定"),1)])),_:1},8,["style"]),_(q).is_auth?g("v-if",!0):(d(),C(o,{key:0,name:"right",size:32,color:"#C8C9CC"}))])),_:1})])),_:1},8,["onClick"])):g("v-if",!0)])),_:1}),g(" 协议与关于 "),f(l,{class:"section-card"},{default:p((()=>[f(l,{class:"section-title"},{default:p((()=>[h("协议与关于")])),_:1}),f(r,{url:`/pages/agreement/agreement?type=${_(S).PRIVACY}`,"hover-class":"none"},{default:p((()=>[f(l,{class:"menu-item","hover-class":"menu-item-hover"},{default:p((()=>[f(l,{class:"menu-left"},{default:p((()=>[f(l,{class:"menu-icon",style:F({background:O("accent")})},{default:p((()=>[f(o,{name:"honor",size:36,color:"#FFFFFF"})])),_:1},8,["style"]),f(n,{class:"menu-text"},{default:p((()=>[h("隐私政策")])),_:1})])),_:1}),f(l,{class:"menu-right"},{default:p((()=>[f(o,{name:"right",size:32,color:"#C8C9CC"})])),_:1})])),_:1})])),_:1},8,["url"]),f(r,{url:`/pages/agreement/agreement?type=${_(S).SERVICE}`,"hover-class":"none"},{default:p((()=>[f(l,{class:"menu-item","hover-class":"menu-item-hover"},{default:p((()=>[f(l,{class:"menu-left"},{default:p((()=>[f(l,{class:"menu-icon",style:F({background:O("cta")})},{default:p((()=>[f(o,{name:"honor",size:36,color:"#FFFFFF"})])),_:1},8,["style"]),f(n,{class:"menu-text"},{default:p((()=>[h("服务协议")])),_:1})])),_:1}),f(l,{class:"menu-right"},{default:p((()=>[f(o,{name:"right",size:32,color:"#C8C9CC"})])),_:1})])),_:1})])),_:1},8,["url"]),f(r,{url:"/pages/as_us/as_us","hover-class":"none"},{default:p((()=>[f(l,{class:"menu-item menu-item-last","hover-class":"menu-item-hover"},{default:p((()=>[f(l,{class:"menu-left"},{default:p((()=>[f(l,{class:"menu-icon",style:F({background:O("info")})},{default:p((()=>[f(o,{name:"building",size:36,color:"#FFFFFF"})])),_:1},8,["style"]),f(n,{class:"menu-text"},{default:p((()=>[h("关于我们")])),_:1})])),_:1}),f(l,{class:"menu-right"},{default:p((()=>[f(n,{class:"menu-value"},{default:p((()=>[h(v(_(P).config.version),1)])),_:1}),f(o,{name:"right",size:32,color:"#C8C9CC"})])),_:1})])),_:1})])),_:1})])),_:1}),g(" 退出登录按钮 "),f(l,{class:"logout-container"},{default:p((()=>[f(l,{class:"logout-btn",style:F({background:`linear-gradient(135deg, ${_(Y).primaryColor} 0%, ${_(Y).primaryColor} 100%)`,color:_(Y).btnColor}),"hover-class":"logout-btn-hover",onClick:a[0]||(a[0]=e=>L.value=!0)},{default:p((()=>[f(o,{name:"logout",size:36,color:_(Y).btnColor},null,8,["color"]),f(n,{class:"logout-text"},{default:p((()=>[h("退出登录")])),_:1})])),_:1},8,["style"])])),_:1}),g(" 密码操作选择弹窗 "),f(c,{modelValue:J.value,"onUpdate:modelValue":a[4]||(a[4]=e=>J.value=e),"open-direction":"bottom",radius:32,"safe-area-inset-bottom":!0},{default:p((()=>[f(l,{class:"password-action-popup"},{default:p((()=>[f(l,{class:"action-header"},{default:p((()=>[f(n,{class:"action-title"},{default:p((()=>[h("密码管理")])),_:1}),f(l,{class:"close-btn",onClick:a[1]||(a[1]=e=>J.value=!1)},{default:p((()=>[f(o,{name:"close",size:32,color:"#999"})])),_:1})])),_:1}),f(l,{class:"action-list"},{default:p((()=>[f(l,{class:"action-item","hover-class":"action-item-hover",onClick:a[2]||(a[2]=e=>G(0))},{default:p((()=>[f(l,{class:"action-icon",style:F({background:O("primary")})},{default:p((()=>[f(o,{name:"edit",size:36,color:"#FFFFFF"})])),_:1},8,["style"]),f(n,{class:"action-text"},{default:p((()=>[h("修改密码")])),_:1}),f(o,{name:"right",size:32,color:"#C8C9CC"})])),_:1}),f(l,{class:"action-item","hover-class":"action-item-hover",onClick:a[3]||(a[3]=e=>G(1))},{default:p((()=>[f(l,{class:"action-icon",style:F({background:O("warning")})},{default:p((()=>[f(o,{name:"help",size:36,color:"#FFFFFF"})])),_:1},8,["style"]),f(n,{class:"action-text"},{default:p((()=>[h("忘记密码")])),_:1}),f(o,{name:"right",size:32,color:"#C8C9CC"})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),g(" 退出登录确认弹窗 "),f(c,{modelValue:L.value,"onUpdate:modelValue":a[6]||(a[6]=e=>L.value=e),"open-direction":"center",radius:32,"overlay-closeable":!1},{default:p((()=>[f(l,{class:"logout-popup"},{default:p((()=>[f(l,{class:"popup-icon",style:F({background:O("warning")})},{default:p((()=>[f(o,{name:"warning",size:64,color:"#FFFFFF"})])),_:1},8,["style"]),f(l,{class:"popup-title"},{default:p((()=>[h("温馨提示")])),_:1}),f(l,{class:"popup-content"},{default:p((()=>[h(" 是否清除当前登录信息，退出登录？ ")])),_:1}),f(l,{class:"popup-actions"},{default:p((()=>[f(l,{class:"action-btn action-btn-cancel","hover-class":"action-btn-hover",onClick:a[5]||(a[5]=e=>L.value=!1)},{default:p((()=>[h(" 取消 ")])),_:1}),f(l,{class:"action-btn action-btn-confirm",style:F({background:`linear-gradient(135deg, ${_(Y).primaryColor} 0%, ${_(Y).primaryColor} 100%)`,color:_(Y).btnColor}),"hover-class":"action-btn-hover",onClick:M},{default:p((()=>[h(" 确认退出 ")])),_:1},8,["style"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})],64)}}}),[["__scopeId","data-v-2d053cfa"]]);export{P as default};

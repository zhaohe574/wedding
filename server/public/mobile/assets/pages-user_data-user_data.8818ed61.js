import{_ as a}from"./page-meta.a4be6114.js";import{d as e,u as l,s as u,aE as o,P as t,aF as s,o as n,h as r,e as p,f as i,w as d,g as c,j as v,t as m,y as f,n as _,F as b,aG as y,aj as g,ak as C,aH as h,aI as V,r as k,a as j,l as $,m as E,a5 as w,aJ as x,aK as I}from"./index-e3492752.js";import{_ as U}from"./avatar-upload.38c139c2.js";import{_ as N}from"./icon.e613abcd.js";import{_ as A}from"./popup.b8b85cf1.js";import{T as B}from"./picker.b20888da.js";import{_ as S}from"./_plugin-vue_export-helper.1b428a4d.js";import"./_commonjsHelpers.02d3be64.js";import"./index.f1be293a.js";import"./z-index.5f93cfb9.js";import"./is-boolean.00bf65dc.js";import"./_objectToString.c905654b.js";import"./is-empty.c0d66e4a.js";import"./index.89b6df5d.js";import"./event.5568c9d8.js";import"./install.8446dea8.js";import"./is-number.7ef6fec2.js";import"./error.a3858cc2.js";import"./clone-deep.2124c060.js";const M=S(e({__name:"user_data",setup(e){const S=l(),M=u({}),z=u(o.NONE),D=u(!1),H=u(!1),K=u(!1),L=u(!1),O=u(void 0),T=[{label:"未知",value:0},{label:"男",value:1},{label:"女",value:2}],F=u(""),G=u(""),J=u(""),R=u(""),P=u("获取验证码"),X=u(!0);let q=null;const Q=async()=>{M.value=await y()},W=async()=>{if(!J.value)return uni.$u.toast("请输入新的手机号码");X.value&&(await g({scene:M.value.mobile?C.CHANGE_MOBILE:C.BIND_MOBILE,mobile:J.value}),uni.$u.toast("发送成功"),(()=>{let a=60;X.value=!1,P.value=`${a}秒`,q=setInterval((()=>{a--,a>0?P.value=`${a}秒`:(clearInterval(q),P.value="获取验证码",X.value=!0)}),1e3)})())},Y=a=>{z.value=o.AVATAR,aa(a)},Z=async()=>{await h({type:M.value.mobile?"change":"bind",mobile:J.value,code:R.value}),uni.$u.toast("操作成功"),K.value=!1,Q()},aa=async a=>{await V({field:z.value,value:a}),uni.$u.toast("操作成功"),Q()},ea=()=>{var a;H.value=!0,G.value=(null==(a=M.value)?void 0:a.account)||""},la=()=>{var a;D.value=!0,F.value=(null==(a=M.value)?void 0:a.nickname)||""},ua=()=>{var a;z.value=o.SEX;const e=null==(a=M.value)?void 0:a.sex;O.value=2===e||"2"===e||"女"===e?2:1===e||"1"===e||"男"===e?1:0,L.value=!0},oa=a=>{void 0!==a&&[0,1,2].includes(a)&&aa(String(a))},ta=()=>""==G.value?uni.$u.toast("账号不能为空"):G.value.length>10?uni.$u.toast("账号长度不得超过十位数"):(z.value=o.USERNAME,aa(G.value),void(H.value=!1)),sa=async a=>(F.value=a.detail.value.nickname,""==F.value?uni.$u.toast("昵称不能为空"):F.value.length>10?uni.$u.toast("昵称长度不得超过十位数"):(z.value=o.NICKNAME,await aa(F.value),void(D.value=!1)));return t((async()=>{Q()})),s((()=>{q&&clearInterval(q)})),(e,l)=>{const u=k(j("page-meta"),a),o=k(j("avatar-upload"),U),t=$,s=E,y=k(j("tn-icon"),N),g=w,C=x,h=I,V=k(j("tn-popup"),A),z=k(j("tn-picker"),B);return n(),r(b,null,[p(u,{"page-style":i(S).pageStyle},null,8,["page-style"]),p(s,{class:"user-data-page"},{default:d((()=>[c(" 头像区域 "),p(s,{class:"avatar-section"},{default:d((()=>[p(s,{class:"avatar-card"},{default:d((()=>{var a;return[p(o,{modelValue:null==(a=M.value)?void 0:a.avatar,"file-key":"url",round:!0,"onUpdate:modelValue":Y},null,8,["modelValue"]),p(t,{class:"avatar-tip"},{default:d((()=>[v("点击修改头像")])),_:1})]})),_:1})])),_:1}),c(" 信息列表 "),p(s,{class:"info-list"},{default:d((()=>[c(" 账号 "),p(s,{class:"info-item",onClick:ea},{default:d((()=>[p(s,{class:"info-label"},{default:d((()=>[v("账号")])),_:1}),p(s,{class:"info-content"},{default:d((()=>[p(t,{class:"info-value"},{default:d((()=>{var a;return[v(m(null==(a=M.value)?void 0:a.account),1)]})),_:1}),p(y,{name:"right",size:"32",color:"#CBD5E1"})])),_:1})])),_:1}),c(" 昵称 "),p(s,{class:"info-item",onClick:la},{default:d((()=>[p(s,{class:"info-label"},{default:d((()=>[v("昵称")])),_:1}),p(s,{class:"info-content"},{default:d((()=>[p(t,{class:"info-value"},{default:d((()=>{var a;return[v(m(null==(a=M.value)?void 0:a.nickname),1)]})),_:1}),p(y,{name:"right",size:"32",color:"#CBD5E1"})])),_:1})])),_:1}),c(" 性别 "),p(s,{class:"info-item",onClick:ua},{default:d((()=>[p(s,{class:"info-label"},{default:d((()=>[v("性别")])),_:1}),p(s,{class:"info-content"},{default:d((()=>[p(t,{class:"info-value"},{default:d((()=>{var a,e;return[v(m((e=null==(a=M.value)?void 0:a.sex,2===e||"2"===e||"女"===e?"女":1===e||"1"===e||"男"===e?"男":"未知")),1)]})),_:1}),p(y,{name:"right",size:"32",color:"#CBD5E1"})])),_:1})])),_:1}),c(" 手机号 "),p(s,{class:"info-item phone-item"},{default:d((()=>[p(s,{class:"info-label"},{default:d((()=>[v("手机号")])),_:1}),p(s,{class:"info-content"},{default:d((()=>{var a;return[p(t,{class:f(["info-value",{"text-muted":!(null==(a=M.value)?void 0:a.mobile)}])},{default:d((()=>{var a;return[v(m((null==(a=M.value)?void 0:a.mobile)||"未绑定手机号"),1)]})),_:1},8,["class"]),p(s,{class:"bind-btn",style:_({backgroundColor:i(S).primaryColor+"15",color:i(S).primaryColor}),onClick:l[0]||(l[0]=a=>K.value=!0)},{default:d((()=>{var a;return[v(m((null==(a=M.value)?void 0:a.mobile)?"更换":"绑定"),1)]})),_:1},8,["style"])]})),_:1})])),_:1}),c(" 注册时间 "),p(s,{class:"info-item"},{default:d((()=>[p(s,{class:"info-label"},{default:d((()=>[v("注册时间")])),_:1}),p(s,{class:"info-content"},{default:d((()=>[p(t,{class:"info-value text-muted"},{default:d((()=>{var a;return[v(m(null==(a=M.value)?void 0:a.create_time),1)]})),_:1})])),_:1})])),_:1})])),_:1}),c(" 昵称修改弹窗 "),p(V,{modelValue:D.value,"onUpdate:modelValue":l[1]||(l[1]=a=>D.value=a),"close-btn":!0,mode:"center","mask-close-able":!1,"border-radius":"24"},{default:d((()=>[p(s,{class:"edit-popup"},{default:d((()=>[p(h,{onSubmit:sa},{default:d((()=>[p(s,{class:"popup-title"},{default:d((()=>[v("修改昵称")])),_:1}),p(s,{class:"popup-input-wrapper"},{default:d((()=>[p(g,{class:"popup-input",value:M.value.nickname,name:"nickname",type:"nickname",placeholder:"请输入昵称","placeholder-class":"input-placeholder"},null,8,["value"])])),_:1}),p(s,{class:"popup-actions"},{default:d((()=>[p(C,{class:"popup-btn popup-btn-primary",style:_({background:`linear-gradient(135deg, ${i(S).primaryColor} 0%, ${i(S).primaryColor} 100%)`,color:i(S).btnColor}),"form-type":"submit","hover-class":"none"},{default:d((()=>[v(" 确定 ")])),_:1},8,["style"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),c(" 账号修改弹窗 "),p(V,{modelValue:H.value,"onUpdate:modelValue":l[3]||(l[3]=a=>H.value=a),"close-btn":!0,mode:"center","border-radius":"24","mask-close-able":!1},{default:d((()=>[p(s,{class:"edit-popup"},{default:d((()=>[p(s,{class:"popup-title"},{default:d((()=>[v("修改账号")])),_:1}),p(s,{class:"popup-input-wrapper"},{default:d((()=>[p(g,{class:"popup-input",modelValue:G.value,"onUpdate:modelValue":l[2]||(l[2]=a=>G.value=a),placeholder:"请输入账号","placeholder-class":"input-placeholder"},null,8,["modelValue"])])),_:1}),p(s,{class:"popup-actions"},{default:d((()=>[p(C,{class:"popup-btn popup-btn-primary",style:_({background:`linear-gradient(135deg, ${i(S).primaryColor} 0%, ${i(S).primaryColor} 100%)`,color:i(S).btnColor}),onClick:ta,"hover-class":"none"},{default:d((()=>[v(" 确定 ")])),_:1},8,["style"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),c(" 手机号修改弹窗 "),p(V,{modelValue:K.value,"onUpdate:modelValue":l[6]||(l[6]=a=>K.value=a),"close-btn":!0,mode:"center","border-radius":"24","mask-close-able":!1},{default:d((()=>[p(s,{class:"edit-popup"},{default:d((()=>[p(s,{class:"popup-title"},{default:d((()=>{var a;return[v(m((null==(a=M.value)?void 0:a.mobile)?"更换手机号":"绑定手机号"),1)]})),_:1}),p(s,{class:"popup-input-wrapper"},{default:d((()=>[p(g,{class:"popup-input",modelValue:J.value,"onUpdate:modelValue":l[4]||(l[4]=a=>J.value=a),type:"number",placeholder:"请输入新的手机号码","placeholder-class":"input-placeholder"},null,8,["modelValue"])])),_:1}),p(s,{class:"popup-input-wrapper code-input-wrapper"},{default:d((()=>[p(g,{class:"flex-1 popup-input",modelValue:R.value,"onUpdate:modelValue":l[5]||(l[5]=a=>R.value=a),type:"number",placeholder:"请输入验证码","placeholder-class":"input-placeholder"},null,8,["modelValue"]),p(s,{class:f(["code-btn",{"code-btn-disabled":!X.value}]),style:_(X.value?{color:i(S).primaryColor}:{}),onClick:W},{default:d((()=>[v(m(P.value),1)])),_:1},8,["class","style"])])),_:1}),p(s,{class:"popup-actions"},{default:d((()=>[p(C,{class:"popup-btn popup-btn-primary",style:_({background:`linear-gradient(135deg, ${i(S).primaryColor} 0%, ${i(S).primaryColor} 100%)`,color:i(S).btnColor}),onClick:Z,"hover-class":"none"},{default:d((()=>[v(" 确定 ")])),_:1},8,["style"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),c(" 性别选择器 "),p(z,{modelValue:O.value,"onUpdate:modelValue":l[7]||(l[7]=a=>O.value=a),open:L.value,"onUpdate:open":l[8]||(l[8]=a=>L.value=a),data:T,onConfirm:oa},null,8,["modelValue","open"])])),_:1})],64)}}}),[["__scopeId","data-v-def944a6"]]);export{M as default};

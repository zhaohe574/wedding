import{Y as e,M as a,a7 as t,c as l,s as o,U as s,x as i,X as n,V as r,d as c,o as u,b as d,w as m,g as v,f,y as p,z as g,e as y,n as k,m as _,G as C,J as h,h as w,F as b,i as S,A as x,q as I,j as F,t as L,r as j,a as z,l as $,u as B,a1 as A,v as M,O as T,P as H,aS as U,aX as V,k as N,aD as D}from"./index-e3492752.js";import{_ as E}from"./page-meta.a4be6114.js";import{c as R,_ as O}from"./icon.e613abcd.js";import{_ as q}from"./tabs-item.3a07d27c.js";import{u as G,_ as X}from"./tabs.f4a1a0ed.js";import{_ as J}from"./loading.2b80eb94.js";import{_ as P}from"./tabbar.vue_vue_type_script_setup_true_lang.d2dbfaf9.js";import{g as Y,l as K,t as Q}from"./dynamic.b225a591.js";import{b as W,u as Z,f as ee,g as ae,d as te,a as le}from"./index.f1be293a.js";import"./index.89b6df5d.js";import{i as oe}from"./is-empty.c0d66e4a.js";import{u as se}from"./index.04c93aab.js";import{u as ie}from"./index.cf579d2e.js";import{_ as ne}from"./_plugin-vue_export-helper.1b428a4d.js";import{i as re}from"./is-number.7ef6fec2.js";import{a as ce,b as ue,T as de}from"./avatar.b1292efe.js";import"./badge.46a4bc76.js";import"./event.5568c9d8.js";import"./is-boolean.00bf65dc.js";import"./_objectToString.c905654b.js";import"./u-icon.c576501f.js";const me=W({src:String,height:String,width:String,mode:{type:String,values:R,default:"aspectFill"},threshold:{type:Number,default:100},transition:{type:Boolean,default:!0}}),ve=ne(c({__name:"lazy-load",props:me,emits:{loaded:()=>!0,error:()=>!0},setup(e){const a=e,{componentId:t,imageStatus:c,showImage:h,handleImageLoadedSuccess:w,handleImageLoadedFailed:b}=(e=>{const a=r(),{emit:t}=a,{getSelectorNodeInfo:c}=se(a),{connectObserver:u,disconnectObserver:d}=ie(a),m=`tll-${ae()}`,v=l((()=>oe(e.threshold,100))),f=o("waiting"),p=o(!1);let g=0;const y=async()=>{d();try{await c(`#${m}`),g=0;const e=v.value<0?-Math.abs(v.value):Math.abs(v.value);u(`#${m}`,(e=>{e.intersectionRatio>0&&(p.value=!0,f.value="loading",d())}),{type:"relativeToViewport",margins:{bottom:e}})}catch(e){if(g>10)return void(g=0);g++,setTimeout((()=>{y()}),150)}};return s((()=>{i((()=>{y()}))})),n((()=>{d()})),{componentId:m,imageStatus:f,showImage:p,handleImageLoadedSuccess:()=>{f.value="loaded",t("loaded")},handleImageLoadedFailed:e=>{f.value="error",t("error")}}})(a),{ns:S,lazyLoadStyle:x}=(e=>({ns:Z("lazy-load"),lazyLoadStyle:l((()=>{const a={};return e.width&&(a.width=ee(e.width)),e.height&&(a.height=ee(e.height)),a}))}))(a);return(e,a)=>{const l=_,o=C;return u(),d(l,{id:f(t),class:p([f(S).b(),f(S).is("show-image",f(h)&&"loaded"===f(c))]),style:k(f(x))},{default:m((()=>[v(" 加载中 "),"loading"===f(c)?(u(),d(l,{key:0,class:p([f(S).e("container")])},{default:m((()=>[g(e.$slots,"loading",{},(()=>[y(l,{class:p([f(S).e("loading")])},{default:m((()=>[y(l,{class:p([f(S).e("loading__icon")])},{default:m((()=>[y(O,{name:"loading"})])),_:1},8,["class"])])),_:1},8,["class"])]),!0)])),_:3},8,["class"])):v("v-if",!0),v(" 正式显示的图片 "),f(h)&&"error"!==f(c)?(u(),d(l,{key:1,class:p([f(S).e("container")])},{default:m((()=>[y(o,{class:p([f(S).e("image"),f(S).is("animation","loaded"===f(c)&&e.transition),f(S).is("no-animation","loaded"===f(c)&&!e.transition)]),src:e.src,mode:e.mode,onLoad:f(w),onError:f(b)},null,8,["class","src","mode","onLoad","onError"])])),_:1},8,["class"])):v("v-if",!0),v(" 图片加载失败 "),"error"===f(c)?(u(),d(l,{key:2,class:p([f(S).e("container")])},{default:m((()=>[g(e.$slots,"error",{},(()=>[y(l,{class:p([f(S).e("error")])},{default:m((()=>[y(O,{name:"image-fill"})])),_:1},8,["class"])]),!0)])),_:3},8,["class"])):v("v-if",!0)])),_:3},8,["id","class","style"])}}}),[["__scopeId","data-v-2fbad0da"]]),fe=W({data:{type:te(Array),default:()=>[]},max:{type:Number,default:9},column:{type:Number,default:3},imgMode:{type:String,values:R,default:"aspectFill"},lazyLoad:{type:Boolean,default:!0},preview:{type:Boolean,default:!0}}),pe=ne(c({__name:"photo-album",props:fe,emits:{click:e=>re(e)},setup(e,{emit:a}){const t=e,o=Z("photo-album"),{imageData:s,imageClickEvent:i}=((e,a)=>{const t=l((()=>{const a=Math.min(e.data.length,e.max);return e.data.slice(0,a)}));return{imageData:t,imageClickEvent:l=>{a("click",l),e.preview&&h({urls:t.value,current:l})}}})(t,a),n=l((()=>{const e={};let a=`calc(100% / ${t.column} - 20rpx)`;return e.width=e.paddingBottom=a,e}));return(e,a)=>{const l=C,r=_;return u(),d(r,{class:p([f(o).b()])},{default:m((()=>[(u(!0),w(b,null,S(f(s),((a,s)=>(u(),d(r,{key:s,class:p([f(o).e("container")]),style:k(f(n)),onClick:x((e=>f(i)(s)),["stop"])},{default:m((()=>[y(r,{class:p(f(o).e("item"))},{default:m((()=>[e.lazyLoad?(u(),d(ve,{key:0,src:a,mode:t.imgMode},null,8,["src","mode"])):(u(),d(l,{key:1,class:p(f(o).e("item__image")),src:a,mode:t.imgMode},null,8,["class","src","mode"]))])),_:2},1032,["class"])])),_:2},1032,["class","style","onClick"])))),128))])),_:1},8,["class"])}}}),[["__scopeId","data-v-d79d4130"]]),ge=ne(c({__name:"avatar-group",props:W({iconConfig:ue.iconConfig,type:ue.type,size:ue.size,shape:ue.shape,imgMode:ue.imgMode,bgColor:ue.bgColor,border:{type:Boolean,default:!0},borderColor:{type:String,default:"tn-white"},borderBold:ue.borderBold,shadow:ue.shadow,shadowColor:ue.shadowColor,badgeConfig:ue.badgeConfig,gap:{type:[String,Number],default:.4}}),emits:{click:e=>"number"==typeof e},setup(l,{emit:o}){const s=l,i=Z("avatar");return((l,o)=>{const{children:s,addChild:i,removeChild:n}=G();e(ce,a({...t(l),avatarItems:s,addItem:i,removeItem:n,handleItemClick:e=>{const a=s.value.findIndex((a=>a.uid===e));o("click",a)}}))})(s,o),(e,a)=>{const t=_;return u(),d(t,{class:p(`${f(i).b("group")}`)},{default:m((()=>[g(e.$slots,"default",{},void 0,!0)])),_:3},8,["class"])}}}),[["__scopeId","data-v-088ce5e4"]]),ye=W({avatar:{type:String,required:!0},title:{type:String,required:!0},description:{type:String,required:!0},tags:{type:te(Array),default:()=>[]},tagBgColor:String,tagTextColor:String,content:String,images:{type:te(Array),default:()=>[]},showMore:{type:Boolean,default:!0},showHot:{type:Boolean,default:!0},activeHot:Boolean,hotCount:{type:Number,default:0},hotIcon:{type:String,default:"rocket"},activeHotIcon:{type:String,default:"rocket-fill"},hotColor:String,activeHotColor:String,showComment:{type:Boolean,default:!0},activeComment:Boolean,commentCount:{type:Number,default:0},commentIcon:{type:String,default:"message"},activeCommentIcon:{type:String,default:"message-fill"},commentColor:String,activeCommentColor:String,showLike:{type:Boolean,default:!0},activeLike:Boolean,likeCount:{type:Number,default:0},likeIcon:{type:String,default:"like-lack"},activeLikeIcon:{type:String,default:"like-fill"},likeColor:String,activeLikeColor:String,showViewUser:{type:Boolean,default:!0},viewCount:{type:Number,default:0},viewUserAvatars:{type:te(Array),default:()=>[]},maxViewUserAvatarCount:{type:Number,default:4}}),ke=ne(c({__name:"index",props:ye,emits:{click:()=>!0,"avatar-view-click":()=>!0,"more-click":()=>!0,"hot-click":()=>!0,"comment-click":()=>!0,"like-click":()=>!0},setup(e,{emit:a}){const t=e,{viewUserAvatars:s,viewUserCount:i,imageCount:n,previewImageHandle:r,cardClickEvent:c,handleAvatarClick:j,handleMoreClick:z,handleCommentClick:$,handleHotClick:B,handleLikeClick:A}=((e,a)=>{const t=o([]),s=o(0);return e.showViewUser&&(t.value=e.viewUserAvatars.slice(0,e.maxViewUserAvatarCount),s.value=e.viewUserAvatars.length),{viewUserAvatars:t,viewUserCount:s,imageCount:l((()=>{var a;return oe(null==(a=null==e?void 0:e.images)?void 0:a.length,0)})),previewImageHandle:a=>{h({urls:e.images,current:a})},cardClickEvent:()=>{a("click")},handleAvatarClick:()=>{a("avatar-view-click")},handleMoreClick:()=>{a("more-click")},handleHotClick:()=>{a("hot-click")},handleCommentClick:()=>{a("comment-click")},handleLikeClick:()=>{a("like-click")}}})(t,a),{ns:M,tagClass:T,tagStyle:H,hotClass:U,hotStyle:V,commentClass:N,commentStyle:D,likeClass:E,likeStyle:R}=(e=>{const a=Z("graphic-card"),[t,o]=le(I(e,"tagBgColor"),"bg"),[s,i]=le(I(e,"tagTextColor"),"text"),[n,r]=le(I(e,"hotColor"),"text"),[c,u]=le(I(e,"activeHotColor"),"text"),[d,m]=le(I(e,"commentColor"),"text"),[v,f]=le(I(e,"activeCommentColor"),"text"),[p,g]=le(I(e,"likeColor"),"text"),[y,k]=le(I(e,"activeLikeColor"),"text"),_=l((()=>{const e=[];return t.value&&e.push(t.value),s.value&&e.push(s.value),e.join(" ")})),C=l((()=>{const e={};return t.value||(e.backgroundColor=o.value||"var(--tn-color-gray-disabled)"),i.value?e.color=i.value:s.value||t.value||(e.color="var(--tn-text-color-primary)"),e})),h=l((()=>{const t=[a.e("hot")];return e.activeHot?c.value&&t.push(c.value):n.value&&t.push(n.value),t.join(" ")})),w=l((()=>{const a={};return e.activeHot?c.value||(a.color=u.value||"var(--tn-color-primary)"):n.value||(a.color=r.value||"var(--tn-color-gray)"),a})),b=l((()=>{const t=[a.e("comment")];return e.activeComment?v.value&&t.push(v.value):d.value&&t.push(d.value),t.join(" ")})),S=l((()=>{const a={};return e.activeComment?v.value||(a.color=f.value||"var(--tn-color-primary)"):d.value||(a.color=m.value||"var(--tn-color-gray)"),a})),x=l((()=>{const t=[a.e("like")];return e.activeLike?y.value&&t.push(y.value):p.value&&t.push(p.value),t.join(" ")})),F=l((()=>{const a={};return e.activeLike?y.value||(a.color=k.value||"var(--tn-color-red)"):p.value||(a.color=g.value||"var(--tn-color-gray)"),a}));return{ns:a,tagClass:_,tagStyle:C,hotClass:h,hotStyle:w,commentClass:b,commentStyle:S,likeClass:x,likeStyle:F}})(t);return(e,a)=>{const t=C,l=_;return u(),d(l,{class:p([f(M).b()]),onClick:f(c)},{default:m((()=>[v(" 简要信息 "),y(l,{class:p([f(M).e("brief-info")])},{default:m((()=>[y(l,{class:p([f(M).e("brief-info__content")])},{default:m((()=>[y(l,{class:p([f(M).e("brief-info__avatar")]),onClick:x(f(j),["stop"])},{default:m((()=>[y(t,{class:"image",src:e.avatar,mode:"aspectFill"},null,8,["src"])])),_:1},8,["class","onClick"]),y(l,{class:p([f(M).e("brief-info__data")])},{default:m((()=>[y(l,{class:"title tn-text-ellipsis-1"},{default:m((()=>[F(L(e.title),1)])),_:1}),e.description?(u(),d(l,{key:0,class:"desc tn-text-ellipsis-1"},{default:m((()=>[F(L(e.description),1)])),_:1})):v("v-if",!0)])),_:1},8,["class"])])),_:1},8,["class"]),e.showMore?(u(),d(l,{key:0,class:p([f(M).e("brief-info__operation")])},{default:m((()=>[g(e.$slots,"briefOperation",{},(()=>[y(l,{class:p([f(M).em("brief-info__operation","more")]),onClick:x(f(z),["stop"])},{default:m((()=>[y(O,{name:"more-vertical"})])),_:1},8,["class","onClick"])]),!0)])),_:3},8,["class"])):v("v-if",!0)])),_:3},8,["class"]),v(" 内容容器 "),y(l,{class:p([f(M).e("container")])},{default:m((()=>[v(" 内容 "),y(l,{class:p([f(M).e("content")])},{default:m((()=>[v(" 标签和内容 "),y(l,{class:p([f(M).e("content__tags")])},{default:m((()=>[(u(!0),w(b,null,S(e.tags,((e,a)=>(u(),d(l,{key:a,class:p(["tag-item",[f(T)]]),style:k(f(H))},{default:m((()=>[y(O,{name:"topics-fill"}),F(" "+L(e),1)])),_:2},1032,["class","style"])))),128))])),_:1},8,["class"]),y(l,{class:p([f(M).e("content__data")])},{default:m((()=>[F(L(e.content),1)])),_:1},8,["class"])])),_:1},8,["class"]),v(" 图片列表 "),f(n)?(u(),d(l,{key:0,class:p([f(M).e("images")])},{default:m((()=>[v(" 一张图片 "),1===f(n)?(u(),d(l,{key:0,class:p([f(M).em("images","item"),f(M).is("one")]),onClick:a[0]||(a[0]=x((e=>f(r)(0)),["stop"]))},{default:m((()=>[y(ve,{src:e.images[0]},null,8,["src"])])),_:1},8,["class"])):v("v-if",!0),v(" 两张图片 "),2===f(n)?(u(),d(l,{key:1,class:p([f(M).em("images","item"),f(M).is("two")])},{default:m((()=>[y(pe,{data:e.images,column:2},null,8,["data"])])),_:1},8,["class"])):v("v-if",!0),v(" 三张图片 "),3===f(n)?(u(),d(l,{key:2,class:p([f(M).em("images","item"),f(M).is("three")])},{default:m((()=>[y(l,{class:"image-wrapper-left"},{default:m((()=>[y(l,{class:"image-container",onClick:a[1]||(a[1]=x((e=>f(r)(0)),["stop"]))},{default:m((()=>[y(ve,{src:e.images[0]},null,8,["src"])])),_:1})])),_:1}),y(l,{class:"image-wrapper-right"},{default:m((()=>[y(l,{class:"image-container",onClick:a[2]||(a[2]=x((e=>f(r)(1)),["stop"]))},{default:m((()=>[y(ve,{src:e.images[1]},null,8,["src"])])),_:1}),y(l,{class:"image-container",onClick:a[3]||(a[3]=x((e=>f(r)(2)),["stop"]))},{default:m((()=>[y(ve,{src:e.images[2]},null,8,["src"])])),_:1})])),_:1})])),_:1},8,["class"])):v("v-if",!0),v(" 四张图片 "),4===f(n)?(u(),d(l,{key:3,class:p([f(M).em("images","item"),f(M).is("four")])},{default:m((()=>[y(pe,{data:e.images,column:2},null,8,["data"])])),_:1},8,["class"])):v("v-if",!0),f(n)>=5?(u(),d(pe,{key:4,data:e.images},null,8,["data"])):v("v-if",!0)])),_:1},8,["class"])):v("v-if",!0)])),_:1},8,["class"]),v(" 底部信息 "),y(l,{class:p([f(M).e("bottom-info"),f(M).is("no-content",!!e.$slots.bottomRight)])},{default:m((()=>[y(l,{class:p([f(M).e("bottom-info__left")])},{default:m((()=>[e.showHot?(u(),d(l,{key:0,class:p(["count-item-data",[f(U)]]),style:k(f(V)),onClick:x(f(B),["stop"])},{default:m((()=>[y(O,{name:e.activeHot?e.activeHotIcon:e.hotIcon},null,8,["name"]),y(l,{class:"count"},{default:m((()=>[F(L(e.hotCount),1)])),_:1})])),_:1},8,["class","style","onClick"])):v("v-if",!0),e.showComment?(u(),d(l,{key:1,class:p(["count-item-data",[f(N)]]),style:k(f(D)),onClick:x(f($),["stop"])},{default:m((()=>[y(O,{name:e.activeComment?e.activeCommentIcon:e.commentIcon},null,8,["name"]),y(l,{class:"count"},{default:m((()=>[F(L(e.commentCount),1)])),_:1})])),_:1},8,["class","style","onClick"])):v("v-if",!0),e.showLike?(u(),d(l,{key:2,class:p(["count-item-data",[f(E)]]),style:k(f(R)),onClick:x(f(A),["stop"])},{default:m((()=>[y(O,{name:e.activeLike?e.activeLikeIcon:e.likeIcon},null,8,["name"]),y(l,{class:"count"},{default:m((()=>[F(L(e.likeCount),1)])),_:1})])),_:1},8,["class","style","onClick"])):v("v-if",!0)])),_:1},8,["class"]),e.showViewUser&&f(s).length||e.$slots.bottomRight?(u(),d(l,{key:0,class:p([f(M).e("bottom-info__right")])},{default:m((()=>[g(e.$slots,"bottomRight",{},(()=>[v(" 查看用户头像列表 "),y(l,{class:p([f(M).e("view-user-list")])},{default:m((()=>[y(ge,{border:"",size:"sm"},{default:m((()=>[(u(!0),w(b,null,S(f(s),((e,a)=>(u(),d(de,{key:a,url:e},null,8,["url"])))),128))])),_:1})])),_:1},8,["class"]),v(" 查看用户数量 "),y(l,{class:p([f(M).e("view-user-count")])},{default:m((()=>[F(L(void 0!==e.viewCount?e.viewCount:f(i))+"人 ",1)])),_:1},8,["class"])]),!0)])),_:3},8,["class"])):v("v-if",!0)])),_:3},8,["class"])])),_:3},8,["class","onClick"])}}}),[["__scopeId","data-v-f36752ab"]]),_e=ne(c({__name:"FollowButton",props:{isFollowed:{type:Boolean,default:!1},size:{default:"sm"},showIcon:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},followText:{default:"关注"},followedText:{default:"已关注"}},setup(e,{emit:a}){const t=e,o=l((()=>t.loading?"处理中...":t.isFollowed?t.followedText:t.followText)),s=l((()=>`size-${t.size}`)),i=l((()=>({sm:"24",md:"28",lg:"32"}[t.size]))),n=l((()=>t.isFollowed?"var(--tn-color-primary)":"#FFFFFF")),r=()=>{t.loading||a("click")};return(a,t)=>{const l=j(z("tn-icon"),O),c=$,g=_;return u(),d(g,{class:p(["follow-button",[e.isFollowed?"followed":"not-followed",f(s),{loading:e.loading}]]),onClick:r},{default:m((()=>[e.showIcon?(u(),d(l,{key:0,name:e.isFollowed?"check":"add",size:f(i),color:f(n),class:"follow-icon"},null,8,["name","size","color"])):v("v-if",!0),y(c,{class:"follow-text"},{default:m((()=>[F(L(f(o)),1)])),_:1})])),_:1},8,["class"])}}}),[["__scopeId","data-v-873a6f82"]]),Ce=c({...{name:"DynamicCard",options:{virtualHost:!0},components:{TnGraphicCard:ke}},props:{dynamic:null},setup(e,{emit:a}){const t=e,o=B(),s=l((()=>`${o.primaryColor||"#7C3AED"}14`)),i=l((()=>o.primaryColor||"#7C3AED")),n=l((()=>{var e;return(null==(e=t.dynamic.topics)?void 0:e.map((e=>e.name)))||[]})),r=l((()=>{const e=t.dynamic.content||"";return e.length>150?e.substring(0,150)+"...":e})),c=e=>{const a=e.replace(" ","T"),t=(new Date).getTime()-new Date(a).getTime(),l=6e4,o=36e5,s=24*o;return t<l?"刚刚":t<o?`${Math.floor(t/l)}分钟前`:t<s?`${Math.floor(t/o)}小时前`:t<7*s?`${Math.floor(t/s)}天前`:e.split(" ")[0]},v=()=>{a("click",t.dynamic)},p=()=>{a("userClick",t.dynamic.user.id)},g=()=>{a("follow",t.dynamic.user.id)},k=()=>{a("share",t.dynamic)},_=()=>{a("like",t.dynamic)},C=()=>{a("comment",t.dynamic)};return(a,t)=>(u(),d(ke,{avatar:e.dynamic.user.avatar,title:e.dynamic.user.nickname,description:c(e.dynamic.createTime),tags:f(n),content:f(r),images:e.dynamic.images,"view-count":e.dynamic.viewCount,"comment-count":e.dynamic.commentCount,"like-count":e.dynamic.likeCount,"active-like":e.dynamic.isLiked,"show-view-user":!1,"show-hot":!0,"hot-count":e.dynamic.viewCount,"tag-bg-color":f(s),"tag-text-color":f(i),onClick:v,onAvatarViewClick:p,onMoreClick:k,onCommentClick:C,onLikeClick:_},{briefOperation:m((()=>[y(_e,{"is-followed":e.dynamic.user.isFollowed,size:"sm",onClick:g},null,8,["is-followed"])])),_:1},8,["avatar","title","description","tags","content","images","view-count","comment-count","like-count","active-like","hot-count","tag-bg-color","tag-text-color"]))}}),he=ne(c({__name:"dynamic",setup(e){const a=A();B(),l((()=>{var e;return null==(e=a.userInfo)?void 0:e.id}));const t=[{label:"全部",value:""},{label:"图文",value:1},{label:"视频",value:2},{label:"案例",value:3},{label:"活动",value:4}],s=[{label:"最新发布",value:"latest"},{label:"最多点赞",value:"like"},{label:"最多评论",value:"comment"},{label:"最多浏览",value:"view"}],i=o(0),n=l((()=>t[i.value].value)),r=o(""),c=o("latest"),g=o(!1),k=l((()=>{const e=s.find((e=>e.value===c.value));return(null==e?void 0:e.label)||"最新发布"})),C=o([]),h=o(!1),x=o(1),I=o(!0),R=async(e=!1)=>{if(!h.value){h.value=!0;try{e&&(x.value=1,C.value=[]);const a={page:x.value,page_size:10};""!==n.value&&(a.dynamic_type=n.value),r.value&&(a.tag=r.value),c.value&&(a.sort=c.value);const t=((await Y(a)).data||[]).map((e=>{var a,t,l;let o=[];e.tags&&("string"==typeof e.tags?o=e.tags.split(",").map((e=>e.trim())).filter(Boolean):Array.isArray(e.tags)&&(o=e.tags));let s=[];return e.video_url||e.video?e.video_cover&&(s=[e.video_cover]):e.images&&e.images.length>0&&(s=e.images),{id:e.id,user:{id:e.user_id||(null==(a=e.user)?void 0:a.id),nickname:(null==(t=e.user)?void 0:t.nickname)||"匿名用户",avatar:(null==(l=e.user)?void 0:l.avatar)||"",isFollowed:e.is_followed||!1},content:e.content||"",images:s,topics:o.map(((e,a)=>({id:a,name:e}))),location:e.location?{name:e.location,lat:0,lng:0}:void 0,viewCount:e.view_count||0,likeCount:e.like_count||0,commentCount:e.comment_count||0,isLiked:e.is_liked||!1,createTime:e.create_time||e.created_at||""}}));e?C.value=t:C.value.push(...t),I.value=10===t.length}catch(a){console.error(a)}finally{h.value=!1}}},G=()=>{I.value&&!h.value&&(x.value++,R())},W=e=>{let a;"number"==typeof e?a=e:e&&"object"==typeof e&&(a=e.id),a&&N({url:`/pages/dynamic_detail/dynamic_detail?id=${a}`})},Z=async e=>{if(a.isLogin)try{await K({id:e.id}),e.isLiked=!e.isLiked,e.likeCount+=e.isLiked?1:-1}catch(t){D({title:t.message||"操作失败",icon:"none"})}else N({url:"/pages/login/login"})},ee=async e=>{if(a.isLogin)try{const a=C.value.find((a=>a.user.id===e));if(!a)return;await Q({follow_type:1,follow_id:e}),a.user.isFollowed=!0,D({title:"关注成功"})}catch(t){D({title:t.message||"操作失败",icon:"none"})}else N({url:"/pages/login/login"})},ae=e=>{D({title:"分享功能开发中",icon:"none"})},te=()=>{r.value="",R(!0)},le=()=>{g.value=!g.value};return M(i,(()=>{R(!0)})),T((e=>{e.tag&&(r.value=decodeURIComponent(e.tag))})),H((()=>{R(!0)})),U((()=>{G()})),V((e=>({title:"婚庆服务动态广场",path:"/pages/dynamic/dynamic"}))),(e,a)=>{const l=j(z("page-meta"),E),o=j(z("tn-icon"),O),n=$,x=_,B=j(z("tn-tabs-item"),q),A=j(z("tn-tabs"),X),M=j(z("tn-loading"),J),T=j(z("tabbar"),P);return u(),w(b,null,[y(l,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),y(x,{class:"dynamic-page"},{default:m((()=>[v(" 话题筛选提示 "),r.value?(u(),d(x,{key:0,class:"tag-filter-banner"},{default:m((()=>[y(x,{class:"tag-filter-content"},{default:m((()=>[y(o,{name:"fire",size:"32",color:"#FFFFFF"}),y(n,{class:"tag-text"},{default:m((()=>[F("话题："+L(r.value),1)])),_:1}),y(x,{class:"clear-filter",onClick:te},{default:m((()=>[y(o,{name:"close",size:"32",color:"#FFFFFF"})])),_:1})])),_:1})])),_:1})):v("v-if",!0),v(" 类型筛选标签 "),y(x,{class:"type-tabs-wrapper"},{default:m((()=>[y(x,{class:"tabs-container"},{default:m((()=>[y(A,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value=e),scroll:!1,height:"70rpx",class:"tabs-main","active-color":e.$theme.primaryColor,"bar-color":e.$theme.primaryColor},{default:m((()=>[(u(),w(b,null,S(t,((e,a)=>y(B,{key:a,title:e.label},null,8,["title"]))),64))])),_:1},8,["modelValue","active-color","bar-color"]),y(x,{class:"sort-btn",onClick:le},{default:m((()=>[y(o,{name:"sort",size:"32",color:e.$theme.primaryColor},null,8,["color"]),y(n,{class:"sort-text"},{default:m((()=>[F(L(f(k)),1)])),_:1}),y(o,{name:g.value?"up":"down",size:"24",color:e.$theme.primaryColor},null,8,["name","color"])])),_:1})])),_:1}),v(" 排序菜单 "),g.value?(u(),d(x,{key:0,class:"sort-menu"},{default:m((()=>[(u(),w(b,null,S(s,((a,t)=>y(x,{key:t,class:p(["sort-menu-item",{"sort-menu-item-active":c.value===a.value}]),onClick:e=>{return t=a.value,c.value=t,g.value=!1,void R(!0);var t}},{default:m((()=>[y(n,{class:"sort-menu-text"},{default:m((()=>[F(L(a.label),1)])),_:2},1024),c.value===a.value?(u(),d(o,{key:0,name:"check",size:"32",color:e.$theme.primaryColor},null,8,["color"])):v("v-if",!0)])),_:2},1032,["class","onClick"]))),64))])),_:1})):v("v-if",!0)])),_:1}),v(" 动态列表 "),y(x,{class:"dynamic-list-wrapper"},{default:m((()=>[v(" 加载中 "),h.value&&0===C.value.length?(u(),d(x,{key:0,class:"loading-state"},{default:m((()=>[y(M,{size:"60",mode:"flower"}),y(n,{class:"loading-text"},{default:m((()=>[F("加载中...")])),_:1})])),_:1})):0===C.value.length?(u(),w(b,{key:1},[v(" 空状态 "),y(x,{class:"empty-state"},{default:m((()=>[y(x,{class:"empty-icon-wrapper"},{default:m((()=>[y(o,{name:"file-text",size:"120",color:"#d1d5db"})])),_:1}),y(n,{class:"empty-title"},{default:m((()=>[F("暂无动态")])),_:1}),y(n,{class:"empty-subtitle"},{default:m((()=>[F("快来发布第一条动态吧~")])),_:1})])),_:1})],2112)):(u(),w(b,{key:2},[v(" 动态列表 - 使用DynamicCard组件 "),y(x,{class:"dynamic-list"},{default:m((()=>[(u(!0),w(b,null,S(C.value,(e=>(u(),d(Ce,{key:e.id,dynamic:e,onClick:W,onLike:Z,onComment:W,onShare:ae,onFollow:ee},null,8,["dynamic"])))),128)),v(" 加载更多提示 "),I.value?(u(),d(x,{key:0,class:"load-more"},{default:m((()=>[h.value?(u(),d(n,{key:0,class:"load-more-text"},{default:m((()=>[F("加载中...")])),_:1})):(u(),d(n,{key:1,class:"load-more-text load-more-clickable",onClick:G},{default:m((()=>[F("加载更多")])),_:1}))])),_:1})):C.value.length>0?(u(),d(x,{key:1,class:"load-more"},{default:m((()=>[y(n,{class:"load-more-text"},{default:m((()=>[F("没有更多了")])),_:1})])),_:1})):v("v-if",!0)])),_:1})],2112))])),_:1}),y(T)])),_:1})],64)}}}),[["__scopeId","data-v-4f3dd8ab"]]);export{he as default};

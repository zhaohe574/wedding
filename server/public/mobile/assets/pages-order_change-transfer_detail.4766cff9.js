import{d as e,s as a,c as t,O as l,o as s,h as r,e as u,w as c,b as o,j as f,F as i,g as _,y as d,t as n,f as v,k as m,aP as y,aD as p,r as g,a as b,m as x,l as k,a_ as w,aJ as h,a5 as j}from"./index-e3492752.js";import{_ as C}from"./navigation-bar.2687311c.js";import{_ as V}from"./page-meta.a4be6114.js";import{l as $,d as z,m as B}from"./orderChange.66dcaaa9.js";import{_ as D}from"./_plugin-vue_export-helper.1b428a4d.js";const F=D(e({__name:"transfer_detail",setup(e){const D=a(!0),F=a(null),I=a(0),J=a(""),N=a(!1),O=t((()=>!!F.value&&(F.value.is_from_user&&F.value.transfer_status<=1||!F.value.is_from_user&&1===F.value.transfer_status))),P=e=>({0:"您的转让申请正在等待审核中",1:"审核已通过，等待接收方确认",2:"接收方已确认，转让即将完成",3:"转让已完成，订单已归属接收方",4:"很抱歉，您的转让申请未通过审核",5:"该转让申请已取消"}[e]||""),S=async()=>{D.value=!0;try{const e=await $({id:I.value});F.value=e}catch(e){console.error(e)}finally{D.value=!1}},U=async()=>{if((await y({title:"提示",content:"确定要取消该转让申请吗？"})).confirm)try{await z({id:I.value}),p({title:"已取消"}),S()}catch(e){p({title:e.message||"操作失败",icon:"none"})}},Y=async()=>{if(J.value&&6===J.value.length){N.value=!0;try{await B({id:I.value,mobile:F.value.to_user_mobile,code:J.value}),p({title:"接收成功"}),S()}catch(e){p({title:e.message||"验证失败",icon:"none"})}finally{N.value=!1}}else p({title:"请输入6位验证码",icon:"none"})};return l((e=>{e.id&&(I.value=Number(e.id),S())})),(e,a)=>{const t=g(b("navigation-bar"),C),l=g(b("page-meta"),V),y=x,p=k,$=w("uni-icons"),z=h,B=j;return s(),r(i,null,[u(l,{"page-style":e.$theme.pageStyle},{default:c((()=>[u(t,{title:"转让详情","front-color":e.$theme.navColor,"background-color":e.$theme.navBgColor},null,8,["front-color","background-color"])])),_:1},8,["page-style"]),u(y,{class:"transfer-detail"},{default:c((()=>{return[D.value?(s(),o(y,{key:0,class:"py-20 text-center text-gray-400"},{default:c((()=>[f(" 加载中... ")])),_:1})):F.value?(s(),r(i,{key:1},[_(" 状态卡片 "),u(y,{class:d(["status-card",(e=F.value.transfer_status,{0:"bg-orange",1:"bg-blue",2:"bg-purple",3:"bg-green",4:"bg-red",5:"bg-gray"}[e]||"bg-gray")])},{default:c((()=>[u(y,{class:"text-lg font-bold"},{default:c((()=>[f(n(F.value.transfer_status_desc),1)])),_:1}),u(y,{class:"text-sm mt-1 opacity-80"},{default:c((()=>[f(n(P(F.value.transfer_status)),1)])),_:1})])),_:1},8,["class"]),_(" 转让信息 "),u(y,{class:"bg-white mt-3 p-4"},{default:c((()=>[u(y,{class:"section-title"},{default:c((()=>[f("转让信息")])),_:1}),u(y,{class:"info-row"},{default:c((()=>[u(p,{class:"label"},{default:c((()=>[f("转让单号")])),_:1}),u(p,{class:"value"},{default:c((()=>[f(n(F.value.transfer_sn),1)])),_:1})])),_:1}),u(y,{class:"info-row"},{default:c((()=>[u(p,{class:"label"},{default:c((()=>[f("申请时间")])),_:1}),u(p,{class:"value"},{default:c((()=>[f(n(F.value.create_time),1)])),_:1})])),_:1}),F.value.audit_time?(s(),o(y,{key:0,class:"info-row"},{default:c((()=>[u(p,{class:"label"},{default:c((()=>[f("审核时间")])),_:1}),u(p,{class:"value"},{default:c((()=>[f(n(F.value.audit_time),1)])),_:1})])),_:1})):_("v-if",!0),F.value.accept_time?(s(),o(y,{key:1,class:"info-row"},{default:c((()=>[u(p,{class:"label"},{default:c((()=>[f("接收时间")])),_:1}),u(p,{class:"value"},{default:c((()=>[f(n(F.value.accept_time),1)])),_:1})])),_:1})):_("v-if",!0),F.value.complete_time?(s(),o(y,{key:2,class:"info-row"},{default:c((()=>[u(p,{class:"label"},{default:c((()=>[f("完成时间")])),_:1}),u(p,{class:"value"},{default:c((()=>[f(n(F.value.complete_time),1)])),_:1})])),_:1})):_("v-if",!0)])),_:1}),_(" 转让双方信息 "),u(y,{class:"bg-white mt-3 p-4"},{default:c((()=>[u(y,{class:"section-title"},{default:c((()=>[f("转让双方")])),_:1}),u(y,{class:"transfer-parties"},{default:c((()=>[u(y,{class:"party-item"},{default:c((()=>[u(y,{class:"party-label"},{default:c((()=>[f("转让方")])),_:1}),u(y,{class:"party-name"},{default:c((()=>[f(n(F.value.from_user_name),1)])),_:1}),u(y,{class:"party-mobile"},{default:c((()=>[f(n(F.value.from_user_mobile),1)])),_:1})])),_:1}),u(y,{class:"transfer-arrow"},{default:c((()=>[u($,{type:"arrowright",size:"24",color:"#999"})])),_:1}),u(y,{class:"party-item"},{default:c((()=>[u(y,{class:"party-label"},{default:c((()=>[f("接收方")])),_:1}),u(y,{class:"party-name"},{default:c((()=>[f(n(F.value.to_user_name),1)])),_:1}),u(y,{class:"party-mobile"},{default:c((()=>[f(n(F.value.to_user_mobile),1)])),_:1}),u(y,{class:"verify-status mt-2"},{default:c((()=>[F.value.to_user_verified?(s(),o(y,{key:0,class:"tag bg-green-100 text-green-600"},{default:c((()=>[f("已验证")])),_:1})):(s(),o(y,{key:1,class:"tag bg-gray-100 text-gray-600"},{default:c((()=>[f("未验证")])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1}),_(" 转让原因 "),F.value.transfer_reason?(s(),o(y,{key:0,class:"bg-white mt-3 p-4"},{default:c((()=>[u(y,{class:"section-title"},{default:c((()=>[f("转让原因")])),_:1}),u(y,{class:"text-gray-600 text-sm"},{default:c((()=>[f(n(F.value.transfer_reason),1)])),_:1})])),_:1})):_("v-if",!0),_(" 审核结果 "),F.value.transfer_status>=4&&F.value.reject_reason?(s(),o(y,{key:1,class:"bg-white mt-3 p-4"},{default:c((()=>[u(y,{class:"section-title"},{default:c((()=>[f("拒绝原因")])),_:1}),u(y,{class:"text-red-500 text-sm"},{default:c((()=>[f(n(F.value.reject_reason),1)])),_:1})])),_:1})):_("v-if",!0),_(" 关联订单 "),F.value.order?(s(),o(y,{key:2,class:"bg-white mt-3 p-4"},{default:c((()=>[u(y,{class:"section-title"},{default:c((()=>[f("关联订单")])),_:1}),u(y,{class:"order-card",onClick:a[0]||(a[0]=e=>{return a=F.value.order.id,void m({url:`/pages/order_detail/order_detail?id=${a}`});var a})},{default:c((()=>[u(y,{class:"flex justify-between items-center"},{default:c((()=>[u(p,{class:"text-sm text-gray-500"},{default:c((()=>[f(n(F.value.order.order_sn),1)])),_:1}),u(p,{class:"text-sm text-primary"},{default:c((()=>[f("查看订单 >")])),_:1})])),_:1}),u(y,{class:"flex justify-between mt-2"},{default:c((()=>[u(p,{class:"text-sm text-gray-600"},{default:c((()=>[f("服务日期: "+n(F.value.order.service_date),1)])),_:1}),u(p,{class:"text-primary font-bold"},{default:c((()=>[f("¥"+n(F.value.order.pay_amount),1)])),_:1})])),_:1})])),_:1})])),_:1})):_("v-if",!0),_(" 底部操作 "),v(O)?(s(),o(y,{key:3,class:"bottom-actions"},{default:c((()=>[_(" 转让方可取消 "),F.value.is_from_user&&F.value.transfer_status<=1?(s(),o(z,{key:0,class:"btn-cancel",onClick:U},{default:c((()=>[f(" 取消转让 ")])),_:1})):_("v-if",!0),_(" 接收方确认 (待接收状态) "),F.value.is_from_user||1!==F.value.transfer_status?_("v-if",!0):(s(),r(i,{key:1},[u(y,{class:"accept-tip"},{default:c((()=>[f("请使用接收方手机号输入验证码确认接收")])),_:1}),u(y,{class:"code-input-area"},{default:c((()=>[u(B,{modelValue:J.value,"onUpdate:modelValue":a[1]||(a[1]=e=>J.value=e),class:"code-input",type:"number",placeholder:"请输入验证码",maxlength:"6"},null,8,["modelValue"]),u(z,{class:"btn-accept",disabled:N.value,onClick:Y},{default:c((()=>[f(n(N.value?"确认中...":"确认接收"),1)])),_:1},8,["disabled"])])),_:1})],64))])),_:1})):_("v-if",!0)],64)):(s(),o(y,{key:2,class:"py-20 text-center text-gray-400"},{default:c((()=>[f(" 数据不存在 ")])),_:1}))];var e})),_:1})],64)}}}),[["__scopeId","data-v-0d6c04e0"]]);export{F as default};

import{d as a,u as e,s as l,M as t,c as s,O as o,o as u,h as r,e as c,w as n,f as d,b as i,g as f,j as _,t as m,n as p,F as v,i as y,aD as g,a0 as b,aU as k,aP as C,aq as h,aV as w,aW as F,r as j,a as z,m as B,l as x,G as V}from"./index-e3492752.js";import{_ as $}from"./navigation-bar.2687311c.js";import{_ as E}from"./page-meta.a4be6114.js";import{_ as N}from"./icon.e613abcd.js";import{_ as M}from"./input.1776ceae.js";import{_ as D}from"./popup.b8b85cf1.js";import{_ as U}from"./loading.2b80eb94.js";import{e as q,o as A,c as P,b as T,d as I,f as S,u as G}from"./order.1e435880.js";import{_ as H}from"./_plugin-vue_export-helper.1b428a4d.js";import"./index.f1be293a.js";import"./is-number.7ef6fec2.js";import"./_objectToString.c905654b.js";import"./event.5568c9d8.js";import"./index.23c2867d.js";import"./install.8446dea8.js";import"./is-empty.c0d66e4a.js";import"./is-boolean.00bf65dc.js";import"./index.89b6df5d.js";import"./index.04c93aab.js";import"./debounce.096fb07a.js";import"./clone-deep.2124c060.js";import"./z-index.5f93cfb9.js";const J=H(a({__name:"order_detail",setup(a){const H=e(),J=l(0),L=l(null),O=l(!1),R=l(!1),W=t({amount:"",reason:""}),K=t({image:"",uploading:!1}),Q=s((()=>{if(!L.value)return 0;if(L.value.deposit_amount>0){if(!L.value.deposit_paid)return L.value.deposit_amount;if(!L.value.balance_paid)return L.value.balance_amount}return L.value.pay_amount})),X=s((()=>!!L.value&&(1===L.value.order_status&&!(4===L.value.pay_type&&0===L.value.pay_voucher_status)))),Y=s((()=>!!L.value&&(1===L.value.order_status&&0!==L.value.pay_voucher_status))),Z=s((()=>{var a;const e=(null==(a=L.value)?void 0:a.items)||[],l=[],t=new Map;return e.forEach((a=>{var e,s,o;const u=a.staff_id??(null==(e=a.staff)?void 0:e.id)??"unknown",r=a.service_date||a.schedule_date||a.date||"",c=`${u}-${r}`;let n=t.get(c);n||(n={key:c,staff:a.staff,staff_name:a.staff_name,staff_avatar:a.staff_avatar,service_date:r,packages:[],total_price:0,packageMap:new Map},t.set(c,n),l.push(n));const d=Number(a.price||0)*Number(a.quantity||1);n.total_price+=d;const i=String(a.package_id??(null==(s=a.package)?void 0:s.id)??a.package_name??"unknown");let f=n.packageMap.get(i);f||(f={key:`${c}-${i}`,package_name:(null==(o=a.package)?void 0:o.name)||a.package_name||"未命名套餐",items:[],total_price:0},n.packageMap.set(i,f),n.packages.push(f)),f.items.push(a),f.total_price+=d})),l.forEach((a=>{a.packages.forEach((a=>{a.items.sort(((a,e)=>Number(a.time_slot||0)-Number(e.time_slot||0)))})),delete a.packageMap})),l})),aa=a=>{if(null==a?void 0:a.time_slot_desc)return a.time_slot_desc;const e={0:"全天",1:"早档",2:"午档",3:"晚档"},l=Number(null==a?void 0:a.time_slot);return Number.isFinite(l)&&l>=0?e[l]||`场次${l}`:(null==a?void 0:a.service_time)?a.service_time:"未知场次"},ea=a=>{const e={0:{background:"linear-gradient(135deg, #F59E0B 0%, #F97316 100%)"},1:{background:"linear-gradient(135deg, #F97316 0%, #FB923C 100%)"},2:{background:"linear-gradient(135deg, #3B82F6 0%, #2563EB 100%)"},3:{background:"linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%)"},4:{background:"linear-gradient(135deg, #19BE6B 0%, #0FA958 100%)"},5:{background:"linear-gradient(135deg, #10B981 0%, #059669 100%)"},6:{background:"linear-gradient(135deg, #9CA3AF 0%, #6B7280 100%)"},7:{background:"linear-gradient(135deg, #F59E0B 0%, #D97706 100%)"},8:{background:"linear-gradient(135deg, #EF4444 0%, #DC2626 100%)"}};return e[a]||e[6]},la=a=>({0:{color:"#FF9900",bg:"rgba(255, 153, 0, 0.1)"},1:{color:"#3574FF",bg:"rgba(53, 116, 255, 0.1)"},2:{color:"#7C4DFF",bg:"rgba(124, 77, 255, 0.1)"},3:{color:"#19BE6B",bg:"rgba(25, 190, 107, 0.1)"},4:{color:"#FF2C3C",bg:"rgba(255, 44, 60, 0.1)"}}[a]||{color:"#999999",bg:"rgba(153, 153, 153, 0.1)"}),ta=async()=>{try{const a=await q({id:J.value});L.value=a}catch(a){g({title:a.message||"加载失败",icon:"none"})}},sa=()=>{b({data:L.value.order_sn,success:()=>{g({title:"已复制订单编号",icon:"success"})}})},oa=async()=>{var a;try{const e=L.value.deposit_paid?L.value.balance_paid?3:2:1,l=await new Promise(((a,e)=>{k({itemList:["微信支付","余额支付","组合支付","线下支付（上传凭证）"],success:e=>{a([1,3,5,4][e.tapIndex])},fail:()=>e(new Error("取消选择"))})}));if(4===l)return void(R.value=!0);const t=await A({id:J.value,pay_way:l,pay_type:e});(null==(a=t.data)?void 0:a.pay_params)?uni.requestPayment({...t.data.pay_params,success:()=>{g({title:"支付成功",icon:"success"}),ta()},fail:()=>{g({title:"支付取消",icon:"none"})}}):(g({title:"支付成功",icon:"success"}),ta())}catch(e){"取消选择"!==(null==e?void 0:e.message)&&g({title:e.message||"支付失败",icon:"none"})}},ua=async()=>{if((await C({title:"提示",content:"确定要取消该订单吗？"})).confirm)try{await P({id:J.value,reason:"用户取消"}),g({title:"订单已取消",icon:"success"}),ta()}catch(a){g({title:a.message||"操作失败",icon:"none"})}},ra=async()=>{if((await C({title:"提示",content:"确定服务已完成吗？"})).confirm)try{await T({id:J.value}),g({title:"订单已完成",icon:"success"}),ta()}catch(a){g({title:a.message||"操作失败",icon:"none"})}},ca=async()=>{if((await C({title:"提示",content:"确定要删除该订单吗？"})).confirm)try{await I({id:J.value}),g({title:"删除成功",icon:"success"}),setTimeout((()=>{h()}),1500)}catch(a){g({title:a.message||"操作失败",icon:"none"})}},na=async()=>{if(!W.amount||Number(W.amount)<=0)g({title:"请输入退款金额",icon:"none"});else if(Number(W.amount)>L.value.pay_amount)g({title:"退款金额不能超过实付金额",icon:"none"});else if(W.reason.trim())try{await S({id:J.value,amount:Number(W.amount),reason:W.reason}),g({title:"申请已提交",icon:"success"}),O.value=!1,W.amount="",W.reason="",ta()}catch(a){g({title:a.message||"申请失败",icon:"none"})}else g({title:"请输入退款原因",icon:"none"})},da=()=>{K.uploading||w({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:async a=>{var e;const l=null==(e=a.tempFilePaths)?void 0:e[0];if(l)try{K.uploading=!0;const a=await F(l);(null==a?void 0:a.url)?K.image=a.url:g({title:"上传失败，请重试",icon:"none"})}catch(t){g({title:t.message||"上传失败",icon:"none"})}finally{K.uploading=!1}}})},ia=async()=>{if(!K.uploading)if(K.image)try{await G({id:J.value,voucher:K.image}),g({title:"凭证已提交",icon:"success"}),R.value=!1,K.image="",ta()}catch(a){g({title:a.message||"提交失败",icon:"none"})}else g({title:"请先选择凭证图片",icon:"none"})};return o((a=>{J.value=Number(a.id),ta()})),(a,e)=>{const l=j(z("navigation-bar"),$),t=j(z("page-meta"),E),s=j(z("tn-icon"),N),o=B,g=x,b=V,k=j(z("tn-input"),M),C=j(z("tn-popup"),D),h=j(z("tn-loading"),U);return u(),r(v,null,[c(t,{"page-style":d(H).pageStyle},{default:n((()=>[c(l,{title:"订单详情","front-color":d(H).navColor,"background-color":d(H).navBgColor},null,8,["front-color","background-color"])])),_:1},8,["page-style"]),L.value?(u(),i(o,{key:0,class:"order-detail"},{default:n((()=>[f(" 订单状态 "),c(o,{class:"status-banner",style:p(ea(L.value.order_status))},{default:n((()=>[c(o,{class:"status-icon"},{default:n((()=>{return[c(s,{name:(a=L.value.order_status,{0:"time-fill",1:"wallet-fill",2:"check-circle-fill",3:"loading",4:"check-circle-fill",5:"check-circle-fill",6:"close-circle-fill",7:"time-fill",8:"refund"}[a]||"document"),size:"48",color:"#FFFFFF"},null,8,["name"])];var a})),_:1}),c(o,{class:"status-text"},{default:n((()=>[c(g,{class:"status-title"},{default:n((()=>[_(m(L.value.order_status_desc),1)])),_:1}),0===L.value.order_status?(u(),i(g,{key:0,class:"status-desc"},{default:n((()=>[_(" 等待工作人员确认 ")])),_:1})):1===L.value.order_status?(u(),i(g,{key:1,class:"status-desc"},{default:n((()=>[_(" 请在30分钟内完成支付 ")])),_:1})):f("v-if",!0)])),_:1})])),_:1},8,["style"]),f(" 联系信息 "),c(o,{class:"contact-card"},{default:n((()=>[c(o,{class:"contact-header"},{default:n((()=>[c(s,{name:"location-fill",size:"32",color:d(H).primaryColor},null,8,["color"]),c(g,{class:"contact-label"},{default:n((()=>[_("服务地址")])),_:1})])),_:1}),c(o,{class:"contact-info"},{default:n((()=>[c(o,{class:"contact-row"},{default:n((()=>[c(g,{class:"contact-name"},{default:n((()=>[_(m(L.value.contact_name),1)])),_:1}),c(g,{class:"contact-phone"},{default:n((()=>[_(m(L.value.contact_mobile),1)])),_:1})])),_:1}),L.value.service_address?(u(),i(o,{key:0,class:"contact-address"},{default:n((()=>[_(m(L.value.service_address),1)])),_:1})):f("v-if",!0)])),_:1})])),_:1}),f(" 服务信息 "),c(o,{class:"service-card"},{default:n((()=>[c(o,{class:"card-header"},{default:n((()=>[c(s,{name:"list",size:"32",color:d(H).primaryColor},null,8,["color"]),c(g,{class:"card-title"},{default:n((()=>[_("服务项目")])),_:1})])),_:1}),c(o,{class:"service-groups"},{default:n((()=>[(u(!0),r(v,null,y(d(Z),(a=>(u(),i(o,{key:a.key,class:"service-group"},{default:n((()=>[c(o,{class:"group-header"},{default:n((()=>[c(o,{class:"staff-section"},{default:n((()=>{var e;return[c(b,{src:(null==(e=a.staff)?void 0:e.avatar)||a.staff_avatar||"/static/images/default-avatar.png",class:"staff-avatar",mode:"aspectFill"},null,8,["src"]),c(o,{class:"staff-info"},{default:n((()=>[c(g,{class:"staff-name"},{default:n((()=>{var e;return[_(m((null==(e=a.staff)?void 0:e.name)||a.staff_name||"未知人员"),1)]})),_:2},1024),c(g,{class:"staff-subtitle"},{default:n((()=>[_(m(a.service_date),1)])),_:2},1024)])),_:2},1024)]})),_:2},1024),c(o,{class:"group-total"},{default:n((()=>[c(g,{class:"group-total-label"},{default:n((()=>[_("小计")])),_:1}),c(g,{class:"group-total-value",style:p({color:d(H).ctaColor})},{default:n((()=>[_("￥"+m(a.total_price),1)])),_:2},1032,["style"])])),_:2},1024)])),_:2},1024),c(o,{class:"group-packages"},{default:n((()=>[(u(!0),r(v,null,y(a.packages,(a=>(u(),i(o,{key:a.key,class:"package-group"},{default:n((()=>[c(o,{class:"package-header"},{default:n((()=>[c(o,{class:"package-title"},{default:n((()=>[c(s,{name:"gift",size:"24"}),c(g,null,{default:n((()=>[_(m(a.package_name),1)])),_:2},1024)])),_:2},1024),c(g,{class:"package-total"},{default:n((()=>[_("￥"+m(a.total_price),1)])),_:2},1024)])),_:2},1024),c(o,{class:"package-items"},{default:n((()=>[(u(!0),r(v,null,y(a.items,(a=>(u(),i(o,{key:a.id,class:"package-item"},{default:n((()=>[c(o,{class:"slot-main"},{default:n((()=>[c(o,{class:"slot-info"},{default:n((()=>[c(o,{class:"slot-row"},{default:n((()=>[c(g,{class:"slot-label"},{default:n((()=>[_(m(aa(a)),1)])),_:2},1024),c(g,{class:"slot-price",style:p({color:d(H).ctaColor})},{default:n((()=>[_("￥"+m(a.price),1)])),_:2},1032,["style"])])),_:2},1024),c(o,{class:"slot-meta"},{default:n((()=>[c(g,{class:"slot-quantity"},{default:n((()=>[_("x"+m(a.quantity),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),c(o,{class:"info-card"},{default:n((()=>[c(o,{class:"card-header"},{default:n((()=>[c(s,{name:"document",size:"32",color:d(H).primaryColor},null,8,["color"]),c(g,{class:"card-title"},{default:n((()=>[_("订单信息")])),_:1})])),_:1}),c(o,{class:"info-list"},{default:n((()=>[c(o,{class:"info-row"},{default:n((()=>[c(g,{class:"info-label"},{default:n((()=>[_("订单编号")])),_:1}),c(o,{class:"info-value-row",onClick:sa},{default:n((()=>[c(g,{class:"info-value"},{default:n((()=>[_(m(L.value.order_sn),1)])),_:1}),c(s,{name:"copy",size:"28",color:"#999999"})])),_:1})])),_:1}),c(o,{class:"info-row"},{default:n((()=>[c(g,{class:"info-label"},{default:n((()=>[_("下单时间")])),_:1}),c(g,{class:"info-value"},{default:n((()=>[_(m(L.value.create_time),1)])),_:1})])),_:1}),L.value.service_date?(u(),i(o,{key:0,class:"info-row"},{default:n((()=>[c(g,{class:"info-label"},{default:n((()=>[_("服务日期")])),_:1}),c(g,{class:"info-value"},{default:n((()=>[_(m(L.value.service_date),1)])),_:1})])),_:1})):f("v-if",!0),L.value.wedding_date?(u(),i(o,{key:1,class:"info-row"},{default:n((()=>[c(g,{class:"info-label"},{default:n((()=>[_("婚礼日期")])),_:1}),c(g,{class:"info-value"},{default:n((()=>[_(m(L.value.wedding_date),1)])),_:1})])),_:1})):f("v-if",!0),L.value.wedding_venue?(u(),i(o,{key:2,class:"info-row"},{default:n((()=>[c(g,{class:"info-label"},{default:n((()=>[_("婚礼地点")])),_:1}),c(g,{class:"info-value"},{default:n((()=>[_(m(L.value.wedding_venue),1)])),_:1})])),_:1})):f("v-if",!0),L.value.pay_time?(u(),i(o,{key:3,class:"info-row"},{default:n((()=>[c(g,{class:"info-label"},{default:n((()=>[_("支付时间")])),_:1}),c(g,{class:"info-value"},{default:n((()=>[_(m(L.value.pay_time),1)])),_:1})])),_:1})):f("v-if",!0),L.value.user_remark?(u(),i(o,{key:4,class:"info-row"},{default:n((()=>[c(g,{class:"info-label"},{default:n((()=>[_("备注")])),_:1}),c(g,{class:"info-value remark"},{default:n((()=>[_(m(L.value.user_remark),1)])),_:1})])),_:1})):f("v-if",!0)])),_:1})])),_:1}),f(" 金额明细 "),c(o,{class:"amount-card"},{default:n((()=>[c(o,{class:"card-header"},{default:n((()=>[c(s,{name:"money",size:"32",color:d(H).primaryColor},null,8,["color"]),c(g,{class:"card-title"},{default:n((()=>[_("金额明细")])),_:1})])),_:1}),c(o,{class:"amount-list"},{default:n((()=>[c(o,{class:"amount-row"},{default:n((()=>[c(g,{class:"amount-label"},{default:n((()=>[_("商品总额")])),_:1}),c(g,{class:"amount-value"},{default:n((()=>[_("¥"+m(L.value.total_amount),1)])),_:1})])),_:1}),L.value.discount_amount>0?(u(),i(o,{key:0,class:"amount-row"},{default:n((()=>[c(g,{class:"amount-label"},{default:n((()=>[_("优惠金额")])),_:1}),c(g,{class:"amount-value discount"},{default:n((()=>[_("-¥"+m(L.value.discount_amount),1)])),_:1})])),_:1})):f("v-if",!0),L.value.coupon_amount>0?(u(),i(o,{key:1,class:"amount-row"},{default:n((()=>[c(g,{class:"amount-label"},{default:n((()=>[_("优惠券")])),_:1}),c(g,{class:"amount-value discount"},{default:n((()=>[_("-¥"+m(L.value.coupon_amount),1)])),_:1})])),_:1})):f("v-if",!0),c(o,{class:"amount-divider"}),c(o,{class:"amount-row total"},{default:n((()=>[c(g,{class:"amount-label"},{default:n((()=>[_("实付金额")])),_:1}),c(g,{class:"amount-value primary",style:p({color:d(H).ctaColor})},{default:n((()=>[_(" ¥"+m(L.value.pay_amount),1)])),_:1},8,["style"])])),_:1}),L.value.deposit_amount>0?(u(),i(o,{key:2,class:"amount-row"},{default:n((()=>[c(g,{class:"amount-label"},{default:n((()=>[_("定金")])),_:1}),c(o,{class:"amount-value-row"},{default:n((()=>[c(g,{class:"amount-value"},{default:n((()=>[_("¥"+m(L.value.deposit_amount),1)])),_:1}),c(g,{class:"amount-status",style:p({color:L.value.deposit_paid?"#19BE6B":"#FF9900",backgroundColor:L.value.deposit_paid?"rgba(25, 190, 107, 0.1)":"rgba(255, 153, 0, 0.1)"})},{default:n((()=>[_(m(L.value.deposit_paid?"已付":"待付"),1)])),_:1},8,["style"])])),_:1})])),_:1})):f("v-if",!0),L.value.balance_amount>0?(u(),i(o,{key:3,class:"amount-row"},{default:n((()=>[c(g,{class:"amount-label"},{default:n((()=>[_("尾款")])),_:1}),c(o,{class:"amount-value-row"},{default:n((()=>[c(g,{class:"amount-value"},{default:n((()=>[_("¥"+m(L.value.balance_amount),1)])),_:1}),c(g,{class:"amount-status",style:p({color:L.value.balance_paid?"#19BE6B":"#FF9900",backgroundColor:L.value.balance_paid?"rgba(25, 190, 107, 0.1)":"rgba(255, 153, 0, 0.1)"})},{default:n((()=>[_(m(L.value.balance_paid?"已付":"待付"),1)])),_:1},8,["style"])])),_:1})])),_:1})):f("v-if",!0)])),_:1})])),_:1}),f(" 线下支付凭证 "),4===L.value.pay_type||L.value.pay_voucher?(u(),i(o,{key:0,class:"voucher-card"},{default:n((()=>[c(o,{class:"card-header"},{default:n((()=>[c(s,{name:"image",size:"32",color:d(H).primaryColor},null,8,["color"]),c(g,{class:"card-title"},{default:n((()=>[_("线下支付凭证")])),_:1})])),_:1}),c(o,{class:"voucher-body"},{default:n((()=>[c(o,{class:"voucher-row"},{default:n((()=>[c(g,{class:"voucher-label"},{default:n((()=>[_("凭证状态")])),_:1}),c(g,{class:"voucher-status"},{default:n((()=>[_(m(L.value.pay_voucher_status_desc||"未上传"),1)])),_:1})])),_:1}),L.value.pay_voucher_audit_remark?(u(),i(o,{key:0,class:"voucher-row"},{default:n((()=>[c(g,{class:"voucher-label"},{default:n((()=>[_("审核备注")])),_:1}),c(g,{class:"voucher-remark"},{default:n((()=>[_(m(L.value.pay_voucher_audit_remark),1)])),_:1})])),_:1})):f("v-if",!0),L.value.pay_voucher?(u(),i(o,{key:1,class:"voucher-image"},{default:n((()=>[c(b,{src:L.value.pay_voucher,mode:"aspectFill"},null,8,["src"])])),_:1})):(u(),i(o,{key:2,class:"voucher-empty"},{default:n((()=>[c(g,null,{default:n((()=>[_("暂无凭证")])),_:1})])),_:1}))])),_:1})])),_:1})):f("v-if",!0),f(" 退款信息 "),L.value.refund?(u(),i(o,{key:1,class:"refund-card"},{default:n((()=>[c(o,{class:"card-header"},{default:n((()=>[c(s,{name:"refund",size:"32",color:"#FF2C3C"}),c(g,{class:"card-title"},{default:n((()=>[_("退款信息")])),_:1})])),_:1}),c(o,{class:"refund-list"},{default:n((()=>[c(o,{class:"refund-row"},{default:n((()=>[c(g,{class:"refund-label"},{default:n((()=>[_("退款状态")])),_:1}),c(g,{class:"refund-status",style:p({color:la(L.value.refund.refund_status).color,backgroundColor:la(L.value.refund.refund_status).bg})},{default:n((()=>[_(m(L.value.refund.refund_status_desc),1)])),_:1},8,["style"])])),_:1}),c(o,{class:"refund-row"},{default:n((()=>[c(g,{class:"refund-label"},{default:n((()=>[_("退款金额")])),_:1}),c(g,{class:"refund-value"},{default:n((()=>[_("¥"+m(L.value.refund.refund_amount),1)])),_:1})])),_:1}),c(o,{class:"refund-row"},{default:n((()=>[c(g,{class:"refund-label"},{default:n((()=>[_("退款原因")])),_:1}),c(g,{class:"refund-reason"},{default:n((()=>[_(m(L.value.refund.refund_reason),1)])),_:1})])),_:1})])),_:1})])),_:1})):f("v-if",!0),f(" 底部按钮 "),c(o,{class:"action-bar"},{default:n((()=>[c(o,{class:"action-buttons"},{default:n((()=>[[0,1].includes(L.value.order_status)?(u(),i(o,{key:0,class:"btn-secondary",style:p({borderColor:d(H).primaryColor,color:d(H).primaryColor}),onClick:ua},{default:n((()=>[c(g,null,{default:n((()=>[_("取消订单")])),_:1})])),_:1},8,["style"])):f("v-if",!0),d(X)?(u(),i(o,{key:1,class:"btn-primary",style:p({background:`linear-gradient(135deg, ${d(H).ctaColor} 0%, ${d(H).ctaColor} 100%)`,color:d(H).btnColor}),onClick:oa},{default:n((()=>[c(s,{name:"wallet-fill",size:"32",color:d(H).btnColor},null,8,["color"]),c(g,null,{default:n((()=>[_("立即支付 ¥"+m(d(Q)),1)])),_:1})])),_:1},8,["style"])):f("v-if",!0),d(Y)?(u(),i(o,{key:2,class:"btn-secondary",style:p({borderColor:d(H).primaryColor,color:d(H).primaryColor}),onClick:e[0]||(e[0]=a=>R.value=!0)},{default:n((()=>[c(g,null,{default:n((()=>[_("上传凭证")])),_:1})])),_:1},8,["style"])):f("v-if",!0),3===L.value.order_status?(u(),i(o,{key:3,class:"btn-primary",style:p({background:`linear-gradient(135deg, ${d(H).primaryColor} 0%, ${d(H).primaryColor} 100%)`,color:d(H).btnColor}),onClick:ra},{default:n((()=>[c(s,{name:"check-circle-fill",size:"32",color:d(H).btnColor},null,8,["color"]),c(g,null,{default:n((()=>[_("确认完成")])),_:1})])),_:1},8,["style"])):f("v-if",!0),[2,3].includes(L.value.order_status)&&!L.value.refund?(u(),i(o,{key:4,class:"btn-secondary",style:{borderColor:"#FF2C3C",color:"#FF2C3C"},onClick:e[1]||(e[1]=a=>O.value=!0)},{default:n((()=>[c(g,null,{default:n((()=>[_("申请退款")])),_:1})])),_:1})):f("v-if",!0),[4,5,6,8].includes(L.value.order_status)?(u(),i(o,{key:5,class:"btn-secondary",style:{borderColor:"#999999",color:"#999999"},onClick:ca},{default:n((()=>[c(g,null,{default:n((()=>[_("删除订单")])),_:1})])),_:1})):f("v-if",!0)])),_:1})])),_:1}),f(" 退款弹窗 "),c(C,{modelValue:O.value,"onUpdate:modelValue":e[6]||(e[6]=a=>O.value=a),mode:"bottom","border-radius":"32"},{default:n((()=>[c(o,{class:"refund-popup"},{default:n((()=>[c(o,{class:"popup-header"},{default:n((()=>[c(g,{class:"popup-title"},{default:n((()=>[_("申请退款")])),_:1}),c(s,{name:"close",size:"40",color:"#999999",onClick:e[2]||(e[2]=a=>O.value=!1)})])),_:1}),c(o,{class:"popup-content"},{default:n((()=>[c(o,{class:"form-item"},{default:n((()=>[c(g,{class:"form-label"},{default:n((()=>[_("退款金额")])),_:1}),c(k,{modelValue:W.amount,"onUpdate:modelValue":e[3]||(e[3]=a=>W.amount=a),type:"number",placeholder:`最多可退 ¥${L.value.pay_amount}`,border:""},null,8,["modelValue","placeholder"])])),_:1}),c(o,{class:"form-item"},{default:n((()=>[c(g,{class:"form-label"},{default:n((()=>[_("退款原因")])),_:1}),c(k,{modelValue:W.reason,"onUpdate:modelValue":e[4]||(e[4]=a=>W.reason=a),type:"textarea",placeholder:"请输入退款原因",maxlength:200,border:"",height:"200"},null,8,["modelValue"])])),_:1})])),_:1}),c(o,{class:"popup-actions"},{default:n((()=>[c(o,{class:"popup-btn cancel",style:p({borderColor:d(H).primaryColor,color:d(H).primaryColor}),onClick:e[5]||(e[5]=a=>O.value=!1)},{default:n((()=>[c(g,null,{default:n((()=>[_("取消")])),_:1})])),_:1},8,["style"]),c(o,{class:"popup-btn confirm",style:p({background:`linear-gradient(135deg, ${d(H).primaryColor} 0%, ${d(H).primaryColor} 100%)`,color:d(H).btnColor}),onClick:na},{default:n((()=>[c(g,null,{default:n((()=>[_("提交申请")])),_:1})])),_:1},8,["style"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),f(" 线下凭证上传弹窗 "),c(C,{modelValue:R.value,"onUpdate:modelValue":e[10]||(e[10]=a=>R.value=a),mode:"bottom","border-radius":"32"},{default:n((()=>[c(o,{class:"voucher-popup"},{default:n((()=>[c(o,{class:"popup-header"},{default:n((()=>[c(g,{class:"popup-title"},{default:n((()=>[_("上传支付凭证")])),_:1}),c(s,{name:"close",size:"40",color:"#999999",onClick:e[7]||(e[7]=a=>R.value=!1)})])),_:1}),c(o,{class:"popup-content"},{default:n((()=>[c(o,{class:"form-item"},{default:n((()=>[c(g,{class:"form-label"},{default:n((()=>[_("凭证图片")])),_:1}),c(o,{class:"voucher-upload"},{default:n((()=>[K.image?(u(),i(o,{key:0,class:"voucher-preview"},{default:n((()=>[c(b,{src:K.image,mode:"aspectFill"},null,8,["src"]),c(o,{class:"voucher-remove",onClick:e[8]||(e[8]=a=>K.image="")},{default:n((()=>[c(s,{name:"close",size:"24",color:"#FFFFFF"})])),_:1})])),_:1})):(u(),i(o,{key:1,class:"voucher-add",onClick:da},{default:n((()=>[c(s,{name:"add",size:"48",color:"#CCCCCC"}),c(g,{class:"voucher-add-text"},{default:n((()=>[_("选择图片")])),_:1})])),_:1}))])),_:1})])),_:1})])),_:1}),c(o,{class:"popup-actions"},{default:n((()=>[c(o,{class:"popup-btn cancel",style:p({borderColor:d(H).primaryColor,color:d(H).primaryColor}),onClick:e[9]||(e[9]=a=>R.value=!1)},{default:n((()=>[c(g,null,{default:n((()=>[_("取消")])),_:1})])),_:1},8,["style"]),c(o,{class:"popup-btn confirm",style:p({background:`linear-gradient(135deg, ${d(H).primaryColor} 0%, ${d(H).primaryColor} 100%)`,color:d(H).btnColor}),onClick:ia},{default:n((()=>[c(g,null,{default:n((()=>[_(m(K.uploading?"上传中...":"提交审核"),1)])),_:1})])),_:1},8,["style"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),c(o,{class:"safe-bottom"})])),_:1})):(u(),i(o,{key:1,class:"loading-container"},{default:n((()=>[c(h,{mode:"circle"}),c(g,{class:"loading-text"},{default:n((()=>[_("加载中...")])),_:1})])),_:1}))],64)}}}),[["__scopeId","data-v-fc273575"]]);export{J as default};

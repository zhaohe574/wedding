import{d as a,u as e,s as l,aS as t,bD as o,U as s,o as u,h as n,e as r,w as c,f as i,g as d,n as f,j as _,b as p,t as m,F as y,i as g,bn as v,k as h,r as k,a as b,m as C,l as $}from"./index-e3492752.js";import{_ as j}from"./navigation-bar.2687311c.js";import{_ as F}from"./page-meta.a4be6114.js";import{_ as w}from"./icon.e613abcd.js";import{_ as x}from"./loading.2b80eb94.js";import{g as z,b as S}from"./coupon.4848d9a7.js";import{_ as N}from"./_plugin-vue_export-helper.1b428a4d.js";import"./index.f1be293a.js";import"./index.89b6df5d.js";const D=N(a({__name:"center",setup(a){const N=e(),D=l(!1),E=l([]),q=l({}),B=l(1),I=l(!0),M=a=>{const e=Number(a.valid_type||0),l=Number(a.valid_days||0);if(2===e&&l)return`领取后${l}天有效`;const t=Number(a.valid_start_time||0),o=Number(a.valid_end_time||0);if(!t&&!o)return"长期有效";const s=a=>{if(!a)return"";const e=new Date(1e3*a);return`${e.getFullYear()}.${String(e.getMonth()+1).padStart(2,"0")}.${String(e.getDate()).padStart(2,"0")}`};return t&&o?`${s(t)}-${s(o)}`:t?`${s(t)}起`:`${s(o)}止`},R=async()=>{try{const a=await z();q.value=a||{}}catch(a){console.error(a)}},U=async(a=!1)=>{if(!D.value&&(a||I.value)){a&&(B.value=1,I.value=!0),D.value=!0;try{const e=await S({page:B.value,limit:10}),l=e.lists||[];E.value=a?l:[...E.value,...l],I.value=e.has_more,I.value&&B.value++}catch(e){console.error(e)}finally{D.value=!1,v()}}},V=()=>{h({url:"/pages/coupon/list"})};return t((()=>{U()})),o((()=>{R(),U(!0)})),s((()=>{R(),U(!0)})),(a,e)=>{const l=k(b("navigation-bar"),j),t=k(b("page-meta"),F),o=k(b("tn-icon"),w),s=C,v=$,z=k(b("tn-loading"),x);return u(),n(y,null,[r(t,{"page-style":i(N).pageStyle},{default:c((()=>[r(l,{title:"领券中心","front-color":i(N).navColor,"background-color":i(N).navBgColor},null,8,["front-color","background-color"])])),_:1},8,["page-style"]),r(s,{class:"coupon-center-page"},{default:c((()=>[d(" 顶部入口卡片 "),r(s,{class:"top-entry",onClick:V},{default:c((()=>[r(s,{class:"entry-card"},{default:c((()=>[r(s,{class:"entry-left"},{default:c((()=>[r(s,{class:"icon-wrapper",style:f({background:`linear-gradient(135deg, ${i(N).primaryColor} 0%, ${i(N).primaryColor} 100%)`})},{default:c((()=>[r(o,{name:"coupon-fill",size:"40",color:"#FFFFFF"})])),_:1},8,["style"]),r(s,{class:"entry-info"},{default:c((()=>[r(v,{class:"entry-title"},{default:c((()=>[_("我的优惠券")])),_:1}),q.value.unused>0?(u(),p(v,{key:0,class:"entry-desc"},{default:c((()=>[_(m(q.value.unused)+"张可用",1)])),_:1})):(u(),p(v,{key:1,class:"entry-desc"},{default:c((()=>[_("暂无可用优惠券")])),_:1}))])),_:1})])),_:1}),r(o,{name:"right",size:"32",color:"#999999"})])),_:1})])),_:1}),d(" 优惠券列表 "),r(s,{class:"section-header"},{default:c((()=>[r(s,{class:"section-title"},{default:c((()=>[r(s,{class:"title-icon",style:f({background:i(N).primaryColor})},null,8,["style"]),r(v,null,{default:c((()=>[_("可领取优惠券")])),_:1})])),_:1}),E.value.length?(u(),p(v,{key:0,class:"section-count"},{default:c((()=>[_("共"+m(E.value.length)+"张",1)])),_:1})):d("v-if",!0)])),_:1}),E.value.length?(u(),p(s,{key:0,class:"list-wrap"},{default:c((()=>[(u(!0),n(y,null,g(E.value,(a=>(u(),p(s,{key:a.id,class:"coupon-card",onClick:e=>(a=>{(null==a?void 0:a.id)&&h({url:`/pages/coupon/detail?id=${a.id}`})})(a)},{default:c((()=>[d(" 优惠券左侧金额区 "),r(s,{class:"coupon-left",style:f({background:`linear-gradient(135deg, ${i(N).ctaColor} 0%, ${i(N).ctaColor} 100%)`})},{default:c((()=>[r(s,{class:"coupon-value"},{default:c((()=>[2===a.coupon_type?(u(),n(y,{key:0},[r(v,{class:"num"},{default:c((()=>[_(m((a.discount_amount/10).toFixed(1)),1)])),_:2},1024),r(v,{class:"unit"},{default:c((()=>[_("折")])),_:1})],64)):(u(),n(y,{key:1},[r(v,{class:"symbol"},{default:c((()=>[_("¥")])),_:1}),r(v,{class:"num"},{default:c((()=>[_(m(a.discount_amount),1)])),_:2},1024)],64))])),_:2},1024),r(s,{class:"coupon-threshold"},{default:c((()=>[_(m(a.threshold_amount>0?`满${a.threshold_amount}元`:"无门槛"),1)])),_:2},1024)])),_:2},1032,["style"]),r(s,{class:"coupon-content"},{default:c((()=>[d(" 优惠券右侧信息区 "),r(s,{class:"coupon-right"},{default:c((()=>[r(s,{class:"coupon-header"},{default:c((()=>[r(v,{class:"coupon-name"},{default:c((()=>[_(m(a.name),1)])),_:2},1024),r(s,{class:"coupon-tag",style:f({background:2===a.coupon_type?"rgba(249, 115, 22, 0.1)":"rgba(124, 58, 237, 0.1)",color:2===a.coupon_type?"#F97316":i(N).primaryColor})},{default:c((()=>[_(m(a.coupon_type_text),1)])),_:2},1032,["style"]),r(o,{name:"right",size:"26",color:"#C0C4CC",class:"detail-arrow"})])),_:2},1024),r(s,{class:"coupon-desc",style:f({color:i(N).ctaColor})},{default:c((()=>[_(m(a.discount_desc),1)])),_:2},1032,["style"]),r(s,{class:"coupon-info"},{default:c((()=>[r(s,{class:"info-item"},{default:c((()=>[r(o,{name:"time",size:"24",color:"#999999"}),r(v,null,{default:c((()=>[_(m(M(a)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):D.value?d("v-if",!0):(u(),n(y,{key:1},[d(" 空状态 "),r(s,{class:"empty-state"},{default:c((()=>[r(s,{class:"empty-icon-wrapper"},{default:c((()=>[r(o,{name:"coupon",size:"120",color:"#E5E5E5"})])),_:1}),r(v,{class:"empty-text"},{default:c((()=>[_("暂无可领取的优惠券")])),_:1}),r(v,{class:"empty-desc"},{default:c((()=>[_("敬请期待更多优惠活动")])),_:1})])),_:1})],2112)),d(" 加载状态 "),D.value&&1===B.value?(u(),p(s,{key:2,class:"loading-state"},{default:c((()=>[r(z,{mode:"flower",color:i(N).primaryColor},null,8,["color"]),r(v,{class:"loading-text"},{default:c((()=>[_("加载中...")])),_:1})])),_:1})):d("v-if",!0),d(" 加载更多 "),D.value&&B.value>1?(u(),p(s,{key:3,class:"loading-more"},{default:c((()=>[r(z,{mode:"circle",size:"small",color:i(N).primaryColor},null,8,["color"]),r(v,null,{default:c((()=>[_("加载更多...")])),_:1})])),_:1})):d("v-if",!0),d(" 没有更多 "),!D.value&&!I.value&&E.value.length>0?(u(),p(s,{key:4,class:"no-more"},{default:c((()=>[r(v,null,{default:c((()=>[_("没有更多了")])),_:1})])),_:1})):d("v-if",!0),d(" 底部安全区 "),r(s,{class:"safe-bottom"})])),_:1})],64)}}}),[["__scopeId","data-v-e41f106c"]]);export{D as default};

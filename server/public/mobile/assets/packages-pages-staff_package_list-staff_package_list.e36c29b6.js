import{d as e,s as a,P as t,o as s,h as l,e as i,w as o,F as n,i as r,b as c,j as p,g as u,aD as d,r as m,a as g,m as f,t as _,aP as y,k as x}from"./index-e3492752.js";import{_ as v}from"./navigation-bar.2687311c.js";import{_ as b}from"./page-meta.a4be6114.js";import{_ as k}from"./tabs-item.3a07d27c.js";import{_ as j}from"./tabs.f4a1a0ed.js";import{_ as h}from"./button.c1dc664f.js";import{e as C,h as w,i as $,j as V}from"./staff-center.563e3f5c.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./badge.46a4bc76.js";import"./icon.e613abcd.js";import"./index.f1be293a.js";import"./index.89b6df5d.js";import"./is-number.7ef6fec2.js";import"./_objectToString.c905654b.js";import"./is-empty.c0d66e4a.js";import"./index.04c93aab.js";import"./event.5568c9d8.js";import"./is-boolean.00bf65dc.js";import"./loading.2b80eb94.js";import"./debounce.096fb07a.js";const z=e({__name:"staff_package_list",setup(e){const z=[{key:"configured",label:"已关联"},{key:"available",label:"可选套餐"}],P=a(0),S=a([]),T=a([]),B=e=>{var a;return(null==(a=e.package)?void 0:a.name)||e.name||"套餐"},D=e=>{var a;return e.custom_price??e.price??(null==(a=e.package)?void 0:a.price)??0},F=e=>{var a;const t=e.booking_type??(null==(a=e.package)?void 0:a.booking_type)??0;return 1===Number(t)?"分场次":"全天"},N=async()=>{try{const e=await w();S.value=(null==e?void 0:e.configured)||[],T.value=(null==e?void 0:e.available)||[]}catch(e){const a="string"==typeof e?e:(null==e?void 0:e.msg)||(null==e?void 0:e.message)||"加载失败";d({title:a,icon:"none"})}};return t((async()=>{await C()&&N()})),(e,a)=>{const t=m(g("navigation-bar"),v),C=m(g("page-meta"),b),w=m(g("tn-tabs-item"),k),R=m(g("tn-tabs"),j),U=f,q=m(g("tn-button"),h);return s(),l(n,null,[i(C,{"page-style":e.$theme.pageStyle},{default:o((()=>[i(t,{title:"套餐管理","front-color":e.$theme.navColor,"background-color":e.$theme.navBgColor},null,8,["front-color","background-color"])])),_:1},8,["page-style"]),i(U,{class:"min-h-screen bg-[#f6f6f6] pb-[40rpx]"},{default:o((()=>[i(U,{class:"bg-white"},{default:o((()=>[i(R,{modelValue:P.value,"onUpdate:modelValue":a[0]||(a[0]=e=>P.value=e),scroll:!1,height:"80rpx","active-color":e.$theme.primaryColor},{default:o((()=>[(s(),l(n,null,r(z,(e=>i(w,{key:e.key,title:e.label},null,8,["title"]))),64))])),_:1},8,["modelValue","active-color"])])),_:1}),i(U,{class:"px-[24rpx] mt-[20rpx]"},{default:o((()=>[0===P.value?(s(),c(U,{key:0},{default:o((()=>[0===S.value.length?(s(),c(U,{key:0,class:"text-center text-gray-400 py-[80rpx]"},{default:o((()=>[p("暂无已关联套餐")])),_:1})):u("v-if",!0),(s(!0),l(n,null,r(S.value,(e=>(s(),c(U,{key:e.package_id,class:"bg-white rounded-lg p-[20rpx] mb-[20rpx]"},{default:o((()=>[i(U,{class:"text-base font-semibold text-[#333]"},{default:o((()=>[p(_(B(e)),1)])),_:2},1024),i(U,{class:"text-xs text-gray-400 mt-[8rpx]"},{default:o((()=>[p(" 价格：¥"+_(D(e))+" · "+_(F(e))+" · "+_(e.status?"启用":"禁用"),1)])),_:2},1024),i(U,{class:"flex justify-end gap-[16rpx] mt-[16rpx]"},{default:o((()=>[i(q,{size:"sm",type:"primary",shape:"round",plain:!0,onClick:a=>(e=>{x({url:`/packages/pages/staff_package_edit/staff_package_edit?package_id=${e.package_id}`,success:a=>{a.eventChannel.emit("detail",e)}})})(e)},{default:o((()=>[p(" 编辑 ")])),_:2},1032,["onClick"]),i(q,{size:"sm",type:"danger",shape:"round",plain:!0,onClick:a=>(e=>{y({title:"确认移除",content:"移除后将不再显示该套餐，是否继续？",success:async a=>{if(a.confirm)try{await V({package_id:e.package_id}),d({title:"移除成功",icon:"success"}),N()}catch(t){const e="string"==typeof t?t:(null==t?void 0:t.msg)||(null==t?void 0:t.message)||"移除失败";d({title:e,icon:"none"})}}})})(e)},{default:o((()=>[p(" 移除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(s(),c(U,{key:1},{default:o((()=>[0===T.value.length?(s(),c(U,{key:0,class:"text-center text-gray-400 py-[80rpx]"},{default:o((()=>[p("暂无可关联套餐")])),_:1})):u("v-if",!0),(s(!0),l(n,null,r(T.value,(e=>(s(),c(U,{key:e.id,class:"bg-white rounded-lg p-[20rpx] mb-[20rpx]"},{default:o((()=>[i(U,{class:"text-base font-semibold text-[#333]"},{default:o((()=>[p(_(e.name),1)])),_:2},1024),i(U,{class:"text-xs text-gray-400 mt-[8rpx]"},{default:o((()=>[p("价格：¥"+_(e.price||0),1)])),_:2},1024),i(U,{class:"flex justify-end mt-[16rpx]"},{default:o((()=>[i(q,{size:"sm",type:"primary",shape:"round",plain:!0,onClick:a=>(async e=>{try{await $({package_id:e.id}),d({title:"关联成功",icon:"success"}),N()}catch(a){const e="string"==typeof a?a:(null==a?void 0:a.msg)||(null==a?void 0:a.message)||"关联失败";d({title:e,icon:"none"})}})(e)},{default:o((()=>[p(" 关联 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}))])),_:1})])),_:1})],64)}}});export{z as default};

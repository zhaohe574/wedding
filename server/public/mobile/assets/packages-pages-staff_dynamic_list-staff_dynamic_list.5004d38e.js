import{d as a,s as e,P as t,o as s,h as l,e as n,w as o,j as i,F as r,i as p,k as d,r as u,a as c,m,b as f,t as g,aP as _,aD as y}from"./index-e3492752.js";import{_ as x}from"./navigation-bar.2687311c.js";import{_ as v}from"./page-meta.a4be6114.js";import{_ as h}from"./button.c1dc664f.js";import{_ as b}from"./z-paging.18d58ff3.js";import{e as j,n as k,o as C}from"./staff-center.563e3f5c.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./icon.e613abcd.js";import"./index.f1be293a.js";import"./loading.2b80eb94.js";import"./index.89b6df5d.js";import"./debounce.096fb07a.js";const w=a({__name:"staff_dynamic_list",setup(a){const w=e(null),z=e([]),V=async(a,e)=>{try{const t=await k({page:a,page_size:e}),s=(null==t?void 0:t.data)||[];w.value.complete(s)}catch(t){w.value.complete(!1)}},$=()=>{d({url:"/packages/pages/staff_dynamic_edit/staff_dynamic_edit"})};return t((async()=>{var a;await j()&&(null==(a=w.value)||a.reload())})),(a,e)=>{const t=u(c("navigation-bar"),x),j=u(c("page-meta"),v),k=u(c("tn-button"),h),P=m,R=u(c("z-paging"),b);return s(),l(r,null,[n(j,{"page-style":a.$theme.pageStyle},{default:o((()=>[n(t,{title:"动态管理","front-color":a.$theme.navColor,"background-color":a.$theme.navBgColor},null,8,["front-color","background-color"])])),_:1},8,["page-style"]),n(P,{class:"min-h-screen bg-[#f6f6f6]"},{default:o((()=>[n(R,{ref_key:"pagingRef",ref:w,modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=a=>z.value=a),onQuery:V,auto:!0},{top:o((()=>[n(P,{class:"bg-white px-[24rpx] py-[20rpx]"},{default:o((()=>[n(k,{type:"primary",shape:"round",size:"md",onClick:$},{default:o((()=>[i(" 发布动态 ")])),_:1})])),_:1})])),default:o((()=>[n(P,{class:"px-[24rpx] pb-[24rpx]"},{default:o((()=>[(s(!0),l(r,null,p(z.value,(a=>(s(),f(P,{key:a.id,class:"bg-white rounded-lg p-[20rpx] mb-[20rpx]"},{default:o((()=>[n(P,{class:"text-sm text-gray-500"},{default:o((()=>{return[i(g((t=a.dynamic_type,{1:"图文",2:"视频",3:"案例",4:"活动"}[t]||"动态"))+" · "+g((e=a.status,{0:"待审核",1:"已发布",2:"已下架",3:"审核拒绝"}[e]||"未知")),1)];var e,t})),_:2},1024),n(P,{class:"text-base text-[#333] mt-[8rpx] line-clamp-2"},{default:o((()=>[i(g(a.content),1)])),_:2},1024),n(P,{class:"text-xs text-gray-400 mt-[8rpx]"},{default:o((()=>{var e;return[i(" 图片 "+g((null==(e=a.images)?void 0:e.length)||0)+" · 视频 "+g(a.video_url?"1":"0"),1)]})),_:2},1024),n(P,{class:"flex justify-end gap-[16rpx] mt-[16rpx]"},{default:o((()=>[n(k,{size:"sm",type:"primary",shape:"round",plain:!0,onClick:e=>(a=>{d({url:`/packages/pages/staff_dynamic_edit/staff_dynamic_edit?id=${a.id}`,success:e=>{e.eventChannel.emit("detail",a)}})})(a)},{default:o((()=>[i(" 编辑 ")])),_:2},1032,["onClick"]),n(k,{size:"sm",type:"danger",shape:"round",plain:!0,onClick:e=>(a=>{_({title:"确认删除",content:"删除后不可恢复，是否继续？",success:async e=>{if(e.confirm)try{await C({id:a.id}),y({title:"删除成功",icon:"success"}),w.value.reload()}catch(t){const a="string"==typeof t?t:(null==t?void 0:t.msg)||(null==t?void 0:t.message)||"删除失败";y({title:a,icon:"none"})}}})})(a)},{default:o((()=>[i(" 删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue"])])),_:1})],64)}}});export{w as default};

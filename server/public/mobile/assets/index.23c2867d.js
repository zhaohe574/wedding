var e=Object.defineProperty,r=(r,t,s)=>(((r,t,s)=>{t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s})(r,"symbol"!=typeof t?t+"":t,s),s);import{be as t,aZ as s,c as n,V as a,bd as i,as as l,s as o,T as u,f as d,v as f,x as c,by as p,d as m,Y as y,M as g,a7 as h,o as v,b,w as q,z as F,y as w,m as $,bq as x,U as j,bz as A,e as O,g as E,n as S,j as P,t as I}from"./index-e3492752.js";import{w as _,a as k}from"./install.8446dea8.js";import{r as V,h as z,e as C,i as R,j as M,k as D,I as L,l as N,M as T,b as B,d as W,u as Z,f as J,g as K}from"./index.f1be293a.js";import{i as U}from"./is-boolean.00bf65dc.js";import{h as Y}from"./icon.e613abcd.js";import"./index.89b6df5d.js";import{_ as H}from"./_plugin-vue_export-helper.1b428a4d.js";import{u as G}from"./index.04c93aab.js";import{i as Q}from"./is-empty.c0d66e4a.js";import{d as X}from"./debounce.096fb07a.js";import{c as ee}from"./clone-deep.2124c060.js";function re(e,r){if(Array.isArray(e))return!1;const s=typeof e;return!("number"!=s&&"symbol"!=s&&"boolean"!=s&&null!=e&&!t(e))||(V.test(e)||!z.test(e)||null!=r&&e in Object(r))}function te(e){return null==e?"":C(e)}const se=function(e){e=te(e);const r=[];return R.test(e)&&r.push(""),e.replace(M,((e,t,s,n)=>(r.push(s?n.replace(D,"$1"):t||e),""))),r};function ne(e){return Array.isArray(e)?e:se(e)}function ae(e){if("string"==typeof e||t(e))return e;const r=`${e}`;return"0"==r&&1/e==-L?"-0":r}function ie(e,r,t){const s=null==e?void 0:function(e,r){let t=0;const s=(r=re(r,e)?[r]:ne(r)).length;for(;null!=e&&t<s;)e=e[ae(r[t++])];return t&&t==s?e:void 0}(e,r);return void 0===s?t:s}function le(e,r){return!!(r=null==r?T:r)&&("number"==typeof e||N.test(e))&&e>-1&&e%1==0&&e<r}const oe=Object.prototype.hasOwnProperty;function ue(e,r,t){const s=e[r];oe.call(e,r)&&function(e,r){return e===r||e!=e&&r!=r}(s,t)&&(void 0!==t||r in e)||(e[r]=t)}function de(e,r,t){return null==e?e:function(e,r,t,n){if(!s(e))return e;let a=-1;const i=(r=re(r,e)?[r]:ne(r)).length,l=i-1;let o=e;for(;null!=o&&++a<i;){const e=ae(r[a]);let i=t;if(a!=l){const t=o[e];i=n?n(t,e,o):void 0,void 0===i&&(i=s(t)?t:le(r[a+1])?[]:{})}ue(o,e,i),o=o[e]}return e}(e,r,t)}function fe(e){return!e||Array.isArray(e)&&!e.length?[]:Array.isArray(e)?e:[e]}const ce=(e,r,t)=>({get value(){return ie(e,r,t)},set value(t){de(e,r,t)}}),pe=e=>{const r=a();return n((()=>{var t;return Q(null==(t=null==r?void 0:r.proxy)?void 0:t.$props)[e]}))},me=Symbol("formContextKey"),ye=Symbol("formItemContextKey"),ge=B({size:{type:String,values:Y},disabled:Boolean}),he=B({...ge,model:Object,rules:{type:W([Object,Array])},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean}),ve={validate:(e,r,t)=>(i(e)||l(e))&&U(r)&&l(t)},be=(e,r={})=>{const t=o(void 0),s=r.prop?t:pe("size"),a=r.form?{size:void 0}:u(me,void 0),i=r.formItem?{size:void 0}:u(ye,void 0);return n((()=>s.value||d(e)||(null==i?void 0:i.size)||(null==a?void 0:a.size)||""))},qe=e=>{const r=pe("disabled"),t=u(me,void 0);return n((()=>r.value||d(e)||(null==t?void 0:t.disabled)||!1))},Fe=()=>({form:u(me,void 0),formItem:u(ye,void 0)}),we=/%[sdj%]/g;let $e=()=>{};function xe(e){if(!e||!e.length)return null;const r={};return e.forEach((e=>{const t=e.field;r[t]=r[t]||[],r[t].push(e)})),r}function je(e,...r){let t=0;const s=r.length;if("function"==typeof e)return e.apply(null,r);if("string"==typeof e){return e.replace(we,(e=>{if("%%"===e)return"%";if(t>=s)return e;switch(e){case"%s":return String(r[t++]);case"%d":return Number(r[t++]);case"%j":try{return JSON.stringify(r[t++])}catch(n){return"[Circular]"}break;default:return e}}))}return e}function Ae(e,r){return null==e||(!("array"!==r||!Array.isArray(e)||e.length)||!(!function(e){return"string"===e||"url"===e||"hex"===e||"email"===e||"date"===e||"pattern"===e}(r)||"string"!=typeof e||e))}function Oe(e,r,t){let s=0;const n=e.length;!function a(i){if(i&&i.length)return void t(i);const l=s;s+=1,l<n?r(e[l],a):t([])}([])}"undefined"!=typeof process&&process.env;class Ee extends Error{constructor(e,t){super("Async Validation Error"),r(this,"errors"),r(this,"fields"),this.errors=e,this.fields=t}}function Se(e,r,t,s,n){if(r.first){const r=new Promise(((r,a)=>{const i=function(e){const r=[];return Object.keys(e).forEach((t=>{r.push(...e[t]||[])})),r}(e);Oe(i,t,(e=>(s(e),e.length?a(new Ee(e,xe(e))):r(n))))}));return r.catch((e=>e)),r}const a=!0===r.firstFields?Object.keys(e):r.firstFields||[],i=Object.keys(e),l=i.length;let o=0;const u=[],d=new Promise(((r,d)=>{const f=e=>{if(u.push.apply(u,e),o++,o===l)return s(u),u.length?d(new Ee(u,xe(u))):r(n)};i.length||(s(u),r(n)),i.forEach((r=>{const s=e[r];-1!==a.indexOf(r)?Oe(s,t,f):function(e,r,t){const s=[];let n=0;const a=e.length;function i(e){s.push(...e||[]),n++,n===a&&t(s)}e.forEach((e=>{r(e,i)}))}(s,t,f)}))}));return d.catch((e=>e)),d}function Pe(e,r){return t=>{let s;return s=e.fullFields?function(e,r){let t=e;for(let s=0;s<r.length;s++){if(null==t)return t;t=t[r[s]]}return t}(r,e.fullFields):r[t.field||e.fullField],(n=t)&&void 0!==n.message?(t.field=t.field||e.fullField,t.fieldValue=s,t):{message:"function"==typeof t?t():t,fieldValue:s,field:t.field||e.fullField};var n}}function Ie(e,r){if(r)for(const t in r)if(r.hasOwnProperty(t)){const s=r[t];"object"==typeof s&&"object"==typeof e[t]?e[t]={...e[t],...s}:e[t]=s}return e}const _e=(e,r,t,s,n,a)=>{!e.required||t.hasOwnProperty(e.field)&&!Ae(r,a||e.type)||s.push(je(n.messages.required,e.fullField))};let ke;const Ve=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,ze=/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i,Ce={integer:e=>Ce.number(e)&&parseInt(e,10)===e,float:e=>Ce.number(e)&&!Ce.integer(e),array:e=>Array.isArray(e),regexp(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch(r){return!1}},date:e=>"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear&&!isNaN(e.getTime()),number:e=>!isNaN(e)&&"number"==typeof e,object:e=>"object"==typeof e&&!Ce.array(e),method:e=>"function"==typeof e,email:e=>"string"==typeof e&&e.length<=320&&!!e.match(Ve),url:e=>"string"==typeof e&&e.length<=2048&&!!e.match((()=>{if(ke)return ke;const e="[a-fA-F\\d:]",r=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${e})|(?<=${e})(?=\\s|$))`:"",t="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",s="[a-fA-F\\d]{1,4}",n=`\n(?:\n(?:${s}:){7}(?:${s}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:${s}:){6}(?:${t}|:${s}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:${s}:){5}(?::${t}|(?::${s}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:${s}:){4}(?:(?::${s}){0,1}:${t}|(?::${s}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:${s}:){3}(?:(?::${s}){0,2}:${t}|(?::${s}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:${s}:){2}(?:(?::${s}){0,3}:${t}|(?::${s}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:${s}:){1}(?:(?::${s}){0,4}:${t}|(?::${s}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::${s}){0,5}:${t}|(?::${s}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),a=new RegExp(`(?:^${t}$)|(?:^${n}$)`),i=new RegExp(`^${t}$`),l=new RegExp(`^${n}$`),o=e=>e&&e.exact?a:new RegExp(`(?:${r(e)}${t}${r(e)})|(?:${r(e)}${n}${r(e)})`,"g");o.v4=e=>e&&e.exact?i:new RegExp(`${r(e)}${t}${r(e)}`,"g"),o.v6=e=>e&&e.exact?l:new RegExp(`${r(e)}${n}${r(e)}`,"g");const u=o.v4().source,d=o.v6().source;return ke=new RegExp(`(?:^(?:(?:(?:[a-z]+:)?//)|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|${u}|${d}|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#][^\\s"]*)?$)`,"i"),ke})()),hex:e=>"string"==typeof e&&!!e.match(ze)},Re="enum",Me={required:_e,whitespace:(e,r,t,s,n)=>{(/^\s+$/.test(r)||""===r)&&s.push(je(n.messages.whitespace,e.fullField))},type:(e,r,t,s,n)=>{if(e.required&&void 0===r)return void _e(e,r,t,s,n);const a=e.type;["integer","float","array","regexp","object","method","email","number","date","url","hex"].indexOf(a)>-1?Ce[a](r)||s.push(je(n.messages.types[a],e.fullField,e.type)):a&&typeof r!==e.type&&s.push(je(n.messages.types[a],e.fullField,e.type))},range:(e,r,t,s,n)=>{const a="number"==typeof e.len,i="number"==typeof e.min,l="number"==typeof e.max,o=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g;let u=r,d=null;const f="number"==typeof r,c="string"==typeof r,p=Array.isArray(r);if(f?d="number":c?d="string":p&&(d="array"),!d)return!1;p&&(u=r.length),c&&(u=r.replace(o,"_").length),a?u!==e.len&&s.push(je(n.messages[d].len,e.fullField,e.len)):i&&!l&&u<e.min?s.push(je(n.messages[d].min,e.fullField,e.min)):l&&!i&&u>e.max?s.push(je(n.messages[d].max,e.fullField,e.max)):i&&l&&(u<e.min||u>e.max)&&s.push(je(n.messages[d].range,e.fullField,e.min,e.max))},enum:(e,r,t,s,n)=>{e[Re]=Array.isArray(e[Re])?e[Re]:[],-1===e[Re].indexOf(r)&&s.push(je(n.messages[Re],e.fullField,e[Re].join(", ")))},pattern:(e,r,t,s,n)=>{if(e.pattern)if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(r)||s.push(je(n.messages.pattern.mismatch,e.fullField,r,e.pattern));else if("string"==typeof e.pattern){new RegExp(e.pattern).test(r)||s.push(je(n.messages.pattern.mismatch,e.fullField,r,e.pattern))}}},De=(e,r,t,s,n)=>{const a=e.type,i=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r,a)&&!e.required)return t();Me.required(e,r,s,i,n,a),Ae(r,a)||Me.type(e,r,s,i,n)}t(i)},Le={string:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r,"string")&&!e.required)return t();Me.required(e,r,s,a,n,"string"),Ae(r,"string")||(Me.type(e,r,s,a,n),Me.range(e,r,s,a,n),Me.pattern(e,r,s,a,n),!0===e.whitespace&&Me.whitespace(e,r,s,a,n))}t(a)},method:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r)&&!e.required)return t();Me.required(e,r,s,a,n),void 0!==r&&Me.type(e,r,s,a,n)}t(a)},number:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(""===r&&(r=void 0),Ae(r)&&!e.required)return t();Me.required(e,r,s,a,n),void 0!==r&&(Me.type(e,r,s,a,n),Me.range(e,r,s,a,n))}t(a)},boolean:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r)&&!e.required)return t();Me.required(e,r,s,a,n),void 0!==r&&Me.type(e,r,s,a,n)}t(a)},regexp:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r)&&!e.required)return t();Me.required(e,r,s,a,n),Ae(r)||Me.type(e,r,s,a,n)}t(a)},integer:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r)&&!e.required)return t();Me.required(e,r,s,a,n),void 0!==r&&(Me.type(e,r,s,a,n),Me.range(e,r,s,a,n))}t(a)},float:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r)&&!e.required)return t();Me.required(e,r,s,a,n),void 0!==r&&(Me.type(e,r,s,a,n),Me.range(e,r,s,a,n))}t(a)},array:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(null==r&&!e.required)return t();Me.required(e,r,s,a,n,"array"),null!=r&&(Me.type(e,r,s,a,n),Me.range(e,r,s,a,n))}t(a)},object:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r)&&!e.required)return t();Me.required(e,r,s,a,n),void 0!==r&&Me.type(e,r,s,a,n)}t(a)},enum:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r)&&!e.required)return t();Me.required(e,r,s,a,n),void 0!==r&&Me.enum(e,r,s,a,n)}t(a)},pattern:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r,"string")&&!e.required)return t();Me.required(e,r,s,a,n),Ae(r,"string")||Me.pattern(e,r,s,a,n)}t(a)},date:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r,"date")&&!e.required)return t();if(Me.required(e,r,s,a,n),!Ae(r,"date")){let t;t=r instanceof Date?r:new Date(r),Me.type(e,t,s,a,n),t&&Me.range(e,t.getTime(),s,a,n)}}t(a)},url:De,hex:De,email:De,required:(e,r,t,s,n)=>{const a=[],i=Array.isArray(r)?"array":typeof r;Me.required(e,r,s,a,n,i),t(a)},any:(e,r,t,s,n)=>{const a=[];if(e.required||!e.required&&s.hasOwnProperty(e.field)){if(Ae(r)&&!e.required)return t();Me.required(e,r,s,a,n)}t(a)}};function Ne(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone(){const e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}const Te=Ne(),Be=class{constructor(e){r(this,"rules",null),r(this,"_messages",Te),this.define(e)}define(e){if(!e)throw new Error("Cannot configure a schema with no rules");if("object"!=typeof e||Array.isArray(e))throw new Error("Rules must be an object");this.rules={},Object.keys(e).forEach((r=>{const t=e[r];this.rules[r]=Array.isArray(t)?t:[t]}))}messages(e){return e&&(this._messages=Ie(Ne(),e)),this._messages}validate(e,r={},t=()=>{}){let s=e,n=r,a=t;if("function"==typeof n&&(a=n,n={}),!this.rules||0===Object.keys(this.rules).length)return a&&a(null,s),Promise.resolve(s);if(n.messages){let e=this.messages();e===Te&&(e=Ne()),Ie(e,n.messages),n.messages=e}else n.messages=this.messages();const i={};(n.keys||Object.keys(this.rules)).forEach((r=>{const t=this.rules[r];let n=s[r];t.forEach((t=>{let a=t;"function"==typeof a.transform&&(s===e&&(s={...s}),n=s[r]=a.transform(n)),a="function"==typeof a?{validator:a}:{...a},a.validator=this.getValidationMethod(a),a.validator&&(a.field=r,a.fullField=a.fullField||r,a.type=this.getType(a),i[r]=i[r]||[],i[r].push({rule:a,value:n,source:s,field:r}))}))}));const l={};return Se(i,n,((e,r)=>{var t;const a=e.rule;let i,o=!("object"!==a.type&&"array"!==a.type||"object"!=typeof a.fields&&"object"!=typeof a.defaultField);function u(e,r){return{...r,fullField:`${a.fullField}.${e}`,fullFields:a.fullFields?[...a.fullFields,e]:[e]}}function d(t=[]){let i=Array.isArray(t)?t:[t];!n.suppressWarning&&i.length&&Be.warning("async-validator:",i),i.length&&void 0!==a.message&&(i=[].concat(a.message));let d=i.map(Pe(a,s));if(n.first&&d.length)return l[a.field]=1,r(d);if(o){if(a.required&&!e.value)return void 0!==a.message?d=[].concat(a.message).map(Pe(a,s)):n.error&&(d=[n.error(a,je(n.messages.required,a.field))]),r(d);let t={};a.defaultField&&Object.keys(e.value).map((e=>{t[e]=a.defaultField})),t={...t,...e.rule.fields};const i={};Object.keys(t).forEach((e=>{const r=t[e],s=Array.isArray(r)?r:[r];i[e]=s.map(u.bind(null,e))}));const l=new Be(i);l.messages(n.messages),e.rule.options&&(e.rule.options.messages=n.messages,e.rule.options.error=n.error),l.validate(e.value,e.rule.options||n,(e=>{const t=[];d&&d.length&&t.push(...d),e&&e.length&&t.push(...e),r(t.length?t:null)}))}else r(d)}if(o=o&&(a.required||!a.required&&e.value),a.field=e.field,a.asyncValidator)i=a.asyncValidator(a,e.value,d,e.source,n);else if(a.validator){try{i=a.validator(a,e.value,d,e.source,n)}catch(f){null==(t=console.error)||t.call(console,f),n.suppressValidatorError||setTimeout((()=>{throw f}),0),d(f.message)}!0===i?d():!1===i?d("function"==typeof a.message?a.message(a.fullField||a.field):a.message||`${a.fullField||a.field} fails`):i instanceof Array?d(i):i instanceof Error&&d(i.message)}i&&i.then&&i.then((()=>d()),(e=>d(e)))}),(e=>{!function(e){let r=[],t={};for(let s=0;s<e.length;s++)n=e[s],Array.isArray(n)?r=r.concat(...n):r.push(n);var n;r.length?(t=xe(r),a(r,t)):a(null,s)}(e)}),s)}getType(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!=typeof e.validator&&e.type&&!Le.hasOwnProperty(e.type))throw new Error(je("Unknown rule type %s",e.type));return e.type||"string"}getValidationMethod(e){if("function"==typeof e.validator)return e.validator;const r=Object.keys(e),t=r.indexOf("message");return-1!==t&&r.splice(t,1),1===r.length&&"required"===r[0]?Le.required:Le[this.getType(e)]||void 0}};let We=Be;r(We,"register",(function(e,r){if("function"!=typeof r)throw new Error("Cannot register a validator by type, validator is not a function");Le[e]=r})),r(We,"warning",$e),r(We,"messages",Te),r(We,"validators",Le);const Ze=(e,r)=>{const t=u(me,void 0);let s,a=!1;const i=o(""),d=o(""),m=o(""),y=n((()=>!(!e.label&&!r.label))),g=n((()=>`${e.label||""}${(null==t?void 0:t.labelSuffix)||""}`)),h=n((()=>{const r=null==t?void 0:t.model;if(r&&e.prop)return ce(r,e.prop).value})),v=n((()=>e.prop?l(e.prop)?e.prop:e.prop.join("."):"")),b=n((()=>{const r=[];e.rules&&r.push(...fe(e.rules));const s=null==t?void 0:t.rules;if(s&&e.prop){const t=ce(s,e.prop).value;t&&r.push(...fe(t))}if(void 0!==e.required){const t=r.map(((e,r)=>[e,r])).filter((([e])=>Object.keys(e).includes("required")));if(t.length)for(const[s,n]of t)s.required!==e.required&&(r[n]={...s,required:e.required});else r.push({required:e.required})}return r})),q=n((()=>b.value.length>0)),F=n((()=>b.value.some((e=>e.required)))),w=n((()=>"error"===d.value&&e.showMessage&&Q(null==t?void 0:t.showMessage,!0))),$=e=>{i.value=e},x=async r=>{const s=v.value;return new We({[s]:r}).validate({[s]:h.value},{firstFields:!0}).then((()=>($("success"),m.value="",null==t||t.emits("validate",e.prop,!0,""),!0))).catch((r=>((r=>{var s;const{errors:n,fields:a}=r;n&&a||console.error(r),$("error"),m.value=n?Q(null==(s=null==n?void 0:n[0])?void 0:s.message,`${e.prop} 为必填项`):"",null==t||t.emits("validate",e.prop,!1,m.value)})(r),Promise.reject(r))))},j=()=>{$(""),m.value="",a=!1},A=X((()=>{d.value=i.value}),100);return f((()=>i.value),(()=>A())),f((()=>e.error),(e=>{m.value=e||"",$(e?"error":"")}),{immediate:!0}),f((()=>e.validateStatus),(e=>{$(e||"")})),{formContext:t,hasLabel:y,currentLabel:g,validateState:i,validateMessage:m,isRequired:F,shouldShowError:w,doValidate:x,validate:async(r,t)=>{if(a||!e.prop)return!1;const s=p(t);if(!q.value)return null==t||t(!1),!1;const n=(e=>b.value.filter((r=>!r.trigger||!e||(Array.isArray(r.trigger)?r.trigger.includes(e):r.trigger===e))).map((({trigger:e,...r})=>r)))(r);return 0===n.length?(null==t||t(!0),!0):($("validating"),x(n).then((()=>(null==t||t(!0),!0))).catch((e=>{const{fields:r}=e;return null==t||t(!1,r),!s&&Promise.reject(r)})))},clearValidate:j,resetField:async()=>{const r=null==t?void 0:t.model;if(!r||!e.prop)return;const n=ce(r,e.prop);a=!0,n.value=ee(s),await c(),j(),a=!1},initFieldValue:()=>{s=ee(h.value)}}},Je=(e,r)=>{const t=fe(r);return t.length>0?e.filter((e=>e.prop&&t.includes(e.prop))):e},Ke=e=>{const r=[],t=n((()=>{const r=!!e.model;return r||console.warn("[TnForm] model参数未定义"),r})),s=async e=>{if(!t.value)return!1;const s=(e=>{if(0===r.length)return[];const t=Je(r,e);return t.length?t:(console.warn("[TnForm] 未找到需要校验的字段"),[])})(e);if(0===s.length)return!1;let n={};for(const r of s)try{await r.validate("")}catch(a){n={...n,...a}}return 0===Object.keys(n).length||Promise.reject(n)},a=async(e=[],r)=>{const t=!p(r);try{const t=await s(e);return!0===t&&(null==r||r(!0)),t}catch(n){if(n instanceof Error)throw n;const e=n;return null==r||r(!1,e),t&&Promise.reject(e)}};return{addField:e=>{r.push(e)},removeField:e=>{e.prop&&r.splice(r.indexOf(e),1)},resetFields:(t=[])=>{if(!e.model)return console.warn("[TnForm] model参数未定义");Je(r,t).forEach((e=>e.resetField()))},clearValidate:(e=[])=>{Je(r,e).forEach((e=>e.clearValidate()))},validate:async e=>a(void 0,e),validateField:a}},Ue=H(m({__name:"form",props:he,emits:ve,setup(e,{expose:r,emit:t}){const s=e,{formClass:a}=(()=>{const e=Z("form");return{formClass:n((()=>[e.b()].join(" ")))}})(),{addField:i,removeField:l,resetFields:o,clearValidate:u,validate:c,validateField:p}=Ke(s);return f((()=>s.rules),(()=>{s.validateOnRuleChange&&c()}),{deep:!0}),y(me,g({...h(s),emits:t,resetFields:o,clearValidate:u,validateField:p,addField:i,removeField:l})),r({validate:c,validateField:p,resetFields:o,clearValidate:u}),(e,r)=>{const t=$;return v(),b(t,{class:w([d(a)])},{default:q((()=>[F(e.$slots,"default",{},void 0,!0)])),_:3},8,["class"])}}}),[["__scopeId","data-v-d3b3b2ef"]]),Ye=H(m({__name:"form-item",props:B({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top"],default:""},prop:{type:W([String,Array])},required:{type:Boolean,default:void 0},rules:{type:W([Object,Array])},error:String,validateStatus:{type:String,values:["","error","validating","success"]},showMessage:{type:Boolean,default:!0},size:{type:String,values:Y}}),setup(e,{expose:r}){const t=e,s=x(),{formContext:a,validateState:i,validateMessage:l,hasLabel:f,currentLabel:p,shouldShowError:m,isRequired:_,resetField:k,clearValidate:V,validate:z,initFieldValue:C}=Ze(t,s),{ns:R,labelId:M,formItemClass:D,formItemLabelClass:L,formItemLabelStyle:N,formItemErrorMessageStyle:T,initLabelContainerWidth:B}=((e,r,t)=>{const s=u(me,void 0),a=Z("form-item"),i=be(void 0,{formItem:!1}),{getSelectorNodeInfo:l}=G(),d=n((()=>J(e.labelWidth||(null==s?void 0:s.labelWidth)||""))),f=n((()=>e.labelPosition||(null==s?void 0:s.labelPosition)||"right")),c=n((()=>(null==s?void 0:s.hideRequiredAsterisk)||!1)),p=n((()=>(null==s?void 0:s.requireAsteriskPosition)||"left")),m=o(0),y=`label-${K()}`,g=n((()=>{const e=[a.b()];return i.value&&e.push(a.m(i.value)),f.value&&e.push(a.m(`label-${f.value}`)),e.join(" ")})),h=n((()=>{const e=[a.e("label")];return!c.value&&t.value&&e.push(a.em("label","required"),a.em("label",`asterisk-${p.value}`)),e.join(" ")})),v=n((()=>{const e={};return"top"!==f.value&&d.value&&(e.width=d.value),e})),b=n((()=>{const e={};return"top"!==f.value&&r.value&&(e.paddingLeft=`${m.value}px`),e}));return{ns:a,labelId:y,formItemClass:g,formItemLabelClass:h,formItemLabelStyle:v,formItemErrorMessageStyle:b,initLabelContainerWidth:()=>{r.value&&l(`#${y}`).then((e=>{m.value=(null==e?void 0:e.width)||0}))}}})(t,f,_),W=be(void 0,{formItem:!1}),U=g({...h(t),size:W,validateState:i,hasLabel:f,resetField:k,clearValidate:V,validate:z});return j((()=>{t.prop&&(null==a||a.addField(U),C()),c((()=>{B()}))})),A((()=>{null==a||a.removeField(U)})),y(ye,U),r({size:W,validateMessage:l,validateState:i,validate:z,resetField:k,clearValidate:V}),(e,r)=>{const t=$;return v(),b(t,{class:w([d(D)])},{default:q((()=>[O(t,{class:w([d(R).e("wrapper")])},{default:q((()=>[E(" label "),d(f)?(v(),b(t,{key:0,id:d(M),class:w([d(L)]),style:S(d(N))},{default:q((()=>[F(e.$slots,"label",{},(()=>[P(I(d(p)),1)]),!0)])),_:3},8,["id","class","style"])):E("v-if",!0),E(" 表单组件 "),O(t,{class:w([d(R).e("content")])},{default:q((()=>[F(e.$slots,"default",{},void 0,!0)])),_:3},8,["class"])])),_:3},8,["class"]),E(" 错误信息 "),d(m)?(v(),b(t,{key:0,class:w(["tn-red_text",[d(R).e("error-message")]]),style:S(d(T))},{default:q((()=>[P(I(d(l)),1)])),_:1},8,["class","style"])):E("v-if",!0)])),_:3},8,["class"])}}}),[["__scopeId","data-v-f2f674a7"]]);_(Ue,{FormItem:Ye}),k(Ye);export{qe as a,Fe as b,te as t,be as u};

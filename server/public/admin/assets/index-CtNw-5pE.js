import{D as de,B as ie,C as ue,J as me,K as _e,V as fe,i as pe,H as ce,L as be,M as ve,N as ye,O as xe,W as ke,X as ge,Y as Ve,R as Ce}from"./element-plus-ChK2e5qA.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_lang-CCtv5BMP.js";import{d as W,a0 as q,r as P,a1 as Te,c as R,o as i,U as t,a as n,L as l,u as a,a9 as O,R as o,S as r,M as Ee,K as p,P as v,i as N}from"./@vue-ygbFPFRc.js";import{r as T,f as w,d as Ue}from"./index-D465kfFn.js";import{u as De}from"./usePaging-B2jDzebD.js";import"./@element-plus-C4Lf8veM.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";function Se(f){return T.get({url:"/order.orderTransfer/lists",params:f})}function je(f){return T.get({url:"/order.orderTransfer/detail",params:f})}function $e(f){return T.post({url:"/order.orderTransfer/audit",params:f})}function Ke(f){return T.post({url:"/order.orderTransfer/complete",params:f})}function ze(f){return T.post({url:"/order.orderTransfer/cancel",params:f})}function Be(f){return T.post({url:"/order.orderTransfer/resendCode",params:f})}function Pe(f){return T.get({url:"/order.orderTransfer/statistics",params:f})}const Re={class:"order-transfer-lists"},Fe={class:"mt-4 grid grid-cols-6 gap-4"},Le={class:"text-center"},Ne={class:"text-2xl font-bold mt-2 text-orange-500"},Ye={class:"text-center"},Ae={class:"text-2xl font-bold mt-2 text-blue-500"},Ie={class:"text-center"},Me={class:"text-2xl font-bold mt-2 text-purple-500"},qe={class:"text-center"},Oe={class:"text-2xl font-bold mt-2 text-green-500"},He={class:"text-center"},Je={class:"text-2xl font-bold mt-2 text-red-500"},We={class:"text-center"},Xe={class:"text-2xl font-bold mt-2 text-gray-500"},Ge=["onClick"],Qe={class:"text-gray-400 text-xs"},Ze={class:"text-gray-400 text-xs"},he={key:0,class:"text-red-500 font-bold"},et={key:0,class:"text-orange-500"},tt={key:1,class:"text-gray-400"},lt={class:"flex justify-end mt-4"},st={key:0,class:"transfer-detail"},at={class:"text-red-500 font-bold"},ot={class:"text-red-500"},rt=W({name:"orderTransfer"}),nt=W({...rt,setup(f){const c=q({transfer_sn:"",order_sn:"",user_keyword:"",transfer_status:"",create_time:[]}),Y=P({}),F=P(!1),d=P(null),E=P(!1),u=q({id:0,approved:!0,remark:"",reject_reason:""}),U=P(!1),D=q({id:0,reason:""}),{pager:K,getLists:V,resetPage:L,resetParams:X}=De({fetchFun:Se,params:c}),z=async()=>{const m=await Pe({});Y.value=m},S=m=>{if(!Y.value.status_counts)return 0;const e=Y.value.status_counts.find(k=>k.status===m);return e?e.count:0},H=m=>({0:"warning",1:"primary",2:"info",3:"success",4:"danger",5:"info"})[m]||"info",G=m=>{console.log("View order:",m)},Q=async m=>{const e=await je({id:m.id});d.value=e,F.value=!0},J=(m,e)=>{u.id=m.id,u.approved=e,u.remark="",u.reject_reason="",E.value=!0},Z=async()=>{if(!u.approved&&!u.reject_reason){w.msgError("请填写拒绝原因");return}await $e({id:u.id,approved:u.approved?1:0,remark:u.remark,reject_reason:u.reject_reason}),w.msgSuccess("操作成功"),E.value=!1,V(),z()},h=async m=>{await w.confirm("确定要重新发送验证码吗？"),await Be({id:m.id}),w.msgSuccess("验证码已发送"),V()},ee=async m=>{await w.confirm("确定要手动完成此转让吗？"),await Ke({id:m.id}),w.msgSuccess("转让完成"),V(),z()},te=m=>{D.id=m.id,D.reason="",U.value=!0},le=async()=>{await ze(D),w.msgSuccess("已取消"),U.value=!1,V(),z()};return Te(()=>{V(),z()}),V(),z(),(m,e)=>{const k=ue,y=ie,C=_e,se=me,ae=fe,b=pe,A=de,g=ce,x=ve,j=ye,oe=be,re=we,_=ge,B=ke,I=Ve,M=Ce,ne=xe;return i(),R("div",Re,[t(g,{class:"!border-none",shadow:"never"},{default:l(()=>[t(A,{ref:"formRef",class:"mb-[-16px]",model:a(c),inline:!0},{default:l(()=>[t(y,{class:"w-[180px]",label:"转让单号"},{default:l(()=>[t(k,{modelValue:a(c).transfer_sn,"onUpdate:modelValue":e[0]||(e[0]=s=>a(c).transfer_sn=s),placeholder:"输入转让单号",clearable:"",onKeyup:O(a(L),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(y,{class:"w-[180px]",label:"订单编号"},{default:l(()=>[t(k,{modelValue:a(c).order_sn,"onUpdate:modelValue":e[1]||(e[1]=s=>a(c).order_sn=s),placeholder:"输入订单编号",clearable:"",onKeyup:O(a(L),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(y,{class:"w-[150px]",label:"用户关键词"},{default:l(()=>[t(k,{modelValue:a(c).user_keyword,"onUpdate:modelValue":e[2]||(e[2]=s=>a(c).user_keyword=s),placeholder:"姓名/手机号",clearable:"",onKeyup:O(a(L),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(y,{class:"w-[120px]",label:"转让状态"},{default:l(()=>[t(se,{modelValue:a(c).transfer_status,"onUpdate:modelValue":e[3]||(e[3]=s=>a(c).transfer_status=s),placeholder:"选择状态",clearable:""},{default:l(()=>[t(C,{label:"全部",value:""}),t(C,{label:"待审核",value:0}),t(C,{label:"待接收",value:1}),t(C,{label:"接收确认",value:2}),t(C,{label:"转让完成",value:3}),t(C,{label:"已拒绝",value:4}),t(C,{label:"已取消",value:5})]),_:1},8,["modelValue"])]),_:1}),t(y,{class:"w-[320px]",label:"申请时间"},{default:l(()=>[t(ae,{modelValue:a(c).create_time,"onUpdate:modelValue":e[4]||(e[4]=s=>a(c).create_time=s),type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),t(y,null,{default:l(()=>[t(b,{type:"primary",onClick:a(L)},{default:l(()=>e[14]||(e[14]=[o("查询")])),_:1},8,["onClick"]),t(b,{onClick:a(X)},{default:l(()=>e[15]||(e[15]=[o("重置")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),n("div",Fe,[t(g,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",Le,[e[16]||(e[16]=n("div",{class:"text-gray-500 text-sm"},"待审核",-1)),n("div",Ne,r(S(0)),1)])]),_:1}),t(g,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",Ye,[e[17]||(e[17]=n("div",{class:"text-gray-500 text-sm"},"待接收",-1)),n("div",Ae,r(S(1)),1)])]),_:1}),t(g,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",Ie,[e[18]||(e[18]=n("div",{class:"text-gray-500 text-sm"},"接收确认",-1)),n("div",Me,r(S(2)),1)])]),_:1}),t(g,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",qe,[e[19]||(e[19]=n("div",{class:"text-gray-500 text-sm"},"转让完成",-1)),n("div",Oe,r(S(3)),1)])]),_:1}),t(g,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",He,[e[20]||(e[20]=n("div",{class:"text-gray-500 text-sm"},"已拒绝",-1)),n("div",Je,r(S(4)),1)])]),_:1}),t(g,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",We,[e[21]||(e[21]=n("div",{class:"text-gray-500 text-sm"},"已取消",-1)),n("div",Xe,r(S(5)),1)])]),_:1})]),t(g,{class:"!border-none mt-4",shadow:"never"},{default:l(()=>[Ee((i(),p(oe,{size:"large",data:a(K).lists},{default:l(()=>[t(x,{label:"转让单号",prop:"transfer_sn","min-width":"160"}),t(x,{label:"订单编号","min-width":"160"},{default:l(({row:s})=>[n("span",{class:"text-primary cursor-pointer",onClick:$=>G(s.order_id)},r(s.order_sn),9,Ge)]),_:1}),t(x,{label:"转让方","min-width":"140"},{default:l(({row:s})=>[n("div",null,r(s.from_user_name),1),n("div",Qe,r(s.from_user_mobile),1)]),_:1}),t(x,{label:"接收方","min-width":"140"},{default:l(({row:s})=>[n("div",null,r(s.to_user_name),1),n("div",Ze,r(s.to_user_mobile),1),s.to_user_verified?(i(),p(j,{key:0,type:"success",size:"small",class:"mt-1"},{default:l(()=>e[22]||(e[22]=[o("已验证")])),_:1})):(i(),p(j,{key:1,type:"info",size:"small",class:"mt-1"},{default:l(()=>e[23]||(e[23]=[o("未验证")])),_:1}))]),_:1}),t(x,{label:"订单金额",width:"110"},{default:l(({row:s})=>[s.order?(i(),R("span",he,"¥"+r(s.order.pay_amount),1)):v("",!0)]),_:1}),t(x,{label:"状态",width:"100"},{default:l(({row:s})=>[t(j,{type:H(s.transfer_status),size:"small"},{default:l(()=>[o(r(s.transfer_status_desc),1)]),_:2},1032,["type"])]),_:1}),t(x,{label:"手续费",width:"90"},{default:l(({row:s})=>[s.transfer_fee>0?(i(),R("span",et,"¥"+r(s.transfer_fee),1)):(i(),R("span",tt,"-"))]),_:1}),t(x,{label:"申请时间",prop:"create_time",width:"160"}),t(x,{label:"操作",width:"200",fixed:"right"},{default:l(({row:s})=>[t(b,{type:"primary",link:"",onClick:$=>Q(s)},{default:l(()=>e[24]||(e[24]=[o("详情")])),_:2},1032,["onClick"]),s.transfer_status===0?(i(),p(b,{key:0,type:"success",link:"",onClick:$=>J(s,!0)},{default:l(()=>e[25]||(e[25]=[o("通过")])),_:2},1032,["onClick"])):v("",!0),s.transfer_status===0?(i(),p(b,{key:1,type:"danger",link:"",onClick:$=>J(s,!1)},{default:l(()=>e[26]||(e[26]=[o("拒绝")])),_:2},1032,["onClick"])):v("",!0),s.transfer_status===1?(i(),p(b,{key:2,type:"warning",link:"",onClick:$=>h(s)},{default:l(()=>e[27]||(e[27]=[o("重发验证码")])),_:2},1032,["onClick"])):v("",!0),s.transfer_status===1||s.transfer_status===2?(i(),p(b,{key:3,type:"success",link:"",onClick:$=>ee(s)},{default:l(()=>e[28]||(e[28]=[o("完成转让")])),_:2},1032,["onClick"])):v("",!0),s.transfer_status<=2?(i(),p(b,{key:4,type:"danger",link:"",onClick:$=>te(s)},{default:l(()=>e[29]||(e[29]=[o("取消")])),_:2},1032,["onClick"])):v("",!0)]),_:1})]),_:1},8,["data"])),[[ne,a(K).loading]]),n("div",lt,[t(re,{modelValue:a(K),"onUpdate:modelValue":e[5]||(e[5]=s=>N(K)?K.value=s:null),onChange:a(V)},null,8,["modelValue","onChange"])])]),_:1}),t(M,{modelValue:a(F),"onUpdate:modelValue":e[6]||(e[6]=s=>N(F)?F.value=s:null),title:"转让详情",width:"700px"},{default:l(()=>[a(d)?(i(),R("div",st,[t(B,{column:2,border:""},{default:l(()=>[t(_,{label:"转让单号"},{default:l(()=>[o(r(a(d).transfer_sn),1)]),_:1}),t(_,{label:"转让状态"},{default:l(()=>[t(j,{type:H(a(d).transfer_status),size:"small"},{default:l(()=>[o(r(a(d).transfer_status_desc),1)]),_:1},8,["type"])]),_:1}),t(_,{label:"订单编号"},{default:l(()=>[o(r(a(d).order_sn),1)]),_:1}),a(d).order?(i(),p(_,{key:0,label:"订单金额"},{default:l(()=>[n("span",at,"¥"+r(a(d).order.pay_amount),1)]),_:1})):v("",!0)]),_:1}),t(I,{"content-position":"left"},{default:l(()=>e[30]||(e[30]=[o("转让方信息")])),_:1}),t(B,{column:2,border:""},{default:l(()=>[t(_,{label:"姓名"},{default:l(()=>[o(r(a(d).from_user_name),1)]),_:1}),t(_,{label:"手机号"},{default:l(()=>[o(r(a(d).from_user_mobile),1)]),_:1})]),_:1}),t(I,{"content-position":"left"},{default:l(()=>e[31]||(e[31]=[o("接收方信息")])),_:1}),t(B,{column:2,border:""},{default:l(()=>[t(_,{label:"姓名"},{default:l(()=>[o(r(a(d).to_user_name),1)]),_:1}),t(_,{label:"手机号"},{default:l(()=>[o(r(a(d).to_user_mobile),1)]),_:1}),t(_,{label:"验证状态"},{default:l(()=>[a(d).to_user_verified?(i(),p(j,{key:0,type:"success",size:"small"},{default:l(()=>e[32]||(e[32]=[o("已验证")])),_:1})):(i(),p(j,{key:1,type:"info",size:"small"},{default:l(()=>e[33]||(e[33]=[o("未验证")])),_:1}))]),_:1}),t(_,{label:"验证码发送次数"},{default:l(()=>[o(r(a(d).accept_code_send_count||0)+" 次 ",1)]),_:1})]),_:1}),t(I,{"content-position":"left"},{default:l(()=>e[34]||(e[34]=[o("时间信息")])),_:1}),t(B,{column:2,border:""},{default:l(()=>[t(_,{label:"申请时间"},{default:l(()=>[o(r(a(d).create_time),1)]),_:1}),t(_,{label:"审核时间"},{default:l(()=>[o(r(a(d).audit_time||"-"),1)]),_:1}),t(_,{label:"接收时间"},{default:l(()=>[o(r(a(d).accept_time||"-"),1)]),_:1}),t(_,{label:"完成时间"},{default:l(()=>[o(r(a(d).complete_time||"-"),1)]),_:1})]),_:1}),t(B,{column:1,border:"",class:"mt-4"},{default:l(()=>[t(_,{label:"转让原因"},{default:l(()=>[o(r(a(d).transfer_reason||"-"),1)]),_:1}),a(d).audit_remark?(i(),p(_,{key:0,label:"审核备注"},{default:l(()=>[o(r(a(d).audit_remark),1)]),_:1})):v("",!0),a(d).reject_reason?(i(),p(_,{key:1,label:"拒绝原因"},{default:l(()=>[n("span",ot,r(a(d).reject_reason),1)]),_:1})):v("",!0)]),_:1})])):v("",!0)]),_:1},8,["modelValue"]),t(M,{modelValue:a(E),"onUpdate:modelValue":e[10]||(e[10]=s=>N(E)?E.value=s:null),title:a(u).approved?"审核通过":"审核拒绝",width:"500px"},{footer:l(()=>[t(b,{onClick:e[9]||(e[9]=s=>E.value=!1)},{default:l(()=>e[35]||(e[35]=[o("取消")])),_:1}),t(b,{type:a(u).approved?"success":"danger",onClick:Z},{default:l(()=>e[36]||(e[36]=[o("确认")])),_:1},8,["type"])]),default:l(()=>[t(A,{model:a(u),"label-width":"100px"},{default:l(()=>[t(y,{label:"审核备注"},{default:l(()=>[t(k,{modelValue:a(u).remark,"onUpdate:modelValue":e[7]||(e[7]=s=>a(u).remark=s),type:"textarea",rows:3,placeholder:"请输入审核备注（选填）"},null,8,["modelValue"])]),_:1}),a(u).approved?v("",!0):(i(),p(y,{key:0,label:"拒绝原因",required:""},{default:l(()=>[t(k,{modelValue:a(u).reject_reason,"onUpdate:modelValue":e[8]||(e[8]=s=>a(u).reject_reason=s),type:"textarea",rows:3,placeholder:"请输入拒绝原因"},null,8,["modelValue"])]),_:1}))]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(M,{modelValue:a(U),"onUpdate:modelValue":e[13]||(e[13]=s=>N(U)?U.value=s:null),title:"取消转让",width:"500px"},{footer:l(()=>[t(b,{onClick:e[12]||(e[12]=s=>U.value=!1)},{default:l(()=>e[37]||(e[37]=[o("取消")])),_:1}),t(b,{type:"danger",onClick:le},{default:l(()=>e[38]||(e[38]=[o("确认取消")])),_:1})]),default:l(()=>[t(A,{model:a(D),"label-width":"100px"},{default:l(()=>[t(y,{label:"取消原因"},{default:l(()=>[t(k,{modelValue:a(D).reason,"onUpdate:modelValue":e[11]||(e[11]=s=>a(D).reason=s),type:"textarea",rows:3,placeholder:"请输入取消原因（选填）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),At=Ue(nt,[["__scopeId","data-v-fc8511a4"]]);export{At as default};

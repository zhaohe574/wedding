import{D as _e,B as ce,J as fe,K as ve,C as ye,i as be,H as ge,L as ke,M as xe,q as Ve,N as he,v as we,p as Ce,n as Ee,o as Se,O as De,W as Ue,X as $e,R as Te}from"./element-plus-ChK2e5qA.js";import{_ as Le}from"./index.vue_vue_type_script_setup_true_lang-CCtv5BMP.js";import{b as Pe,f as U}from"./index-D465kfFn.js";import{d as W,s as Re,a0 as N,r as L,a1 as ze,c as v,o as m,U as e,a as i,L as s,u as a,a9 as Ae,R as o,S as n,M as Be,K as V,P as f,i as A,T as Fe,ab as Ie}from"./@vue-ygbFPFRc.js";import{n as Ke,o as Ne,m as Oe,p as qe,q as He,r as Me,s as je,t as Je}from"./dynamic-CEF9d1CA.js";import{u as We}from"./usePaging-B2jDzebD.js";import Xe from"./edit-BDlKJPS3.js";import"./@element-plus-C4Lf8veM.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";import"./picker-COC_GcuI.js";import"./index-n-Jqn6Y-.js";import"./index-dAc1fhtT.js";import"./index-DlQH-CEM.js";import"./index-DFyja3d3.js";import"./index.vue_vue_type_script_setup_true_lang-T0yi5BSL.js";import"./vuedraggable-RHgmLr3o.js";import"./vue-CQyKTslw.js";import"./sortablejs-BvvSZPRv.js";const Ge={class:"dynamic-lists"},Qe={class:"mt-4 grid grid-cols-4 gap-4"},Ye={class:"text-center"},Ze={class:"text-2xl font-bold mt-2 text-orange-500"},et={class:"text-center"},tt={class:"text-2xl font-bold mt-2 text-green-500"},lt={class:"text-center"},st={class:"text-2xl font-bold mt-2 text-gray-500"},at={class:"text-center"},ot={class:"text-2xl font-bold mt-2 text-red-500"},nt={key:0,class:"flex items-center"},it={class:"ml-2"},dt={class:"text-gray-400 text-xs"},ut={key:1},rt={key:0,class:"font-bold"},mt={class:"text-gray-500"},pt={key:0,class:"flex gap-1"},_t={key:0,class:"text-gray-400"},ct={key:1},ft={class:"text-xs"},vt={class:"mr-2"},yt={class:"mr-2"},bt={class:"text-xs"},gt={class:"mr-2"},kt={key:2},xt={class:"flex justify-end mt-4"},Vt={key:0},ht={key:0,class:"mt-4"},wt={class:"flex flex-wrap gap-2"},Ct={key:1,class:"mt-4"},Et=["src"],St={class:"mt-4"},Dt=W({name:"dynamicLists"}),kl=W({...Dt,setup(Ut){const P=Re(),p=N({dynamic_type:"",status:"",user_type:"",is_top:"",is_hot:"",content:""}),B=L({}),R=L(!1),r=L(null),h=L(!1),b=N({id:0,approved:!0,remark:""}),w=L(!1),C=N({id:0,reason:""}),{pager:$,getLists:k,resetPage:O,resetParams:X}=We({fetchFun:Ke,params:p}),E=async()=>{const d=await Ne();B.value=d},z=d=>{if(!B.value.status_counts)return 0;const t=B.value.status_counts.find(u=>u.status===d);return t?t.count:0},q=d=>({0:"warning",1:"success",2:"info",3:"danger"})[d]||"info",G=async d=>{const t=await Oe({id:d.id});r.value=t,R.value=!0},H=(d,t)=>{b.id=d.id,b.approved=t,b.remark="",h.value=!0},Q=async()=>{await qe(b),U.msgSuccess("审核成功"),h.value=!1,k(),E()},Y=d=>{C.id=d.id,C.reason="",w.value=!0},Z=async()=>{await He(C),U.msgSuccess("下架成功"),w.value=!1,k(),E()},ee=async d=>{await Me({id:d.id,is_top:d.is_top?0:1}),U.msgSuccess("设置成功"),k()},te=async d=>{await je({id:d.id,is_hot:d.is_hot?0:1}),U.msgSuccess("设置成功"),k()},le=async d=>{await U.confirm("确定要删除该动态吗？"),await Je({id:d.id}),U.msgSuccess("删除成功"),k(),E()},se=()=>{var d;(d=P.value)==null||d.open("add")},ae=async d=>{var t,u;(t=P.value)==null||t.open("edit"),await((u=P.value)==null?void 0:u.getDetail(d))},oe=()=>{k(),E()};return ze(()=>{k(),E()}),k(),E(),(d,t)=>{const u=ve,T=fe,x=ce,F=ye,_=be,ne=Pe,I=_e,S=ge,y=xe,ie=Ve,D=he,M=we,j=Se,de=Ee,ue=Ce,re=ke,me=Le,c=$e,J=Ue,K=Te,pe=De;return m(),v("div",Ge,[e(S,{class:"!border-none",shadow:"never"},{default:s(()=>[e(I,{ref:"formRef",class:"mb-[-16px]",model:a(p),inline:!0},{default:s(()=>[e(x,{class:"w-[150px]",label:"动态类型"},{default:s(()=>[e(T,{modelValue:a(p).dynamic_type,"onUpdate:modelValue":t[0]||(t[0]=l=>a(p).dynamic_type=l),placeholder:"选择类型",clearable:""},{default:s(()=>[e(u,{label:"全部",value:""}),e(u,{label:"图文",value:1}),e(u,{label:"视频",value:2}),e(u,{label:"案例",value:3}),e(u,{label:"活动",value:4})]),_:1},8,["modelValue"])]),_:1}),e(x,{class:"w-[150px]",label:"状态"},{default:s(()=>[e(T,{modelValue:a(p).status,"onUpdate:modelValue":t[1]||(t[1]=l=>a(p).status=l),placeholder:"选择状态",clearable:""},{default:s(()=>[e(u,{label:"全部",value:""}),e(u,{label:"待审核",value:0}),e(u,{label:"已发布",value:1}),e(u,{label:"已下架",value:2}),e(u,{label:"已拒绝",value:3})]),_:1},8,["modelValue"])]),_:1}),e(x,{class:"w-[150px]",label:"发布者类型"},{default:s(()=>[e(T,{modelValue:a(p).user_type,"onUpdate:modelValue":t[2]||(t[2]=l=>a(p).user_type=l),placeholder:"选择类型",clearable:""},{default:s(()=>[e(u,{label:"全部",value:""}),e(u,{label:"用户",value:1}),e(u,{label:"工作人员",value:2}),e(u,{label:"官方",value:3})]),_:1},8,["modelValue"])]),_:1}),e(x,{class:"w-[150px]",label:"置顶"},{default:s(()=>[e(T,{modelValue:a(p).is_top,"onUpdate:modelValue":t[3]||(t[3]=l=>a(p).is_top=l),placeholder:"选择",clearable:""},{default:s(()=>[e(u,{label:"全部",value:""}),e(u,{label:"是",value:1}),e(u,{label:"否",value:0})]),_:1},8,["modelValue"])]),_:1}),e(x,{class:"w-[150px]",label:"热门"},{default:s(()=>[e(T,{modelValue:a(p).is_hot,"onUpdate:modelValue":t[4]||(t[4]=l=>a(p).is_hot=l),placeholder:"选择",clearable:""},{default:s(()=>[e(u,{label:"全部",value:""}),e(u,{label:"是",value:1}),e(u,{label:"否",value:0})]),_:1},8,["modelValue"])]),_:1}),e(x,{class:"w-[200px]",label:"内容"},{default:s(()=>[e(F,{modelValue:a(p).content,"onUpdate:modelValue":t[5]||(t[5]=l=>a(p).content=l),placeholder:"搜索内容",clearable:"",onKeyup:Ae(a(O),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(x,null,{default:s(()=>[e(_,{type:"primary",onClick:a(O)},{default:s(()=>t[14]||(t[14]=[o("查询")])),_:1},8,["onClick"]),e(_,{onClick:a(X)},{default:s(()=>t[15]||(t[15]=[o("重置")])),_:1},8,["onClick"]),e(_,{type:"primary",onClick:se},{icon:s(()=>[e(ne,{name:"el-icon-Plus"})]),default:s(()=>[t[16]||(t[16]=o(" 发布动态 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),i("div",Qe,[e(S,{class:"!border-none",shadow:"never"},{default:s(()=>[i("div",Ye,[t[17]||(t[17]=i("div",{class:"text-gray-500 text-sm"},"待审核",-1)),i("div",Ze,n(z(0)),1)])]),_:1}),e(S,{class:"!border-none",shadow:"never"},{default:s(()=>[i("div",et,[t[18]||(t[18]=i("div",{class:"text-gray-500 text-sm"},"已发布",-1)),i("div",tt,n(z(1)),1)])]),_:1}),e(S,{class:"!border-none",shadow:"never"},{default:s(()=>[i("div",lt,[t[19]||(t[19]=i("div",{class:"text-gray-500 text-sm"},"已下架",-1)),i("div",st,n(z(2)),1)])]),_:1}),e(S,{class:"!border-none",shadow:"never"},{default:s(()=>[i("div",at,[t[20]||(t[20]=i("div",{class:"text-gray-500 text-sm"},"已拒绝",-1)),i("div",ot,n(z(3)),1)])]),_:1})]),e(S,{class:"!border-none mt-4",shadow:"never"},{default:s(()=>[Be((m(),V(re,{size:"large",data:a($).lists},{default:s(()=>[e(y,{label:"ID",prop:"id",width:"80"}),e(y,{label:"发布者","min-width":"150"},{default:s(({row:l})=>[l.publisher?(m(),v("div",nt,[e(ie,{src:l.publisher.avatar,size:32},null,8,["src"]),i("div",it,[i("div",null,n(l.publisher.nickname),1),i("div",dt,n(l.user_type_desc),1)])])):(m(),v("span",ut,"-"))]),_:1}),e(y,{label:"类型",width:"80"},{default:s(({row:l})=>[e(D,{size:"small"},{default:s(()=>[o(n(l.type_desc),1)]),_:2},1024)]),_:1}),e(y,{label:"内容","min-width":"200","show-overflow-tooltip":""},{default:s(({row:l})=>[l.title?(m(),v("div",rt,n(l.title),1)):f("",!0),i("div",mt,n(l.content),1)]),_:1}),e(y,{label:"图片",width:"100"},{default:s(({row:l})=>[l.images&&l.images.length>0?(m(),v("div",pt,[e(M,{src:l.images[0],style:{width:"40px",height:"40px"},fit:"cover","preview-src-list":l.images},null,8,["src","preview-src-list"]),l.images.length>1?(m(),v("span",_t," +"+n(l.images.length-1),1)):f("",!0)])):(m(),v("span",ct,"-"))]),_:1}),e(y,{label:"互动数据",width:"150"},{default:s(({row:l})=>[i("div",ft,[i("span",vt,"浏览: "+n(l.view_count),1),i("span",yt,"点赞: "+n(l.like_count),1)]),i("div",bt,[i("span",gt,"评论: "+n(l.comment_count),1),i("span",null,"收藏: "+n(l.collect_count),1)])]),_:1}),e(y,{label:"状态",width:"100"},{default:s(({row:l})=>[e(D,{type:q(l.status)},{default:s(()=>[o(n(l.status_desc),1)]),_:2},1032,["type"])]),_:1}),e(y,{label:"评论状态",width:"100"},{default:s(({row:l})=>[e(D,{type:l.allow_comment===1?"success":"danger",size:"small"},{default:s(()=>[o(n(l.allow_comment===1?"允许评论":"禁止评论"),1)]),_:2},1032,["type"])]),_:1}),e(y,{label:"置顶/热门",width:"100"},{default:s(({row:l})=>[l.is_top?(m(),V(D,{key:0,type:"warning",size:"small"},{default:s(()=>t[21]||(t[21]=[o("置顶")])),_:1})):f("",!0),l.is_hot?(m(),V(D,{key:1,type:"danger",size:"small",class:"ml-1"},{default:s(()=>t[22]||(t[22]=[o("热门")])),_:1})):f("",!0),!l.is_top&&!l.is_hot?(m(),v("span",kt,"-")):f("",!0)]),_:1}),e(y,{label:"发布时间",prop:"create_time",width:"170"}),e(y,{label:"操作",width:"220",fixed:"right"},{default:s(({row:l})=>[l.user_type===3?(m(),V(_,{key:0,type:"primary",link:"",onClick:g=>ae(l)},{default:s(()=>t[23]||(t[23]=[o("编辑")])),_:2},1032,["onClick"])):f("",!0),e(_,{type:"primary",link:"",onClick:g=>G(l)},{default:s(()=>t[24]||(t[24]=[o("详情")])),_:2},1032,["onClick"]),l.status===0?(m(),V(_,{key:1,type:"success",link:"",onClick:g=>H(l,!0)},{default:s(()=>t[25]||(t[25]=[o("通过")])),_:2},1032,["onClick"])):f("",!0),l.status===0?(m(),V(_,{key:2,type:"danger",link:"",onClick:g=>H(l,!1)},{default:s(()=>t[26]||(t[26]=[o("拒绝")])),_:2},1032,["onClick"])):f("",!0),l.status===1?(m(),V(_,{key:3,type:"warning",link:"",onClick:g=>Y(l)},{default:s(()=>t[27]||(t[27]=[o("下架")])),_:2},1032,["onClick"])):f("",!0),l.status===1?(m(),V(ue,{key:4,trigger:"click",class:"ml-2"},{dropdown:s(()=>[e(de,null,{default:s(()=>[e(j,{onClick:g=>ee(l)},{default:s(()=>[o(n(l.is_top?"取消置顶":"设为置顶"),1)]),_:2},1032,["onClick"]),e(j,{onClick:g=>te(l)},{default:s(()=>[o(n(l.is_hot?"取消热门":"设为热门"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:s(()=>[e(_,{type:"primary",link:""},{default:s(()=>t[28]||(t[28]=[o("更多")])),_:1})]),_:2},1024)):f("",!0),e(_,{type:"danger",link:"",onClick:g=>le(l)},{default:s(()=>t[29]||(t[29]=[o("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[pe,a($).loading]]),i("div",xt,[e(me,{modelValue:a($),"onUpdate:modelValue":t[6]||(t[6]=l=>A($)?$.value=l:null),onChange:a(k)},null,8,["modelValue","onChange"])])]),_:1}),e(Xe,{ref_key:"editRef",ref:P,onSuccess:oe},null,512),e(K,{modelValue:a(R),"onUpdate:modelValue":t[7]||(t[7]=l=>A(R)?R.value=l:null),title:"动态详情",width:"700px"},{default:s(()=>[a(r)?(m(),v("div",Vt,[e(J,{column:2,border:""},{default:s(()=>[e(c,{label:"发布者"},{default:s(()=>{var l;return[o(n(((l=a(r).publisher)==null?void 0:l.nickname)||"-"),1)]}),_:1}),e(c,{label:"发布者类型"},{default:s(()=>[o(n(a(r).user_type_desc),1)]),_:1}),e(c,{label:"动态类型"},{default:s(()=>[o(n(a(r).type_desc),1)]),_:1}),e(c,{label:"状态"},{default:s(()=>[e(D,{type:q(a(r).status)},{default:s(()=>[o(n(a(r).status_desc),1)]),_:1},8,["type"])]),_:1}),e(c,{label:"标题",span:2},{default:s(()=>[o(n(a(r).title||"-"),1)]),_:1}),e(c,{label:"内容",span:2},{default:s(()=>[o(n(a(r).content),1)]),_:1}),e(c,{label:"位置",span:2},{default:s(()=>[o(n(a(r).location||"-"),1)]),_:1}),e(c,{label:"标签",span:2},{default:s(()=>[o(n(a(r).tags||"-"),1)]),_:1})]),_:1}),a(r).images&&a(r).images.length>0?(m(),v("div",ht,[t[30]||(t[30]=i("h4",{class:"font-bold mb-2"},"图片",-1)),i("div",wt,[(m(!0),v(Fe,null,Ie(a(r).images,(l,g)=>(m(),V(M,{key:g,src:l,style:{width:"100px",height:"100px"},fit:"cover","preview-src-list":a(r).images,"initial-index":g},null,8,["src","preview-src-list","initial-index"]))),128))])])):f("",!0),a(r).video_url?(m(),v("div",Ct,[t[31]||(t[31]=i("h4",{class:"font-bold mb-2"},"视频",-1)),i("video",{src:a(r).video_url,controls:"",style:{"max-width":"400px"}},null,8,Et)])):f("",!0),i("div",St,[t[32]||(t[32]=i("h4",{class:"font-bold mb-2"},"互动数据",-1)),e(J,{column:5},{default:s(()=>[e(c,{label:"浏览"},{default:s(()=>[o(n(a(r).view_count),1)]),_:1}),e(c,{label:"点赞"},{default:s(()=>[o(n(a(r).like_count),1)]),_:1}),e(c,{label:"评论"},{default:s(()=>[o(n(a(r).comment_count),1)]),_:1}),e(c,{label:"收藏"},{default:s(()=>[o(n(a(r).collect_count),1)]),_:1}),e(c,{label:"分享"},{default:s(()=>[o(n(a(r).share_count),1)]),_:1})]),_:1})])])):f("",!0)]),_:1},8,["modelValue"]),e(K,{modelValue:a(h),"onUpdate:modelValue":t[10]||(t[10]=l=>A(h)?h.value=l:null),title:a(b).approved?"审核通过":"审核拒绝",width:"500px"},{footer:s(()=>[e(_,{onClick:t[9]||(t[9]=l=>h.value=!1)},{default:s(()=>t[33]||(t[33]=[o("取消")])),_:1}),e(_,{type:a(b).approved?"success":"danger",onClick:Q},{default:s(()=>[o(n(a(b).approved?"确认通过":"确认拒绝"),1)]),_:1},8,["type"])]),default:s(()=>[e(I,{model:a(b),"label-width":"100px"},{default:s(()=>[e(x,{label:"审核备注"},{default:s(()=>[e(F,{modelValue:a(b).remark,"onUpdate:modelValue":t[8]||(t[8]=l=>a(b).remark=l),type:"textarea",rows:3,placeholder:"请输入审核备注（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(K,{modelValue:a(w),"onUpdate:modelValue":t[13]||(t[13]=l=>A(w)?w.value=l:null),title:"下架动态",width:"500px"},{footer:s(()=>[e(_,{onClick:t[12]||(t[12]=l=>w.value=!1)},{default:s(()=>t[34]||(t[34]=[o("取消")])),_:1}),e(_,{type:"warning",onClick:Z},{default:s(()=>t[35]||(t[35]=[o("确认下架")])),_:1})]),default:s(()=>[e(I,{model:a(C),"label-width":"100px"},{default:s(()=>[e(x,{label:"下架原因"},{default:s(()=>[e(F,{modelValue:a(C).reason,"onUpdate:modelValue":t[11]||(t[11]=l=>a(C).reason=l),type:"textarea",rows:3,placeholder:"请输入下架原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});export{kl as default};

import{G as Ul,H as zl,d as xl,I as Dl,m as Ll,l as El,D as Tl,B as Sl,C as hl,J as $l,K as Rl,i as Pl,L as Fl,M as jl,N as Il,O as Ml,P as Bl,Q as Hl,R as Nl,S as Al,h as Ol,T as ql,U as Yl,V as Kl,g as Gl,W as Jl,X as Ql,Y as Wl,Z as Xl,_ as Zl,e as et,E as w,a as Ue}from"./element-plus-ChK2e5qA.js";import{K as lt,L as tt,M as at,N as ot,A as st}from"./@element-plus-C4Lf8veM.js";import{r as y,d as nt}from"./index-D465kfFn.js";import{d as it,r as b,a0 as C,l as ut,c as q,o as f,U as l,L as a,a as r,u as de,S as g,R as s,M as _e,K as v,P as V,T as W,ab as ge}from"./@vue-ygbFPFRc.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";function rt(){return y.get({url:"/aftersale.aftersale/statistics"})}function dt(d){return y.get({url:"/aftersale.aftersale/ticketLists",params:d})}function pt(d){return y.get({url:"/aftersale.aftersale/ticketDetail",params:{id:d}})}function mt(d){return y.post({url:"/aftersale.aftersale/assignTicket",data:d})}function ft(d){return y.post({url:"/aftersale.aftersale/handleTicket",data:d})}function ct(d){return y.post({url:"/aftersale.aftersale/closeTicket",data:d})}function bt(d){return y.get({url:"/aftersale.aftersale/complaintLists",params:d})}function vt(d){return y.get({url:"/aftersale.aftersale/complaintDetail",params:{id:d}})}function _t(d){return y.post({url:"/aftersale.aftersale/handleComplaint",data:d})}function gt(d){return y.get({url:"/aftersale.aftersale/reshootLists",params:d})}function yt(d){return y.get({url:"/aftersale.aftersale/reshootDetail",params:{id:d}})}function kt(d){return y.post({url:"/aftersale.aftersale/auditReshoot",data:d})}function Vt(d){return y.post({url:"/aftersale.aftersale/scheduleReshoot",data:d})}function wt(d){return y.post({url:"/aftersale.aftersale/completeReshoot",data:d})}function Ct(d){return y.get({url:"/aftersale.aftersale/callbackLists",params:d})}function Ut(d){return y.get({url:"/aftersale.aftersale/callbackDetail",params:{id:d}})}function zt(d){return y.post({url:"/aftersale.aftersale/completeCallback",data:d})}function xt(d){return y.post({url:"/aftersale.aftersale/markUnreachable",data:d})}function Dt(d){return y.post({url:"/aftersale.aftersale/escalateProblem",data:d})}const Lt={class:"aftersale-container"},Et={class:"stat-content"},Tt={class:"stat-icon ticket-icon"},St={class:"stat-info"},ht={class:"stat-value"},$t={class:"stat-footer"},Rt={class:"text-warning"},Pt={class:"stat-content"},Ft={class:"stat-icon complaint-icon"},jt={class:"stat-info"},It={class:"stat-value"},Mt={class:"stat-footer"},Bt={class:"text-danger"},Ht={class:"stat-content"},Nt={class:"stat-icon reshoot-icon"},At={class:"stat-info"},Ot={class:"stat-value"},qt={class:"stat-footer"},Yt={class:"text-warning"},Kt={class:"stat-content"},Gt={class:"stat-icon callback-icon"},Jt={class:"stat-info"},Qt={class:"stat-value"},Wt={class:"stat-footer"},Xt={class:"text-primary"},Zt={class:"search-bar mb-4"},ea={class:"pagination-container"},la={class:"search-bar mb-4"},ta={class:"pagination-container"},aa={class:"search-bar mb-4"},oa={class:"pagination-container"},sa={class:"search-bar mb-4"},na={key:1,class:"text-muted"},ia={class:"pagination-container"},ua=it({__name:"index",setup(d){const F=b({}),ze=b("ticket"),xe=b([]),ye=b(!1),E=C({ticket_sn:"",type:"",priority:"",status:""}),j=C({page:1,limit:10,total:0}),De=b([]),ke=b(!1),T=C({complaint_sn:"",type:"",level:"",status:""}),I=C({page:1,limit:10,total:0}),Le=b([]),Ve=b(!1),M=C({reshoot_sn:"",type:"",status:""}),B=C({page:1,limit:10,total:0}),Ee=b([]),we=b(!1),S=C({callback_sn:"",type:"",status:"",has_problem:""}),H=C({page:1,limit:10,total:0}),_=b(!1),he=b([]),$e=b([]),ee=b(!1),G=C({id:0,admin_id:""}),le=b(!1),x=C({id:0,result:"",imageList:[]}),te=b(!1),J=C({id:0,reason:""}),ae=b(!1),U=C({id:0,action:0,amount:0,result:""}),oe=b(!1),k=C({id:0,approved:1,is_free:1,fee:0,remark:""}),se=b(!1),R=C({id:0,schedule_date:"",new_staff_id:""}),ne=b(!1),m=C({id:0,score:5,score_service:5,score_professional:5,score_punctual:5,duration:0,content:"",summary:"",has_problem:0,problem_type:"",problem_desc:""}),X=b(!1),ie=b(""),N=b(null),ue=b({}),A=async()=>{try{const o=await rt();F.value=o}catch(o){console.error(o)}},O=async()=>{ye.value=!0;try{const o=await dt({...E,page:j.page,limit:j.limit});xe.value=o.lists||[],j.total=o.count||0}catch(o){console.error(o)}finally{ye.value=!1}},Z=async()=>{ke.value=!0;try{const o=await bt({...T,page:I.page,limit:I.limit});De.value=o.lists||[],I.total=o.count||0}catch(o){console.error(o)}finally{ke.value=!1}},Y=async()=>{Ve.value=!0;try{const o=await gt({...M,page:B.page,limit:B.limit});Le.value=o.lists||[],B.total=o.count||0}catch(o){console.error(o)}finally{Ve.value=!1}},K=async()=>{we.value=!0;try{const o=await Ct({...S,page:H.page,limit:H.limit});Ee.value=o.lists||[],H.total=o.count||0}catch(o){console.error(o)}finally{we.value=!1}},Re=()=>{Object.assign(E,{ticket_sn:"",type:"",priority:"",status:""}),j.page=1,O()},Pe=()=>{Object.assign(T,{complaint_sn:"",type:"",level:"",status:""}),I.page=1,Z()},Fe=()=>{Object.assign(M,{reshoot_sn:"",type:"",status:""}),B.page=1,Y()},je=()=>{Object.assign(S,{callback_sn:"",type:"",status:"",has_problem:""}),H.page=1,K()},Ie=o=>{o==="ticket"?O():o==="complaint"?Z():o==="reshoot"?Y():o==="callback"&&K()},Me=o=>({1:"info",2:"",3:"warning",4:"danger"})[o]||"",Be=o=>({0:"info",1:"warning",2:"primary",3:"success",4:"",5:"info"})[o]||"",He=o=>({1:"info",2:"warning",3:"danger"})[o]||"",Ne=o=>({0:"info",1:"warning",2:"success",3:"primary",4:""})[o]||"",Ae=o=>({0:"info",1:"success",2:"danger",3:"warning",4:"success",5:""})[o]||"",Oe=o=>({0:"info",1:"success",2:"warning",3:""})[o]||"",qe=async o=>{const e=await pt(o.id);N.value=e,ie.value="工单详情",ue.value={ticket_sn:{label:"工单编号"},title:{label:"标题"},type_desc:{label:"类型"},priority_desc:{label:"优先级"},status_desc:{label:"状态"},content:{label:"内容",span:2},handle_result:{label:"处理结果",span:2},create_time:{label:"创建时间",type:"time"}},X.value=!0},Ye=async o=>{const e=await vt(o.id);N.value=e,ie.value="投诉详情",ue.value={complaint_sn:{label:"投诉编号"},title:{label:"标题"},type_desc:{label:"类型"},level_desc:{label:"等级"},status_desc:{label:"状态"},content:{label:"内容",span:2},expect_result:{label:"期望结果",span:2},handle_result:{label:"处理结果",span:2},create_time:{label:"创建时间",type:"time"}},X.value=!0},Ke=async o=>{const e=await yt(o.id);N.value=e,ie.value="补拍申请详情",ue.value={reshoot_sn:{label:"申请编号"},type_desc:{label:"申请类型"},reason_type_desc:{label:"原因类型"},status_desc:{label:"状态"},reason:{label:"详细原因",span:2},expect_date:{label:"期望日期"},schedule_date:{label:"安排日期"},create_time:{label:"创建时间",type:"time"}},X.value=!0},Ge=async o=>{const e=await Ut(o.id);N.value=e,ie.value="回访详情",ue.value={callback_sn:{label:"回访编号"},type_desc:{label:"类型"},method_desc:{label:"方式"},status_desc:{label:"状态"},score:{label:"满意度"},content:{label:"回访内容",span:2},summary:{label:"回访摘要",span:2},plan_time:{label:"计划时间",type:"time"},actual_time:{label:"实际时间",type:"time"}},X.value=!0},Je=o=>{G.id=o.id,G.admin_id="",ee.value=!0},Qe=o=>{x.id=o.id,x.result="",x.imageList=[],le.value=!0},We=o=>{J.id=o.id,J.reason="",te.value=!0},Xe=o=>{U.id=o.id,U.action=0,U.amount=0,U.result="",ae.value=!0},Ze=o=>{k.id=o.id,k.approved=1,k.is_free=1,k.fee=0,k.remark="",oe.value=!0},el=o=>{R.id=o.id,R.schedule_date="",R.new_staff_id="",se.value=!0},ll=o=>{m.id=o.id,m.score=5,m.score_service=5,m.score_professional=5,m.score_punctual=5,m.duration=0,m.content="",m.summary="",m.has_problem=0,m.problem_type="",m.problem_desc="",ne.value=!0},tl=async()=>{if(!G.admin_id){w.warning("请选择处理人");return}_.value=!0;try{await mt(G),w.success("分配成功"),ee.value=!1,O(),A()}catch(o){console.error(o)}finally{_.value=!1}},al=async()=>{if(!x.result){w.warning("请输入处理结果");return}_.value=!0;try{await ft({id:x.id,result:x.result,images:x.imageList.map(o=>{var e,P;return((P=(e=o.response)==null?void 0:e.data)==null?void 0:P.url)||o.url})}),w.success("处理成功"),le.value=!1,O(),A()}catch(o){console.error(o)}finally{_.value=!1}},ol=async()=>{if(!J.reason){w.warning("请输入关闭原因");return}_.value=!0;try{await ct(J),w.success("关闭成功"),te.value=!1,O(),A()}catch(o){console.error(o)}finally{_.value=!1}},sl=async()=>{if(!U.result){w.warning("请输入处理结果");return}_.value=!0;try{await _t(U),w.success("处理成功"),ae.value=!1,Z(),A()}catch(o){console.error(o)}finally{_.value=!1}},nl=async()=>{_.value=!0;try{await kt(k),w.success("审核成功"),oe.value=!1,Y(),A()}catch(o){console.error(o)}finally{_.value=!1}},il=async()=>{if(!R.schedule_date){w.warning("请选择拍摄日期");return}_.value=!0;try{await Vt(R),w.success("安排成功"),se.value=!1,Y()}catch(o){console.error(o)}finally{_.value=!1}},ul=async o=>{await Ue.confirm("确认补拍已完成？","提示",{type:"warning"});try{await wt({id:o.id,remark:""}),w.success("操作成功"),Y(),A()}catch(e){console.error(e)}},rl=async()=>{_.value=!0;try{await zt(m),w.success("回访完成"),ne.value=!1,K(),A()}catch(o){console.error(o)}finally{_.value=!1}},dl=async o=>{await Ue.confirm("确认标记为无法联系？","提示",{type:"warning"});try{await xt({id:o.id}),w.success("标记成功"),K()}catch(e){console.error(e)}},pl=async o=>{await Ue.confirm("确认将问题升级为工单？","提示",{type:"warning"});try{await Dt({id:o.id}),w.success("升级成功"),K(),A()}catch(e){console.error(e)}},Te=o=>o?new Date(o*1e3).toLocaleString():"",ml=(o,e,P)=>{const D=o[e];return P.type==="time"&&D?typeof D=="number"?Te(D):D:D||"-"};return ut(()=>{A(),O()}),(o,e)=>{const P=xl,D=zl,pe=Ul,fl=Dl,L=hl,i=Sl,n=Rl,z=$l,p=Pl,h=Tl,u=jl,$=Il,me=Fl,fe=Bl,ce=El,re=Hl,cl=Ll,Q=Nl,bl=Al,Ce=Ol,be=Yl,Se=ql,vl=Kl,_l=Gl,gl=Ql,yl=Jl,kl=Wl,Vl=Zl,wl=Xl,Cl=et,ve=Ml;return f(),q("div",Lt,[l(fl,{gutter:16,class:"mb-4"},{default:a(()=>[l(pe,{span:6},{default:a(()=>[l(D,{shadow:"hover",class:"stat-card"},{default:a(()=>{var t,c;return[r("div",Et,[r("div",Tt,[l(P,{size:32},{default:a(()=>[l(de(lt))]),_:1})]),r("div",St,[r("div",ht,g(((t=F.value.ticket)==null?void 0:t.total)||0),1),e[62]||(e[62]=r("div",{class:"stat-label"},"工单总数",-1))])]),r("div",$t,[e[63]||(e[63]=s(" 待处理: ")),r("span",Rt,g(((c=F.value.ticket)==null?void 0:c.pending)||0),1)])]}),_:1})]),_:1}),l(pe,{span:6},{default:a(()=>[l(D,{shadow:"hover",class:"stat-card"},{default:a(()=>{var t,c;return[r("div",Pt,[r("div",Ft,[l(P,{size:32},{default:a(()=>[l(de(tt))]),_:1})]),r("div",jt,[r("div",It,g(((t=F.value.complaint)==null?void 0:t.total)||0),1),e[64]||(e[64]=r("div",{class:"stat-label"},"投诉总数",-1))])]),r("div",Mt,[e[65]||(e[65]=s(" 待处理: ")),r("span",Bt,g(((c=F.value.complaint)==null?void 0:c.pending)||0),1)])]}),_:1})]),_:1}),l(pe,{span:6},{default:a(()=>[l(D,{shadow:"hover",class:"stat-card"},{default:a(()=>{var t,c;return[r("div",Ht,[r("div",Nt,[l(P,{size:32},{default:a(()=>[l(de(at))]),_:1})]),r("div",At,[r("div",Ot,g(((t=F.value.reshoot)==null?void 0:t.total)||0),1),e[66]||(e[66]=r("div",{class:"stat-label"},"补拍申请",-1))])]),r("div",qt,[e[67]||(e[67]=s(" 待审核: ")),r("span",Yt,g(((c=F.value.reshoot)==null?void 0:c.pending)||0),1)])]}),_:1})]),_:1}),l(pe,{span:6},{default:a(()=>[l(D,{shadow:"hover",class:"stat-card"},{default:a(()=>{var t,c;return[r("div",Kt,[r("div",Gt,[l(P,{size:32},{default:a(()=>[l(de(ot))]),_:1})]),r("div",Jt,[r("div",Qt,g(((t=F.value.callback)==null?void 0:t.total)||0),1),e[68]||(e[68]=r("div",{class:"stat-label"},"回访任务",-1))])]),r("div",Wt,[e[69]||(e[69]=s(" 今日待回访: ")),r("span",Xt,g(((c=F.value.callback)==null?void 0:c.today_plan)||0),1)])]}),_:1})]),_:1})]),_:1}),l(D,{shadow:"never"},{default:a(()=>[l(cl,{modelValue:ze.value,"onUpdate:modelValue":e[23]||(e[23]=t=>ze.value=t),onTabChange:Ie},{default:a(()=>[l(ce,{label:"工单管理",name:"ticket"},{default:a(()=>[r("div",Zt,[l(h,{inline:!0,model:E},{default:a(()=>[l(i,{label:"工单编号"},{default:a(()=>[l(L,{modelValue:E.ticket_sn,"onUpdate:modelValue":e[0]||(e[0]=t=>E.ticket_sn=t),placeholder:"请输入工单编号",clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"工单类型"},{default:a(()=>[l(z,{modelValue:E.type,"onUpdate:modelValue":e[1]||(e[1]=t=>E.type=t),placeholder:"全部类型",clearable:""},{default:a(()=>[l(n,{label:"投诉",value:1}),l(n,{label:"咨询",value:2}),l(n,{label:"售后",value:3}),l(n,{label:"建议",value:4}),l(n,{label:"其他",value:5})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"优先级"},{default:a(()=>[l(z,{modelValue:E.priority,"onUpdate:modelValue":e[2]||(e[2]=t=>E.priority=t),placeholder:"全部优先级",clearable:""},{default:a(()=>[l(n,{label:"低",value:1}),l(n,{label:"中",value:2}),l(n,{label:"高",value:3}),l(n,{label:"紧急",value:4})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"状态"},{default:a(()=>[l(z,{modelValue:E.status,"onUpdate:modelValue":e[3]||(e[3]=t=>E.status=t),placeholder:"全部状态",clearable:""},{default:a(()=>[l(n,{label:"待分配",value:0}),l(n,{label:"处理中",value:1}),l(n,{label:"待确认",value:2}),l(n,{label:"已完成",value:3}),l(n,{label:"已关闭",value:4})]),_:1},8,["modelValue"])]),_:1}),l(i,null,{default:a(()=>[l(p,{type:"primary",onClick:O},{default:a(()=>e[70]||(e[70]=[s("搜索")])),_:1}),l(p,{onClick:Re},{default:a(()=>e[71]||(e[71]=[s("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_e((f(),v(me,{data:xe.value,stripe:""},{default:a(()=>[l(u,{prop:"ticket_sn",label:"工单编号",width:"180"}),l(u,{prop:"title",label:"标题","min-width":"200","show-overflow-tooltip":""}),l(u,{prop:"user.nickname",label:"用户",width:"120"}),l(u,{prop:"type_desc",label:"类型",width:"80"},{default:a(({row:t})=>[l($,{size:"small"},{default:a(()=>[s(g(t.type_desc),1)]),_:2},1024)]),_:1}),l(u,{prop:"priority_desc",label:"优先级",width:"80"},{default:a(({row:t})=>[l($,{type:Me(t.priority),size:"small"},{default:a(()=>[s(g(t.priority_desc),1)]),_:2},1032,["type"])]),_:1}),l(u,{prop:"status_desc",label:"状态",width:"90"},{default:a(({row:t})=>[l($,{type:Be(t.status),size:"small"},{default:a(()=>[s(g(t.status_desc),1)]),_:2},1032,["type"])]),_:1}),l(u,{prop:"assign_admin.name",label:"处理人",width:"100"}),l(u,{prop:"create_time",label:"创建时间",width:"160"}),l(u,{label:"操作",width:"200",fixed:"right"},{default:a(({row:t})=>[l(p,{type:"primary",link:"",size:"small",onClick:c=>qe(t)},{default:a(()=>e[72]||(e[72]=[s("详情")])),_:2},1032,["onClick"]),t.status===0?(f(),v(p,{key:0,type:"warning",link:"",size:"small",onClick:c=>Je(t)},{default:a(()=>e[73]||(e[73]=[s("分配")])),_:2},1032,["onClick"])):V("",!0),t.status===1?(f(),v(p,{key:1,type:"success",link:"",size:"small",onClick:c=>Qe(t)},{default:a(()=>e[74]||(e[74]=[s("处理")])),_:2},1032,["onClick"])):V("",!0),t.status<3?(f(),v(p,{key:2,type:"danger",link:"",size:"small",onClick:c=>We(t)},{default:a(()=>e[75]||(e[75]=[s("关闭")])),_:2},1032,["onClick"])):V("",!0)]),_:1})]),_:1},8,["data"])),[[ve,ye.value]]),r("div",ea,[l(fe,{"current-page":j.page,"onUpdate:currentPage":e[4]||(e[4]=t=>j.page=t),"page-size":j.limit,"onUpdate:pageSize":e[5]||(e[5]=t=>j.limit=t),total:j.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:O,onCurrentChange:O},null,8,["current-page","page-size","total"])])]),_:1}),l(ce,{label:"投诉管理",name:"complaint"},{default:a(()=>[r("div",la,[l(h,{inline:!0,model:T},{default:a(()=>[l(i,{label:"投诉编号"},{default:a(()=>[l(L,{modelValue:T.complaint_sn,"onUpdate:modelValue":e[6]||(e[6]=t=>T.complaint_sn=t),placeholder:"请输入投诉编号",clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"投诉类型"},{default:a(()=>[l(z,{modelValue:T.type,"onUpdate:modelValue":e[7]||(e[7]=t=>T.type=t),placeholder:"全部类型",clearable:""},{default:a(()=>[l(n,{label:"服务态度",value:1}),l(n,{label:"专业能力",value:2}),l(n,{label:"迟到早退",value:3}),l(n,{label:"违规行为",value:4}),l(n,{label:"其他",value:5})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"投诉等级"},{default:a(()=>[l(z,{modelValue:T.level,"onUpdate:modelValue":e[8]||(e[8]=t=>T.level=t),placeholder:"全部等级",clearable:""},{default:a(()=>[l(n,{label:"一般",value:1}),l(n,{label:"严重",value:2}),l(n,{label:"紧急",value:3})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"状态"},{default:a(()=>[l(z,{modelValue:T.status,"onUpdate:modelValue":e[9]||(e[9]=t=>T.status=t),placeholder:"全部状态",clearable:""},{default:a(()=>[l(n,{label:"待处理",value:0}),l(n,{label:"处理中",value:1}),l(n,{label:"已处理",value:2}),l(n,{label:"已关闭",value:4})]),_:1},8,["modelValue"])]),_:1}),l(i,null,{default:a(()=>[l(p,{type:"primary",onClick:Z},{default:a(()=>e[76]||(e[76]=[s("搜索")])),_:1}),l(p,{onClick:Pe},{default:a(()=>e[77]||(e[77]=[s("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_e((f(),v(me,{data:De.value,stripe:""},{default:a(()=>[l(u,{prop:"complaint_sn",label:"投诉编号",width:"180"}),l(u,{prop:"title",label:"标题","min-width":"200","show-overflow-tooltip":""}),l(u,{prop:"user.nickname",label:"投诉人",width:"120"}),l(u,{prop:"staff.name",label:"被投诉人员",width:"120"}),l(u,{prop:"type_desc",label:"类型",width:"90"},{default:a(({row:t})=>[l($,{size:"small"},{default:a(()=>[s(g(t.type_desc),1)]),_:2},1024)]),_:1}),l(u,{prop:"level_desc",label:"等级",width:"80"},{default:a(({row:t})=>[l($,{type:He(t.level),size:"small"},{default:a(()=>[s(g(t.level_desc),1)]),_:2},1032,["type"])]),_:1}),l(u,{prop:"status_desc",label:"状态",width:"90"},{default:a(({row:t})=>[l($,{type:Ne(t.status),size:"small"},{default:a(()=>[s(g(t.status_desc),1)]),_:2},1032,["type"])]),_:1}),l(u,{prop:"create_time",label:"创建时间",width:"160"}),l(u,{label:"操作",width:"150",fixed:"right"},{default:a(({row:t})=>[l(p,{type:"primary",link:"",size:"small",onClick:c=>Ye(t)},{default:a(()=>e[78]||(e[78]=[s("详情")])),_:2},1032,["onClick"]),t.status<2?(f(),v(p,{key:0,type:"success",link:"",size:"small",onClick:c=>Xe(t)},{default:a(()=>e[79]||(e[79]=[s("处理")])),_:2},1032,["onClick"])):V("",!0)]),_:1})]),_:1},8,["data"])),[[ve,ke.value]]),r("div",ta,[l(fe,{"current-page":I.page,"onUpdate:currentPage":e[10]||(e[10]=t=>I.page=t),"page-size":I.limit,"onUpdate:pageSize":e[11]||(e[11]=t=>I.limit=t),total:I.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Z,onCurrentChange:Z},null,8,["current-page","page-size","total"])])]),_:1}),l(ce,{label:"补拍申请",name:"reshoot"},{default:a(()=>[r("div",aa,[l(h,{inline:!0,model:M},{default:a(()=>[l(i,{label:"申请编号"},{default:a(()=>[l(L,{modelValue:M.reshoot_sn,"onUpdate:modelValue":e[12]||(e[12]=t=>M.reshoot_sn=t),placeholder:"请输入申请编号",clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"申请类型"},{default:a(()=>[l(z,{modelValue:M.type,"onUpdate:modelValue":e[13]||(e[13]=t=>M.type=t),placeholder:"全部类型",clearable:""},{default:a(()=>[l(n,{label:"补拍",value:1}),l(n,{label:"重拍",value:2})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"状态"},{default:a(()=>[l(z,{modelValue:M.status,"onUpdate:modelValue":e[14]||(e[14]=t=>M.status=t),placeholder:"全部状态",clearable:""},{default:a(()=>[l(n,{label:"待审核",value:0}),l(n,{label:"审核通过",value:1}),l(n,{label:"审核拒绝",value:2}),l(n,{label:"已安排",value:3}),l(n,{label:"已完成",value:4})]),_:1},8,["modelValue"])]),_:1}),l(i,null,{default:a(()=>[l(p,{type:"primary",onClick:Y},{default:a(()=>e[80]||(e[80]=[s("搜索")])),_:1}),l(p,{onClick:Fe},{default:a(()=>e[81]||(e[81]=[s("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_e((f(),v(me,{data:Le.value,stripe:""},{default:a(()=>[l(u,{prop:"reshoot_sn",label:"申请编号",width:"180"}),l(u,{prop:"user.nickname",label:"申请人",width:"120"}),l(u,{prop:"staff.name",label:"原服务人员",width:"120"}),l(u,{prop:"type_desc",label:"类型",width:"80"},{default:a(({row:t})=>[l($,{type:t.type===1?"primary":"warning",size:"small"},{default:a(()=>[s(g(t.type_desc),1)]),_:2},1032,["type"])]),_:1}),l(u,{prop:"reason_type_desc",label:"原因",width:"100"}),l(u,{prop:"status_desc",label:"状态",width:"90"},{default:a(({row:t})=>[l($,{type:Ae(t.status),size:"small"},{default:a(()=>[s(g(t.status_desc),1)]),_:2},1032,["type"])]),_:1}),l(u,{prop:"expect_date",label:"期望日期",width:"120"}),l(u,{prop:"schedule_date",label:"安排日期",width:"120"}),l(u,{prop:"create_time",label:"创建时间",width:"160"}),l(u,{label:"操作",width:"200",fixed:"right"},{default:a(({row:t})=>[l(p,{type:"primary",link:"",size:"small",onClick:c=>Ke(t)},{default:a(()=>e[82]||(e[82]=[s("详情")])),_:2},1032,["onClick"]),t.status===0?(f(),v(p,{key:0,type:"success",link:"",size:"small",onClick:c=>Ze(t)},{default:a(()=>e[83]||(e[83]=[s("审核")])),_:2},1032,["onClick"])):V("",!0),t.status===1?(f(),v(p,{key:1,type:"warning",link:"",size:"small",onClick:c=>el(t)},{default:a(()=>e[84]||(e[84]=[s("安排")])),_:2},1032,["onClick"])):V("",!0),t.status===3?(f(),v(p,{key:2,type:"primary",link:"",size:"small",onClick:c=>ul(t)},{default:a(()=>e[85]||(e[85]=[s("完成")])),_:2},1032,["onClick"])):V("",!0)]),_:1})]),_:1},8,["data"])),[[ve,Ve.value]]),r("div",oa,[l(fe,{"current-page":B.page,"onUpdate:currentPage":e[15]||(e[15]=t=>B.page=t),"page-size":B.limit,"onUpdate:pageSize":e[16]||(e[16]=t=>B.limit=t),total:B.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Y,onCurrentChange:Y},null,8,["current-page","page-size","total"])])]),_:1}),l(ce,{label:"回访管理",name:"callback"},{default:a(()=>[r("div",sa,[l(h,{inline:!0,model:S},{default:a(()=>[l(i,{label:"回访编号"},{default:a(()=>[l(L,{modelValue:S.callback_sn,"onUpdate:modelValue":e[17]||(e[17]=t=>S.callback_sn=t),placeholder:"请输入回访编号",clearable:""},null,8,["modelValue"])]),_:1}),l(i,{label:"回访类型"},{default:a(()=>[l(z,{modelValue:S.type,"onUpdate:modelValue":e[18]||(e[18]=t=>S.type=t),placeholder:"全部类型",clearable:""},{default:a(()=>[l(n,{label:"服务前",value:1}),l(n,{label:"服务中",value:2}),l(n,{label:"服务后",value:3})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"状态"},{default:a(()=>[l(z,{modelValue:S.status,"onUpdate:modelValue":e[19]||(e[19]=t=>S.status=t),placeholder:"全部状态",clearable:""},{default:a(()=>[l(n,{label:"待回访",value:0}),l(n,{label:"已回访",value:1}),l(n,{label:"无法联系",value:2})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"是否有问题"},{default:a(()=>[l(z,{modelValue:S.has_problem,"onUpdate:modelValue":e[20]||(e[20]=t=>S.has_problem=t),placeholder:"全部",clearable:""},{default:a(()=>[l(n,{label:"有问题",value:1}),l(n,{label:"无问题",value:0})]),_:1},8,["modelValue"])]),_:1}),l(i,null,{default:a(()=>[l(p,{type:"primary",onClick:K},{default:a(()=>e[86]||(e[86]=[s("搜索")])),_:1}),l(p,{onClick:je},{default:a(()=>e[87]||(e[87]=[s("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_e((f(),v(me,{data:Ee.value,stripe:""},{default:a(()=>[l(u,{prop:"callback_sn",label:"回访编号",width:"180"}),l(u,{prop:"user.nickname",label:"客户",width:"120"}),l(u,{prop:"staff.name",label:"服务人员",width:"120"}),l(u,{prop:"type_desc",label:"类型",width:"80"}),l(u,{prop:"method_desc",label:"方式",width:"80"}),l(u,{prop:"status_desc",label:"状态",width:"90"},{default:a(({row:t})=>[l($,{type:Oe(t.status),size:"small"},{default:a(()=>[s(g(t.status_desc),1)]),_:2},1032,["type"])]),_:1}),l(u,{prop:"score",label:"满意度",width:"100"},{default:a(({row:t})=>[t.score>0?(f(),v(re,{key:0,modelValue:t.score,"onUpdate:modelValue":c=>t.score=c,disabled:"",size:"small"},null,8,["modelValue","onUpdate:modelValue"])):(f(),q("span",na,"未评价"))]),_:1}),l(u,{prop:"has_problem",label:"问题",width:"80"},{default:a(({row:t})=>[t.has_problem?(f(),v($,{key:0,type:"danger",size:"small"},{default:a(()=>e[88]||(e[88]=[s("有问题")])),_:1})):(f(),v($,{key:1,type:"success",size:"small"},{default:a(()=>e[89]||(e[89]=[s("无")])),_:1}))]),_:1}),l(u,{prop:"plan_time",label:"计划时间",width:"160"}),l(u,{label:"操作",width:"200",fixed:"right"},{default:a(({row:t})=>[l(p,{type:"primary",link:"",size:"small",onClick:c=>Ge(t)},{default:a(()=>e[90]||(e[90]=[s("详情")])),_:2},1032,["onClick"]),t.status===0?(f(),v(p,{key:0,type:"success",link:"",size:"small",onClick:c=>ll(t)},{default:a(()=>e[91]||(e[91]=[s("回访")])),_:2},1032,["onClick"])):V("",!0),t.status===0?(f(),v(p,{key:1,type:"warning",link:"",size:"small",onClick:c=>dl(t)},{default:a(()=>e[92]||(e[92]=[s("无法联系")])),_:2},1032,["onClick"])):V("",!0),t.has_problem&&t.problem_status===0?(f(),v(p,{key:2,type:"danger",link:"",size:"small",onClick:c=>pl(t)},{default:a(()=>e[93]||(e[93]=[s("升级")])),_:2},1032,["onClick"])):V("",!0)]),_:1})]),_:1},8,["data"])),[[ve,we.value]]),r("div",ia,[l(fe,{"current-page":H.page,"onUpdate:currentPage":e[21]||(e[21]=t=>H.page=t),"page-size":H.limit,"onUpdate:pageSize":e[22]||(e[22]=t=>H.limit=t),total:H.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:K,onCurrentChange:K},null,8,["current-page","page-size","total"])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(Q,{modelValue:ee.value,"onUpdate:modelValue":e[26]||(e[26]=t=>ee.value=t),title:"分配工单",width:"500px"},{footer:a(()=>[l(p,{onClick:e[25]||(e[25]=t=>ee.value=!1)},{default:a(()=>e[94]||(e[94]=[s("取消")])),_:1}),l(p,{type:"primary",onClick:tl,loading:_.value},{default:a(()=>e[95]||(e[95]=[s("确定")])),_:1},8,["loading"])]),default:a(()=>[l(h,{model:G,"label-width":"80px"},{default:a(()=>[l(i,{label:"处理人"},{default:a(()=>[l(z,{modelValue:G.admin_id,"onUpdate:modelValue":e[24]||(e[24]=t=>G.admin_id=t),placeholder:"请选择处理人",filterable:""},{default:a(()=>[(f(!0),q(W,null,ge(he.value,t=>(f(),v(n,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Q,{modelValue:le.value,"onUpdate:modelValue":e[30]||(e[30]=t=>le.value=t),title:"处理工单",width:"600px"},{footer:a(()=>[l(p,{onClick:e[29]||(e[29]=t=>le.value=!1)},{default:a(()=>e[96]||(e[96]=[s("取消")])),_:1}),l(p,{type:"primary",onClick:al,loading:_.value},{default:a(()=>e[97]||(e[97]=[s("确定")])),_:1},8,["loading"])]),default:a(()=>[l(h,{model:x,"label-width":"80px"},{default:a(()=>[l(i,{label:"处理结果",required:""},{default:a(()=>[l(L,{modelValue:x.result,"onUpdate:modelValue":e[27]||(e[27]=t=>x.result=t),type:"textarea",rows:4,placeholder:"请输入处理结果"},null,8,["modelValue"])]),_:1}),l(i,{label:"附件图片"},{default:a(()=>[l(bl,{"file-list":x.imageList,"onUpdate:fileList":e[28]||(e[28]=t=>x.imageList=t),action:"/api/upload/image","list-type":"picture-card",limit:5},{default:a(()=>[l(P,null,{default:a(()=>[l(de(st))]),_:1})]),_:1},8,["file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Q,{modelValue:te.value,"onUpdate:modelValue":e[33]||(e[33]=t=>te.value=t),title:"关闭工单",width:"500px"},{footer:a(()=>[l(p,{onClick:e[32]||(e[32]=t=>te.value=!1)},{default:a(()=>e[98]||(e[98]=[s("取消")])),_:1}),l(p,{type:"primary",onClick:ol,loading:_.value},{default:a(()=>e[99]||(e[99]=[s("确定")])),_:1},8,["loading"])]),default:a(()=>[l(h,{model:J,"label-width":"80px"},{default:a(()=>[l(i,{label:"关闭原因",required:""},{default:a(()=>[l(L,{modelValue:J.reason,"onUpdate:modelValue":e[31]||(e[31]=t=>J.reason=t),type:"textarea",rows:3,placeholder:"请输入关闭原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Q,{modelValue:ae.value,"onUpdate:modelValue":e[38]||(e[38]=t=>ae.value=t),title:"处理投诉",width:"600px"},{footer:a(()=>[l(p,{onClick:e[37]||(e[37]=t=>ae.value=!1)},{default:a(()=>e[100]||(e[100]=[s("取消")])),_:1}),l(p,{type:"primary",onClick:sl,loading:_.value},{default:a(()=>e[101]||(e[101]=[s("确定")])),_:1},8,["loading"])]),default:a(()=>[l(h,{model:U,"label-width":"80px"},{default:a(()=>[l(i,{label:"处理动作"},{default:a(()=>[l(z,{modelValue:U.action,"onUpdate:modelValue":e[34]||(e[34]=t=>U.action=t),placeholder:"请选择处理动作"},{default:a(()=>[l(n,{label:"无",value:0}),l(n,{label:"警告",value:1}),l(n,{label:"扣款",value:2}),l(n,{label:"禁用",value:3}),l(n,{label:"其他",value:4})]),_:1},8,["modelValue"])]),_:1}),U.action===2?(f(),v(i,{key:0,label:"扣款金额"},{default:a(()=>[l(Ce,{modelValue:U.amount,"onUpdate:modelValue":e[35]||(e[35]=t=>U.amount=t),min:0,precision:2},null,8,["modelValue"])]),_:1})):V("",!0),l(i,{label:"处理结果",required:""},{default:a(()=>[l(L,{modelValue:U.result,"onUpdate:modelValue":e[36]||(e[36]=t=>U.result=t),type:"textarea",rows:4,placeholder:"请输入处理结果"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Q,{modelValue:oe.value,"onUpdate:modelValue":e[44]||(e[44]=t=>oe.value=t),title:"审核补拍申请",width:"500px"},{footer:a(()=>[l(p,{onClick:e[43]||(e[43]=t=>oe.value=!1)},{default:a(()=>e[106]||(e[106]=[s("取消")])),_:1}),l(p,{type:"primary",onClick:nl,loading:_.value},{default:a(()=>e[107]||(e[107]=[s("确定")])),_:1},8,["loading"])]),default:a(()=>[l(h,{model:k,"label-width":"80px"},{default:a(()=>[l(i,{label:"审核结果"},{default:a(()=>[l(Se,{modelValue:k.approved,"onUpdate:modelValue":e[39]||(e[39]=t=>k.approved=t)},{default:a(()=>[l(be,{label:1},{default:a(()=>e[102]||(e[102]=[s("通过")])),_:1}),l(be,{label:0},{default:a(()=>e[103]||(e[103]=[s("拒绝")])),_:1})]),_:1},8,["modelValue"])]),_:1}),k.approved===1?(f(),v(i,{key:0,label:"是否免费"},{default:a(()=>[l(Se,{modelValue:k.is_free,"onUpdate:modelValue":e[40]||(e[40]=t=>k.is_free=t)},{default:a(()=>[l(be,{label:1},{default:a(()=>e[104]||(e[104]=[s("免费")])),_:1}),l(be,{label:0},{default:a(()=>e[105]||(e[105]=[s("收费")])),_:1})]),_:1},8,["modelValue"])]),_:1})):V("",!0),k.approved===1&&k.is_free===0?(f(),v(i,{key:1,label:"费用"},{default:a(()=>[l(Ce,{modelValue:k.fee,"onUpdate:modelValue":e[41]||(e[41]=t=>k.fee=t),min:0,precision:2},null,8,["modelValue"])]),_:1})):V("",!0),l(i,{label:"备注"},{default:a(()=>[l(L,{modelValue:k.remark,"onUpdate:modelValue":e[42]||(e[42]=t=>k.remark=t),type:"textarea",rows:3,placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Q,{modelValue:se.value,"onUpdate:modelValue":e[48]||(e[48]=t=>se.value=t),title:"安排补拍",width:"500px"},{footer:a(()=>[l(p,{onClick:e[47]||(e[47]=t=>se.value=!1)},{default:a(()=>e[108]||(e[108]=[s("取消")])),_:1}),l(p,{type:"primary",onClick:il,loading:_.value},{default:a(()=>e[109]||(e[109]=[s("确定")])),_:1},8,["loading"])]),default:a(()=>[l(h,{model:R,"label-width":"80px"},{default:a(()=>[l(i,{label:"拍摄日期",required:""},{default:a(()=>[l(vl,{modelValue:R.schedule_date,"onUpdate:modelValue":e[45]||(e[45]=t=>R.schedule_date=t),type:"date",placeholder:"选择日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),l(i,{label:"服务人员"},{default:a(()=>[l(z,{modelValue:R.new_staff_id,"onUpdate:modelValue":e[46]||(e[46]=t=>R.new_staff_id=t),placeholder:"请选择服务人员",filterable:"",clearable:""},{default:a(()=>[(f(!0),q(W,null,ge($e.value,t=>(f(),v(n,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Q,{modelValue:ne.value,"onUpdate:modelValue":e[60]||(e[60]=t=>ne.value=t),title:"完成回访",width:"600px"},{footer:a(()=>[l(p,{onClick:e[59]||(e[59]=t=>ne.value=!1)},{default:a(()=>e[110]||(e[110]=[s("取消")])),_:1}),l(p,{type:"primary",onClick:rl,loading:_.value},{default:a(()=>e[111]||(e[111]=[s("确定")])),_:1},8,["loading"])]),default:a(()=>[l(h,{model:m,"label-width":"100px"},{default:a(()=>[l(i,{label:"满意度评分"},{default:a(()=>[l(re,{modelValue:m.score,"onUpdate:modelValue":e[49]||(e[49]=t=>m.score=t)},null,8,["modelValue"])]),_:1}),l(i,{label:"服务态度"},{default:a(()=>[l(re,{modelValue:m.score_service,"onUpdate:modelValue":e[50]||(e[50]=t=>m.score_service=t)},null,8,["modelValue"])]),_:1}),l(i,{label:"专业水平"},{default:a(()=>[l(re,{modelValue:m.score_professional,"onUpdate:modelValue":e[51]||(e[51]=t=>m.score_professional=t)},null,8,["modelValue"])]),_:1}),l(i,{label:"时间守约"},{default:a(()=>[l(re,{modelValue:m.score_punctual,"onUpdate:modelValue":e[52]||(e[52]=t=>m.score_punctual=t)},null,8,["modelValue"])]),_:1}),l(i,{label:"回访时长(秒)"},{default:a(()=>[l(Ce,{modelValue:m.duration,"onUpdate:modelValue":e[53]||(e[53]=t=>m.duration=t),min:0},null,8,["modelValue"])]),_:1}),l(i,{label:"回访内容"},{default:a(()=>[l(L,{modelValue:m.content,"onUpdate:modelValue":e[54]||(e[54]=t=>m.content=t),type:"textarea",rows:3,placeholder:"请输入回访内容"},null,8,["modelValue"])]),_:1}),l(i,{label:"回访摘要"},{default:a(()=>[l(L,{modelValue:m.summary,"onUpdate:modelValue":e[55]||(e[55]=t=>m.summary=t),type:"textarea",rows:2,placeholder:"请输入回访摘要"},null,8,["modelValue"])]),_:1}),l(i,{label:"是否有问题"},{default:a(()=>[l(_l,{modelValue:m.has_problem,"onUpdate:modelValue":e[56]||(e[56]=t=>m.has_problem=t),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),m.has_problem===1?(f(),q(W,{key:0},[l(i,{label:"问题类型"},{default:a(()=>[l(L,{modelValue:m.problem_type,"onUpdate:modelValue":e[57]||(e[57]=t=>m.problem_type=t),placeholder:"请输入问题类型"},null,8,["modelValue"])]),_:1}),l(i,{label:"问题描述"},{default:a(()=>[l(L,{modelValue:m.problem_desc,"onUpdate:modelValue":e[58]||(e[58]=t=>m.problem_desc=t),type:"textarea",rows:2,placeholder:"请输入问题描述"},null,8,["modelValue"])]),_:1})],64)):V("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(Cl,{modelValue:X.value,"onUpdate:modelValue":e[61]||(e[61]=t=>X.value=t),title:ie.value,size:"600px"},{default:a(()=>[N.value?(f(),q(W,{key:0},[l(yl,{column:2,border:""},{default:a(()=>[(f(!0),q(W,null,ge(ue.value,(t,c)=>(f(),v(gl,{key:c,label:t.label},{default:a(()=>[s(g(ml(N.value,c,t)),1)]),_:2},1032,["label"]))),128))]),_:1}),N.value.logs&&N.value.logs.length>0?(f(),q(W,{key:0},[l(kl,null,{default:a(()=>e[112]||(e[112]=[s("操作日志")])),_:1}),l(wl,null,{default:a(()=>[(f(!0),q(W,null,ge(N.value.logs,t=>(f(),v(Vl,{key:t.id,timestamp:Te(t.create_time),placement:"top"},{default:a(()=>[l(D,{shadow:"never"},{default:a(()=>[r("p",null,g(t.content),1)]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})],64)):V("",!0)],64)):V("",!0)]),_:1},8,["modelValue","title"])])}}}),Ba=nt(ua,[["__scopeId","data-v-e8e593cf"]]);export{Ba as default};

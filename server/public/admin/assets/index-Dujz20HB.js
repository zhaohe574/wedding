import{D as Q,B as Z,C as ee,J as te,K as le,V as se,i as ae,H as oe,L as ne,M as de,N as re,O as ie,W as ue,X as me,R as _e}from"./element-plus-ChK2e5qA.js";import{_ as pe}from"./index.vue_vue_type_script_setup_true_lang-CCtv5BMP.js";import{d as Y,a0 as M,r as D,a1 as fe,c as y,o as _,U as e,a as n,L as l,u as a,a9 as ce,R as d,S as o,M as ve,K as S,P as U,i as $}from"./@vue-ygbFPFRc.js";import{r as be,g as xe,h as ye,i as ge,j as ke}from"./order-B04ZaiMZ.js";import{u as Ve}from"./usePaging-B2jDzebD.js";import{f as K}from"./index-D465kfFn.js";import"./@element-plus-C4Lf8veM.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";const Ce={class:"refund-lists"},we={class:"mt-4 grid grid-cols-5 gap-4"},he={class:"text-center"},Ee={class:"text-2xl font-bold mt-2 text-orange-500"},De={class:"text-center"},Se={class:"text-2xl font-bold mt-2 text-blue-500"},Ue={class:"text-center"},Be={class:"text-2xl font-bold mt-2 text-purple-500"},Le={class:"text-center"},Pe={class:"text-2xl font-bold mt-2 text-green-500"},$e={class:"text-center"},Ke={class:"text-2xl font-bold mt-2 text-red-500"},Ne={key:0},Re={key:1},Te={key:0},Ae={key:1},Fe={class:"text-red-500 font-bold"},Me={class:"flex justify-end mt-4"},Ye={key:0},Ie={class:"text-red-500 font-bold"},je=Y({name:"refundLists"}),ht=Y({...je,setup(ze){const f=M({refund_sn:"",refund_status:"",create_time:[]}),B=D({}),w=D(!1),r=D(null),b=D(!1),u=M({id:0,approved:!0,remark:""}),{pager:g,getLists:k,resetPage:N,resetParams:I}=Ve({fetchFun:be,params:f}),h=async()=>{const i=await xe();B.value=i},V=i=>{if(!B.value.status_counts)return 0;const t=B.value.status_counts.find(E=>E.status===i);return t?t.count:0},R=i=>({0:"warning",1:"primary",2:"info",3:"success",4:"danger"})[i]||"info",j=async i=>{const t=await ye({id:i.id});r.value=t,w.value=!0},T=(i,t)=>{u.id=i.id,u.approved=t,u.remark="",b.value=!0},z=async()=>{await ge(u),K.msgSuccess("审核成功"),b.value=!1,k(),h()},O=async i=>{await K.confirm("确定退款已完成吗？"),await ke({id:i.id}),K.msgSuccess("操作成功"),k(),h()};return fe(()=>{k(),h()}),k(),h(),(i,t)=>{const E=ee,C=Z,x=le,q=te,H=se,c=ae,A=Q,v=oe,p=de,L=re,J=ne,W=pe,m=me,X=ue,F=_e,G=ie;return _(),y("div",Ce,[e(v,{class:"!border-none",shadow:"never"},{default:l(()=>[e(A,{ref:"formRef",class:"mb-[-16px]",model:a(f),inline:!0},{default:l(()=>[e(C,{class:"w-[180px]",label:"退款编号"},{default:l(()=>[e(E,{modelValue:a(f).refund_sn,"onUpdate:modelValue":t[0]||(t[0]=s=>a(f).refund_sn=s),placeholder:"输入退款编号",clearable:"",onKeyup:ce(a(N),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),e(C,{class:"w-[150px]",label:"退款状态"},{default:l(()=>[e(q,{modelValue:a(f).refund_status,"onUpdate:modelValue":t[1]||(t[1]=s=>a(f).refund_status=s),placeholder:"选择状态",clearable:""},{default:l(()=>[e(x,{label:"全部",value:""}),e(x,{label:"待审核",value:0}),e(x,{label:"审核通过",value:1}),e(x,{label:"退款中",value:2}),e(x,{label:"已退款",value:3}),e(x,{label:"已拒绝",value:4})]),_:1},8,["modelValue"])]),_:1}),e(C,{class:"w-[320px]",label:"申请时间"},{default:l(()=>[e(H,{modelValue:a(f).create_time,"onUpdate:modelValue":t[2]||(t[2]=s=>a(f).create_time=s),type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",clearable:""},null,8,["modelValue"])]),_:1}),e(C,null,{default:l(()=>[e(c,{type:"primary",onClick:a(N)},{default:l(()=>t[8]||(t[8]=[d("查询")])),_:1},8,["onClick"]),e(c,{onClick:a(I)},{default:l(()=>t[9]||(t[9]=[d("重置")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),n("div",we,[e(v,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",he,[t[10]||(t[10]=n("div",{class:"text-gray-500 text-sm"},"待审核",-1)),n("div",Ee,o(V(0)),1)])]),_:1}),e(v,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",De,[t[11]||(t[11]=n("div",{class:"text-gray-500 text-sm"},"审核通过",-1)),n("div",Se,o(V(1)),1)])]),_:1}),e(v,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",Ue,[t[12]||(t[12]=n("div",{class:"text-gray-500 text-sm"},"退款中",-1)),n("div",Be,o(V(2)),1)])]),_:1}),e(v,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",Le,[t[13]||(t[13]=n("div",{class:"text-gray-500 text-sm"},"已退款",-1)),n("div",Pe,o(V(3)),1)])]),_:1}),e(v,{class:"!border-none",shadow:"never"},{default:l(()=>[n("div",$e,[t[14]||(t[14]=n("div",{class:"text-gray-500 text-sm"},"已拒绝",-1)),n("div",Ke,o(V(4)),1)])]),_:1})]),e(v,{class:"!border-none mt-4",shadow:"never"},{default:l(()=>[ve((_(),S(J,{size:"large",data:a(g).lists},{default:l(()=>[e(p,{label:"退款编号",prop:"refund_sn","min-width":"180"}),e(p,{label:"订单编号","min-width":"180"},{default:l(({row:s})=>[s.order?(_(),y("span",Ne,o(s.order.order_sn),1)):(_(),y("span",Re,"-"))]),_:1}),e(p,{label:"用户","min-width":"120"},{default:l(({row:s})=>[s.order&&s.order.user?(_(),y("span",Te,o(s.order.user.nickname),1)):(_(),y("span",Ae,"-"))]),_:1}),e(p,{label:"退款金额",width:"120"},{default:l(({row:s})=>[n("span",Fe,"¥"+o(s.refund_amount),1)]),_:1}),e(p,{label:"退款类型",width:"100"},{default:l(({row:s})=>[e(L,{size:"small"},{default:l(()=>[d(o(s.refund_type_desc),1)]),_:2},1024)]),_:1}),e(p,{label:"退款状态",width:"100"},{default:l(({row:s})=>[e(L,{type:R(s.refund_status)},{default:l(()=>[d(o(s.refund_status_desc),1)]),_:2},1032,["type"])]),_:1}),e(p,{label:"退款原因",prop:"refund_reason","min-width":"150","show-overflow-tooltip":""}),e(p,{label:"申请时间",prop:"create_time",width:"170"}),e(p,{label:"操作",width:"180",fixed:"right"},{default:l(({row:s})=>[e(c,{type:"primary",link:"",onClick:P=>j(s)},{default:l(()=>t[15]||(t[15]=[d("详情")])),_:2},1032,["onClick"]),s.refund_status===0?(_(),S(c,{key:0,type:"success",link:"",onClick:P=>T(s,!0)},{default:l(()=>t[16]||(t[16]=[d("通过")])),_:2},1032,["onClick"])):U("",!0),s.refund_status===0?(_(),S(c,{key:1,type:"danger",link:"",onClick:P=>T(s,!1)},{default:l(()=>t[17]||(t[17]=[d("拒绝")])),_:2},1032,["onClick"])):U("",!0),s.refund_status===1||s.refund_status===2?(_(),S(c,{key:2,type:"warning",link:"",onClick:P=>O(s)},{default:l(()=>t[18]||(t[18]=[d("确认退款")])),_:2},1032,["onClick"])):U("",!0)]),_:1})]),_:1},8,["data"])),[[G,a(g).loading]]),n("div",Me,[e(W,{modelValue:a(g),"onUpdate:modelValue":t[3]||(t[3]=s=>$(g)?g.value=s:null),onChange:a(k)},null,8,["modelValue","onChange"])])]),_:1}),e(F,{modelValue:a(w),"onUpdate:modelValue":t[4]||(t[4]=s=>$(w)?w.value=s:null),title:"退款详情",width:"600px"},{default:l(()=>[a(r)?(_(),y("div",Ye,[e(X,{column:2,border:""},{default:l(()=>[e(m,{label:"退款编号"},{default:l(()=>[d(o(a(r).refund_sn),1)]),_:1}),e(m,{label:"退款状态"},{default:l(()=>[e(L,{type:R(a(r).refund_status)},{default:l(()=>[d(o(a(r).refund_status_desc),1)]),_:1},8,["type"])]),_:1}),e(m,{label:"订单编号"},{default:l(()=>{var s;return[d(o(((s=a(r).order)==null?void 0:s.order_sn)||"-"),1)]}),_:1}),e(m,{label:"退款金额"},{default:l(()=>[n("span",Ie,"¥"+o(a(r).refund_amount),1)]),_:1}),e(m,{label:"退款类型"},{default:l(()=>[d(o(a(r).refund_type_desc),1)]),_:1}),e(m,{label:"申请时间"},{default:l(()=>[d(o(a(r).create_time),1)]),_:1}),e(m,{label:"退款原因",span:2},{default:l(()=>[d(o(a(r).refund_reason),1)]),_:1}),e(m,{label:"审核时间"},{default:l(()=>[d(o(a(r).audit_time||"-"),1)]),_:1}),e(m,{label:"退款时间"},{default:l(()=>[d(o(a(r).refund_time||"-"),1)]),_:1}),e(m,{label:"审核备注",span:2},{default:l(()=>[d(o(a(r).audit_remark||"-"),1)]),_:1})]),_:1})])):U("",!0)]),_:1},8,["modelValue"]),e(F,{modelValue:a(b),"onUpdate:modelValue":t[7]||(t[7]=s=>$(b)?b.value=s:null),title:a(u).approved?"审核通过":"审核拒绝",width:"500px"},{footer:l(()=>[e(c,{onClick:t[6]||(t[6]=s=>b.value=!1)},{default:l(()=>t[19]||(t[19]=[d("取消")])),_:1}),e(c,{type:a(u).approved?"success":"danger",onClick:z},{default:l(()=>[d(o(a(u).approved?"确认通过":"确认拒绝"),1)]),_:1},8,["type"])]),default:l(()=>[e(A,{model:a(u),"label-width":"100px"},{default:l(()=>[e(C,{label:"审核备注"},{default:l(()=>[e(E,{modelValue:a(u).remark,"onUpdate:modelValue":t[5]||(t[5]=s=>a(u).remark=s),type:"textarea",rows:3,placeholder:"请输入审核备注（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{ht as default};

import{D as H,B as O,C as J,i as Q,H as W,O as X,L as Y,M as Z,p as ee,n as te,o as oe}from"./element-plus-ChK2e5qA.js";import{_ as ne}from"./index.vue_vue_type_script_setup_true_lang-CCtv5BMP.js";import{b as ae,g as le,f as x}from"./index-D465kfFn.js";import{d as S,a0 as B,r as se,ah as re,at as ie,c as y,o as s,U as t,M as m,K as p,P as me,L as o,u as n,a9 as K,R as i,a as w,i as de}from"./@vue-ygbFPFRc.js";import{b as pe,c as ue,d as _e,e as ce,s as fe}from"./code-CAnlZ9_m.js";import{u as ge}from"./usePaging-B2jDzebD.js";import{_ as be}from"./code-preview.vue_vue_type_script_setup_true_lang-BrtFoo1R.js";import{_ as ye}from"./data-table.vue_vue_type_script_setup_true_lang-BaaiDIDL.js";import"./@element-plus-C4Lf8veM.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";import"./index-n-Jqn6Y-.js";const we={class:"code-generation"},ve={class:"flex"},Ce={class:"mt-4"},ke={class:"flex items-center"},Ve={class:"flex justify-end mt-4"},xe=S({name:"codeGenerate"}),mt=S({...xe,setup(Ee){const u=B({table_name:"",table_comment:""}),_=B({show:!1,loading:!1,code:[]}),{pager:f,getLists:b,resetParams:T,resetPage:v}=ge({fetchFun:pe,params:u}),g=se([]),U=a=>{g.value=a.map(({id:e})=>e)},I=async a=>{await x.confirm("确定要同步表结构？"),await fe({id:a})},E=async a=>{await x.confirm("确定要删除？"),await ue({id:a}),b()},L=async a=>{const e=await _e({id:a});_.code=e,_.show=!0},M=a=>a.some(e=>e.generate_type==1),D=async a=>{if(M(a))return x.msgError("生成方式为生成到模块，请在前端开发模式下使用，详细参考文档");const e=await ce({id:a});e.file&&window.open(e.file,"_blank")},N=(a,e)=>{switch(a){case"generate":D([e.id]);break;case"sync":I(e.id);break;case"delete":E(e.id)}};return b(),(a,e)=>{const P=J,C=O,r=Q,F=H,h=W,k=ae,c=Z,G=re("router-link"),V=oe,R=te,z=ee,j=Y,q=ne,d=ie("perms"),A=X;return s(),y("div",we,[t(h,{class:"!border-none",shadow:"never"},{default:o(()=>[t(F,{class:"mb-[-16px]",model:n(u),inline:""},{default:o(()=>[t(C,{class:"w-[280px]",label:"表名称"},{default:o(()=>[t(P,{modelValue:n(u).table_name,"onUpdate:modelValue":e[0]||(e[0]=l=>n(u).table_name=l),clearable:"",onKeyup:K(n(v),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(C,{class:"w-[280px]",label:"表描述"},{default:o(()=>[t(P,{modelValue:n(u).table_comment,"onUpdate:modelValue":e[1]||(e[1]=l=>n(u).table_comment=l),clearable:"",onKeyup:K(n(v),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(C,null,{default:o(()=>[t(r,{type:"primary",onClick:n(v)},{default:o(()=>e[6]||(e[6]=[i("查询")])),_:1},8,["onClick"]),t(r,{onClick:n(T)},{default:o(()=>e[7]||(e[7]=[i("重置")])),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1}),m((s(),p(h,{class:"!border-none mt-4",shadow:"never"},{default:o(()=>[w("div",ve,[m((s(),p(ye,{class:"inline-block mr-[10px]",onSuccess:n(b)},{default:o(()=>[t(r,{type:"primary"},{icon:o(()=>[t(k,{name:"el-icon-Plus"})]),default:o(()=>[e[8]||(e[8]=i(" 导入数据表 "))]),_:1})]),_:1},8,["onSuccess"])),[[d,["tools.generator/selectTable"]]]),m((s(),p(r,{disabled:!n(g).length,onClick:e[2]||(e[2]=l=>E(n(g))),type:"danger"},{icon:o(()=>[t(k,{name:"el-icon-Delete"})]),default:o(()=>[e[9]||(e[9]=i(" 删除 "))]),_:1},8,["disabled"])),[[d,["tools.generator/delete"]]]),m((s(),p(r,{disabled:!n(g).length,onClick:e[3]||(e[3]=l=>D(n(g)))},{default:o(()=>e[10]||(e[10]=[i(" 生成代码 ")])),_:1},8,["disabled"])),[[d,["tools.generator/generate"]]])]),w("div",Ce,[t(j,{data:n(f).lists,size:"large",onSelectionChange:U},{default:o(()=>[t(c,{type:"selection",width:"55"}),t(c,{label:"表名称",prop:"table_name","min-width":"180"}),t(c,{label:"表描述",prop:"table_comment","min-width":"180"}),t(c,{label:"创建时间",prop:"create_time","min-width":"180"}),t(c,{label:"更新时间",prop:"update_time","min-width":"180"}),t(c,{label:"操作",width:"160",fixed:"right"},{default:o(({row:l})=>[w("div",ke,[m((s(),p(r,{type:"primary",link:"",onClick:$=>L(l.id)},{default:o(()=>e[11]||(e[11]=[i(" 预览 ")])),_:2},1032,["onClick"])),[[d,["tools.generator/preview"]]]),t(r,{type:"primary",link:""},{default:o(()=>[m((s(),p(G,{to:{path:n(le)("tools.generator/edit"),query:{id:l.id}}},{default:o(()=>e[12]||(e[12]=[i(" 编辑 ")])),_:2},1032,["to"])),[[d,["tools.generator/edit"]]])]),_:2},1024),m((s(),p(z,{class:"ml-2",onCommand:$=>N($,l)},{dropdown:o(()=>[t(R,null,{default:o(()=>[m((s(),y("div",null,[t(V,{command:"generate"},{default:o(()=>[t(r,{type:"primary",link:""},{default:o(()=>e[14]||(e[14]=[i(" 生成代码 ")])),_:1})]),_:1})])),[[d,["tools.generator/generate"]]]),m((s(),y("div",null,[t(V,{command:"sync"},{default:o(()=>[t(r,{type:"primary",link:""},{default:o(()=>e[15]||(e[15]=[i(" 同步 ")])),_:1})]),_:1})])),[[d,["tools.generator/syncColumn"]]]),m((s(),y("div",null,[t(V,{command:"delete"},{default:o(()=>[t(r,{type:"danger",link:""},{default:o(()=>e[16]||(e[16]=[i(" 删除 ")])),_:1})]),_:1})])),[[d,["tools.generator/delete"]]])]),_:1})]),default:o(()=>[t(r,{type:"primary",link:""},{default:o(()=>[e[13]||(e[13]=i(" 更多 ")),t(k,{name:"el-icon-ArrowDown",size:14})]),_:1})]),_:2},1032,["onCommand"])),[[d,["tools.generator/generate","tools.generator/syncColumn","tools.generator/delete"]]])])]),_:1})]),_:1},8,["data"])]),w("div",Ve,[t(q,{modelValue:n(f),"onUpdate:modelValue":e[4]||(e[4]=l=>de(f)?f.value=l:null),onChange:n(b)},null,8,["modelValue","onChange"])])]),_:1})),[[A,n(f).loading]]),n(_).show?(s(),p(be,{key:0,modelValue:n(_).show,"onUpdate:modelValue":e[5]||(e[5]=l=>n(_).show=l),code:n(_).code},null,8,["modelValue","code"])):me("",!0)])}}});export{mt as default};

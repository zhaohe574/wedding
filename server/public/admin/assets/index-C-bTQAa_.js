import{G as ne,H as ie,I as de,D as ue,B as re,J as pe,K as _e,i as me,L as ce,M as ve,Q as fe,N as be,O as ge,P as ye,W as we,X as ke,v as Ee,Y as Ve,T as xe,U as he,C as Ce,R as De,E as Ue}from"./element-plus-ChK2e5qA.js";import{g as Se,a as Ie,b as K,h as Pe}from"./review-BZd6SHk0.js";import{d as Re,r as k,a0 as O,l as Te,c as D,o as c,U as e,L as a,a as s,S as i,R as d,M as Be,K as U,P as E,T as Le,ab as Ae}from"./@vue-ygbFPFRc.js";import{d as Ne}from"./index-D465kfFn.js";import"./@element-plus-C4Lf8veM.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";const ze={class:"appeal-container"},Fe={class:"stat-value"},Me={class:"stat-value"},$e={class:"stat-value"},Ge={class:"stat-value"},Ke={class:"review-brief"},Oe={class:"user"},je={class:"content"},qe={class:"pagination-wrap"},He={key:0},Je={key:0,class:"evidence-images mt-4"},Qe={class:"images"},We={class:"original-review"},Xe={class:"review-card"},Ye={class:"user"},Ze={class:"content"},et={key:1,class:"process-form mt-4"},tt=Re({__name:"index",setup(at){const P=k(!1),L=k([]),A=k(0),V=k({}),b=k(!1),o=k(null),n=O({page:1,limit:10,status:void 0,appeal_type:void 0}),r=O({status:1,handle_action:0,handle_result:""}),j=p=>({0:"warning",1:"success",2:"danger"})[p]||"info",x=async()=>{P.value=!0;try{const p=await Se(n);L.value=p.lists||[],A.value=p.count||0}finally{P.value=!1}},N=async()=>{const p=await Ie();V.value=p},q=()=>{n.page=1,x()},H=()=>{n.status=void 0,n.appeal_type=void 0,n.page=1,x()},J=async p=>{const t=await K({id:p.id});o.value=t,b.value=!0},Q=async p=>{const t=await K({id:p.id});o.value=t,r.status=1,r.handle_action=0,r.handle_result="",b.value=!0},W=async()=>{await Pe({id:o.value.id,...r}),Ue.success("处理成功"),b.value=!1,x(),N()};return Te(()=>{x(),N()}),(p,t)=>{var G;const g=ie,S=ne,X=de,_=_e,R=pe,y=re,w=me,z=ue,f=ve,F=fe,T=be,Y=ce,Z=ye,B=ke,ee=we,te=Ee,M=Ve,$=he,ae=xe,le=Ce,se=De,oe=ge;return c(),D("div",ze,[e(X,{gutter:16,class:"mb-4"},{default:a(()=>[e(S,{span:6},{default:a(()=>[e(g,{shadow:"hover",class:"stat-card"},{default:a(()=>[s("div",Fe,i(V.value.total_count||0),1),t[9]||(t[9]=s("div",{class:"stat-label"},"总申诉数",-1))]),_:1})]),_:1}),e(S,{span:6},{default:a(()=>[e(g,{shadow:"hover",class:"stat-card pending"},{default:a(()=>[s("div",Me,i(V.value.pending_count||0),1),t[10]||(t[10]=s("div",{class:"stat-label"},"待处理",-1))]),_:1})]),_:1}),e(S,{span:6},{default:a(()=>[e(g,{shadow:"hover",class:"stat-card success"},{default:a(()=>[s("div",$e,i(V.value.approved_count||0),1),t[11]||(t[11]=s("div",{class:"stat-label"},"已通过",-1))]),_:1})]),_:1}),e(S,{span:6},{default:a(()=>[e(g,{shadow:"hover",class:"stat-card danger"},{default:a(()=>[s("div",Ge,i(V.value.rejected_count||0),1),t[12]||(t[12]=s("div",{class:"stat-label"},"已驳回",-1))]),_:1})]),_:1})]),_:1}),e(g,{shadow:"never",class:"mb-4"},{default:a(()=>[e(z,{model:n,inline:""},{default:a(()=>[e(y,{label:"状态"},{default:a(()=>[e(R,{modelValue:n.status,"onUpdate:modelValue":t[0]||(t[0]=l=>n.status=l),placeholder:"请选择",clearable:"",style:{width:"120px"}},{default:a(()=>[e(_,{label:"待处理",value:0}),e(_,{label:"已通过",value:1}),e(_,{label:"已驳回",value:2})]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"申诉类型"},{default:a(()=>[e(R,{modelValue:n.appeal_type,"onUpdate:modelValue":t[1]||(t[1]=l=>n.appeal_type=l),placeholder:"请选择",clearable:"",style:{width:"120px"}},{default:a(()=>[e(_,{label:"恶意差评",value:1}),e(_,{label:"虚假评价",value:2}),e(_,{label:"侵犯隐私",value:3}),e(_,{label:"其他",value:4})]),_:1},8,["modelValue"])]),_:1}),e(y,null,{default:a(()=>[e(w,{type:"primary",onClick:q},{default:a(()=>t[13]||(t[13]=[d("搜索")])),_:1}),e(w,{onClick:H},{default:a(()=>t[14]||(t[14]=[d("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(g,{shadow:"never"},{default:a(()=>[Be((c(),U(Y,{data:L.value},{default:a(()=>[e(f,{label:"申诉ID",width:"80",prop:"id"}),e(f,{label:"被申诉评价","min-width":"200"},{default:a(({row:l})=>{var m,v,h,C,u;return[s("div",Ke,[s("div",Oe,i(((v=(m=l.review)==null?void 0:m.user)==null?void 0:v.nickname)||"匿名"),1),e(F,{"model-value":(h=l.review)==null?void 0:h.score,disabled:"",size:"small"},null,8,["model-value"]),s("div",je,i((u=(C=l.review)==null?void 0:C.content)==null?void 0:u.slice(0,50))+"...",1)])]}),_:1}),e(f,{label:"申诉人",width:"120"},{default:a(({row:l})=>{var m,v;return[d(i(((m=l.appeal_user)==null?void 0:m.nickname)||((v=l.appeal_staff)==null?void 0:v.name)||"-"),1)]}),_:1}),e(f,{label:"申诉类型",width:"100"},{default:a(({row:l})=>[e(T,{type:"warning"},{default:a(()=>[d(i(l.appeal_type_text),1)]),_:2},1024)]),_:1}),e(f,{label:"状态",width:"100"},{default:a(({row:l})=>[e(T,{type:j(l.status)},{default:a(()=>[d(i(l.status_text),1)]),_:2},1032,["type"])]),_:1}),e(f,{label:"申诉时间",width:"160",prop:"create_time_text"}),e(f,{label:"操作",width:"150"},{default:a(({row:l})=>[e(w,{link:"",type:"primary",onClick:m=>J(l)},{default:a(()=>t[15]||(t[15]=[d("详情")])),_:2},1032,["onClick"]),l.status===0?(c(),U(w,{key:0,link:"",type:"success",onClick:m=>Q(l)},{default:a(()=>t[16]||(t[16]=[d(" 处理 ")])),_:2},1032,["onClick"])):E("",!0)]),_:1})]),_:1},8,["data"])),[[oe,P.value]]),s("div",qe,[e(Z,{"current-page":n.page,"onUpdate:currentPage":t[2]||(t[2]=l=>n.page=l),"page-size":n.limit,"onUpdate:pageSize":t[3]||(t[3]=l=>n.limit=l),total:A.value,layout:"total, prev, pager, next",onCurrentChange:x},null,8,["current-page","page-size","total"])])]),_:1}),e(se,{modelValue:b.value,"onUpdate:modelValue":t[8]||(t[8]=l=>b.value=l),title:((G=o.value)==null?void 0:G.status)===0?"处理申诉":"申诉详情",width:"600px"},{footer:a(()=>{var l;return[e(w,{onClick:t[7]||(t[7]=m=>b.value=!1)},{default:a(()=>t[21]||(t[21]=[d("关闭")])),_:1}),((l=o.value)==null?void 0:l.status)===0?(c(),U(w,{key:0,type:"primary",onClick:W},{default:a(()=>t[22]||(t[22]=[d(" 确认处理 ")])),_:1})):E("",!0)]}),default:a(()=>{var l,m,v,h,C;return[o.value?(c(),D("div",He,[e(ee,{column:2,border:""},{default:a(()=>[e(B,{label:"申诉人"},{default:a(()=>{var u,I;return[d(i(((u=o.value.appeal_user)==null?void 0:u.nickname)||((I=o.value.appeal_staff)==null?void 0:I.name)),1)]}),_:1}),e(B,{label:"申诉类型"},{default:a(()=>[e(T,{type:"warning"},{default:a(()=>[d(i(o.value.appeal_type_text),1)]),_:1})]),_:1}),e(B,{label:"申诉原因",span:2},{default:a(()=>[d(i(o.value.appeal_reason),1)]),_:1})]),_:1}),(l=o.value.evidence_images)!=null&&l.length?(c(),D("div",Je,[t[17]||(t[17]=s("div",{class:"label"},"证据图片",-1)),s("div",Qe,[(c(!0),D(Le,null,Ae(o.value.evidence_images,(u,I)=>(c(),U(te,{key:I,src:u,"preview-src-list":o.value.evidence_images,fit:"cover",style:{width:"80px",height:"80px","border-radius":"4px"}},null,8,["src","preview-src-list"]))),128))])])):E("",!0),e(M),s("div",We,[t[18]||(t[18]=s("div",{class:"label"},"原评价内容",-1)),s("div",Xe,[s("div",Ye,i((v=(m=o.value.review)==null?void 0:m.user)==null?void 0:v.nickname),1),e(F,{"model-value":(h=o.value.review)==null?void 0:h.score,disabled:""},null,8,["model-value"]),s("div",Ze,i((C=o.value.review)==null?void 0:C.content),1)])]),o.value.status===0?(c(),D("div",et,[e(M),e(z,{model:r,"label-width":"80px"},{default:a(()=>[e(y,{label:"处理结果"},{default:a(()=>[e(ae,{modelValue:r.status,"onUpdate:modelValue":t[4]||(t[4]=u=>r.status=u)},{default:a(()=>[e($,{label:1},{default:a(()=>t[19]||(t[19]=[d("通过申诉")])),_:1}),e($,{label:2},{default:a(()=>t[20]||(t[20]=[d("驳回申诉")])),_:1})]),_:1},8,["modelValue"])]),_:1}),r.status===1?(c(),U(y,{key:0,label:"处理动作"},{default:a(()=>[e(R,{modelValue:r.handle_action,"onUpdate:modelValue":t[5]||(t[5]=u=>r.handle_action=u)},{default:a(()=>[e(_,{label:"无操作",value:0}),e(_,{label:"删除评价",value:1}),e(_,{label:"隐藏评价",value:2}),e(_,{label:"警告用户",value:3})]),_:1},8,["modelValue"])]),_:1})):E("",!0),e(y,{label:"处理说明"},{default:a(()=>[e(le,{modelValue:r.handle_result,"onUpdate:modelValue":t[6]||(t[6]=u=>r.handle_result=u),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])):E("",!0)])):E("",!0)]}),_:1},8,["modelValue","title"])])}}}),Lt=Ne(tt,[["__scopeId","data-v-b7a627b2"]]);export{Lt as default};

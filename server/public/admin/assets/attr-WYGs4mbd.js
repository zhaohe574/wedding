import{H as q,B as Q,C as W,h as X,g as Y,T as Z,U as tt,v as et,J as at,K as ot,i as lt,D as st}from"./element-plus-ChK2e5qA.js";import{b as nt,d as it}from"./index-D465kfFn.js";import{_ as rt}from"./picker-mSew3b7I.js";import{I as dt}from"./@element-plus-C4Lf8veM.js";import{D as mt}from"./vuedraggable-RHgmLr3o.js";import{s as ut,a as I}from"./staff-C0LmdmFi.js";import{d as pt,b as ct,r as A,l as ft,c as p,o as r,U as l,L as i,a as s,K as f,P as _,u as n,R as w,S as v,T as R,ab as N,i as _t}from"./@vue-ygbFPFRc.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";import"./index-n-Jqn6Y-.js";import"./index.vue_vue_type_script_setup_true_lang-CCtv5BMP.js";import"./article-Be81dFL2.js";import"./usePaging-B2jDzebD.js";import"./vue-CQyKTslw.js";import"./sortablejs-BvvSZPRv.js";const vt={key:0,class:"mt-2 text-xs text-gray-500"},yt={class:"staff-list"},xt={class:"staff-item mb-4 p-4 bg-gray-50 rounded-lg"},bt={class:"flex items-start"},gt={class:"drag-handle cursor-move mr-3 mt-2"},ht={class:"mr-4 flex-shrink-0"},wt={class:"w-[80px] h-[80px] rounded-full overflow-hidden bg-gray-200 flex items-center justify-center"},Vt={class:"flex-1 min-w-0"},kt={class:"flex items-center gap-2 flex-wrap mb-2"},At={class:"font-medium text-gray-900"},Et={key:0,class:"px-2 py-0.5 bg-primary/10 rounded text-xs text-primary"},Ut={key:0,class:"text-xs text-gray-500 mb-2"},Ct={key:0},Dt={class:"ml-4 flex flex-col gap-2 flex-shrink-0"},$t={class:"mt-2"},Bt=pt({__name:"attr",props:{content:{type:Object,default:()=>({})},styles:{type:Object,default:()=>({})}},emits:["update:content"],setup(O,{emit:j}){const V=j,y=O,a=ct({get:()=>y.content,set:o=>{V("update:content",o)}});function F(){var o;Array.isArray((o=y.content)==null?void 0:o.data)||V("update:content",{...y.content,data:[]})}const x=A([]),b=A(""),g=A(!1);ft(()=>{F(),T()});async function T(){try{const o=await ut({});x.value=Array.isArray(o)?o:(o==null?void 0:o.lists)??(o==null?void 0:o.data)??[]}catch(o){console.error("加载服务人员列表失败",o),x.value=[]}}function E(o,t){return{staff_id:o.id,is_show:t??"1",sort:0}}async function z(o,t){if(t){g.value=!0;try{const d=await I({id:t});if(!d||!d.id)return;const u=Array.isArray(a.value.data)?[...a.value.data]:[],c=u[o];u[o]={...E(d,(c==null?void 0:c.is_show)??"1")},a.value={...a.value,data:u}}catch(d){console.error("获取人员详情失败",d)}finally{g.value=!1}}}async function K(o){if(o){g.value=!0,b.value="";try{const t=await I({id:o});if(!t||!t.id)return;const d=Array.isArray(a.value.data)?[...a.value.data]:[];d.push(E(t)),a.value={...a.value,data:d}}catch(t){console.error("获取人员详情失败",t)}finally{g.value=!1}}}function L(o){const t=Array.isArray(a.value.data)?[...a.value.data]:[];t.splice(o,1),a.value={...a.value,data:t}}return(o,t)=>{const d=W,u=Q,c=X,U=Y,G=rt,k=q,C=tt,H=Z,D=nt,J=et,$=ot,B=at,M=lt,P=st;return r(),p("div",null,[l(P,{"label-width":"80px"},{default:i(()=>[l(k,{shadow:"never",class:"!border-none flex mt-2"},{default:i(()=>[t[7]||(t[7]=s("div",{class:"flex items-end mb-4"},[s("div",{class:"text-base text-[#101010] font-medium"},"基础设置")],-1)),l(u,{label:"组件标题"},{default:i(()=>[l(d,{modelValue:n(a).title,"onUpdate:modelValue":t[0]||(t[0]=e=>n(a).title=e),placeholder:"请输入标题",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(u,{label:"显示数量"},{default:i(()=>[l(c,{modelValue:n(a).show_count,"onUpdate:modelValue":t[1]||(t[1]=e=>n(a).show_count=e),min:1,max:20,style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(u,{label:"查看更多"},{default:i(()=>[l(U,{modelValue:n(a).show_more,"onUpdate:modelValue":t[2]||(t[2]=e=>n(a).show_more=e),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),n(a).show_more?(r(),f(u,{key:0,label:"更多链接"},{default:i(()=>[l(G,{modelValue:n(a).more_link,"onUpdate:modelValue":t[3]||(t[3]=e=>n(a).more_link=e)},null,8,["modelValue"])]),_:1})):_("",!0)]),_:1}),l(k,{shadow:"never",class:"!border-none flex mt-2"},{default:i(()=>[t[10]||(t[10]=s("div",{class:"flex items-end mb-4"},[s("div",{class:"text-base text-[#101010] font-medium"},"展示样式")],-1)),l(H,{modelValue:n(a).style,"onUpdate:modelValue":t[4]||(t[4]=e=>n(a).style=e)},{default:i(()=>[l(C,{value:1},{default:i(()=>t[8]||(t[8]=[w("横向滑动卡片")])),_:1}),l(C,{value:2},{default:i(()=>t[9]||(t[9]=[w("列表样式")])),_:1})]),_:1},8,["modelValue"]),n(a).style==1?(r(),p("div",vt," 卡片将以横向滑动方式展示，用户可左右滑动查看更多人员 ")):_("",!0)]),_:1}),l(k,{shadow:"never",class:"!border-none flex mt-2"},{default:i(()=>[t[13]||(t[13]=s("div",{class:"flex items-end mb-4"},[s("div",{class:"text-base text-[#101010] font-medium"},"人员列表"),s("div",{class:"text-xs text-tx-secondary ml-2"},"从已存在的服务人员中选择，无需手动录入")],-1)),s("div",yt,[l(n(mt),{"model-value":Array.isArray(n(a).data)?n(a).data:[],"onUpdate:modelValue":t[5]||(t[5]=e=>V("update:content",{...y.content,data:e})),"item-key":(e,h)=>e&&e.staff_id?e.staff_id:"i"+h,animation:"300",handle:".drag-handle"},{item:i(({element:e,index:h})=>{var S;return[s("div",xt,[s("div",bt,[s("div",gt,[l(D,{name:"el-icon-Rank",size:18,color:"#999"})]),s("div",ht,[s("div",wt,[e.avatar?(r(),f(J,{key:0,src:e.avatar,fit:"cover",class:"w-full h-full"},null,8,["src"])):(r(),f(D,{key:1,name:"el-icon-User",size:28,color:"#999"}))])]),s("div",Vt,[s("div",kt,[s("span",At,v(e.name||"未选择"),1),e.role?(r(),p("span",Et,v(e.role),1)):_("",!0)]),e.name?(r(),p("div",Ut,[w(" ★ "+v(e.rating||"5.0")+" · 已服务"+v(e.order_count??0)+"单 ",1),(S=e.tags)!=null&&S.length?(r(),p("span",Ct," · "+v(e.tags.slice(0,3).join("、")),1)):_("",!0)])):_("",!0),l(u,{label:"更换人员",class:"!mb-0","label-width":"80px"},{default:i(()=>[l(B,{"model-value":e.staff_id||"",placeholder:"选择服务人员",filterable:"",clearable:"",style:{width:"220px"},onChange:m=>z(h,m)},{default:i(()=>[(r(!0),p(R,null,N(n(x),m=>(r(),f($,{key:m.id,label:`${m.name}${m.sn?`（${m.sn}）`:""}`,value:m.id},null,8,["label","value"]))),128))]),_:2},1032,["model-value","onChange"])]),_:2},1024)]),s("div",Dt,[l(U,{modelValue:e.is_show,"onUpdate:modelValue":m=>e.is_show=m,"active-value":"1","inactive-value":"0","active-text":"显示"},null,8,["modelValue","onUpdate:modelValue"]),l(M,{type:"danger",text:"",icon:n(dt),onClick:m=>L(h)},{default:i(()=>t[11]||(t[11]=[w(" 删除 ")])),_:2},1032,["icon","onClick"])])])])]}),_:1},8,["model-value","item-key"]),s("div",$t,[t[12]||(t[12]=s("span",{class:"text-sm text-gray-500 mr-2"},"添加人员：",-1)),l(B,{modelValue:n(b),"onUpdate:modelValue":t[6]||(t[6]=e=>_t(b)?b.value=e:null),placeholder:"请选择要推荐的服务人员",filterable:"",clearable:"",style:{width:"280px"},onChange:K},{default:i(()=>[(r(!0),p(R,null,N(n(x),e=>(r(),f($,{key:e.id,label:`${e.name}${e.sn?`（${e.sn}）`:""}`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),_:1})]),_:1})])}}}),xe=it(Bt,[["__scopeId","data-v-38a1333b"]]);export{xe as default};

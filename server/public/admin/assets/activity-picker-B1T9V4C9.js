import{C as j,i as F,a8 as M,F as R,v as G,N as O,a6 as Z,P as q,R as H,E as J}from"./element-plus-ChK2e5qA.js";import{b as Q,d as W}from"./index-D465kfFn.js";import{d as X,r as m,a0 as Y,K as d,o as i,L as a,a as o,U as n,a9 as ee,u as te,P as v,c as g,T as E,ab as V,Z as oe,S as c,R as u}from"./@vue-ygbFPFRc.js";import{T as se}from"./@element-plus-C4Lf8veM.js";import{g as ae}from"./decoration-gfwwbLJf.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";const le={class:"activity-picker"},ie={class:"mb-4"},ne={class:"activity-list max-h-[500px] overflow-y-auto"},re=["onClick"],ce={class:"flex-shrink-0 mr-3"},pe={class:"w-20 h-20 flex items-center justify-center bg-gray-100 rounded"},me={class:"flex-1 min-w-0"},de={class:"flex items-center mb-1"},ue={class:"text-sm font-medium text-gray-900 truncate"},_e={class:"text-xs text-gray-500 mb-1 line-clamp-2"},ve={class:"flex items-center text-xs text-gray-400"},ge={class:"mr-3"},fe={class:"mr-3"},ye={key:0,class:"mt-1"},xe={class:"mt-4 flex justify-center"},ke={class:"dialog-footer"},he=X({__name:"activity-picker",emits:["confirm"],setup(be,{expose:w,emit:z}){const P=z,p=m(!1),f=m(!1),y=m(""),x=m([]),r=m([]),l=Y({page:1,limit:10,total:0}),S=(s=[])=>{p.value=!0,r.value=[...s],_()},_=async()=>{try{f.value=!0;const s=await ae({page:l.page,limit:l.limit,title:y.value});x.value=s.data||[],l.total=s.total||0}catch(s){console.error("获取活动列表失败:",s),J.error("获取活动列表失败")}finally{f.value=!1}},k=()=>{l.page=1,_()},U=s=>{const t=r.value.indexOf(s);t>-1?r.value.splice(t,1):r.value.push(s)},B=()=>{P("confirm",r.value),p.value=!1};return w({open:S}),(s,t)=>{const h=F,L=j,N=R,T=Q,I=G,b=O,A=M,D=Z,K=q,$=H;return i(),d($,{modelValue:p.value,"onUpdate:modelValue":t[6]||(t[6]=e=>p.value=e),title:"选择活动",width:"800px","close-on-click-modal":!1},{footer:a(()=>[o("span",ke,[n(h,{onClick:t[5]||(t[5]=e=>p.value=!1)},{default:a(()=>t[9]||(t[9]=[u("取消")])),_:1}),n(h,{type:"primary",onClick:B},{default:a(()=>[u(" 确定（已选 "+c(r.value.length)+" 个） ",1)]),_:1})])]),default:a(()=>[o("div",le,[o("div",ie,[n(L,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e),placeholder:"搜索活动标题",clearable:"",onClear:k,onKeyup:ee(k,["enter"])},{append:a(()=>[n(h,{icon:te(se),onClick:k},null,8,["icon"])]),_:1},8,["modelValue"])]),o("div",ne,[n(A,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e)},{default:a(()=>[(i(!0),g(E,null,V(x.value,e=>(i(),g("div",{key:e.id,class:"activity-item flex items-start p-3 mb-2 border border-gray-200 rounded-lg hover:border-primary cursor-pointer",onClick:C=>U(e.id)},[n(N,{value:e.id,class:"mr-3",onClick:t[1]||(t[1]=oe(()=>{},["stop"]))},null,8,["value"]),o("div",ce,[n(I,{src:e.cover_image,fit:"cover",class:"w-20 h-20 rounded"},{error:a(()=>[o("div",pe,[n(T,{name:"el-icon-Picture",size:30,color:"#ccc"})])]),_:2},1032,["src"])]),o("div",me,[o("div",de,[o("span",ue,c(e.title),1),e.is_top?(i(),d(b,{key:0,type:"danger",size:"small",class:"ml-2"},{default:a(()=>t[7]||(t[7]=[u("置顶")])),_:1})):v("",!0),e.is_hot?(i(),d(b,{key:1,type:"warning",size:"small",class:"ml-2"},{default:a(()=>t[8]||(t[8]=[u("热门")])),_:1})):v("",!0)]),o("div",_e,c(e.content_preview),1),o("div",ve,[o("span",ge,"浏览 "+c(e.view_count),1),o("span",fe,"点赞 "+c(e.like_count),1),o("span",null,c(e.create_time_text),1)]),e.tags_arr.length?(i(),g("div",ye,[(i(!0),g(E,null,V(e.tags_arr.slice(0,3),C=>(i(),d(b,{key:C,size:"small",class:"mr-1"},{default:a(()=>[u(c(C),1)]),_:2},1024))),128))])):v("",!0)])],8,re))),128))]),_:1},8,["modelValue"]),!x.value.length&&!f.value?(i(),d(D,{key:0,description:"暂无活动数据"})):v("",!0)]),o("div",xe,[n(K,{"current-page":l.page,"onUpdate:currentPage":t[3]||(t[3]=e=>l.page=e),"page-size":l.limit,"onUpdate:pageSize":t[4]||(t[4]=e=>l.limit=e),total:l.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",onCurrentChange:_,onSizeChange:_},null,8,["current-page","page-size","total"])])])]),_:1},8,["modelValue"])}}}),tt=W(he,[["__scopeId","data-v-6f736266"]]);export{tt as default};

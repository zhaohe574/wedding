import{a0 as xl,H as Sl,D as El,m as Nl,l as ql,B as Bl,C as Tl,J as hl,K as Dl,N as $l,i as Al,ae as Rl,h as Il,T as Ol,U as Fl,a8 as Ll,F as zl,L as jl,M as Ml,g as Gl,Y as Jl,v as Hl,d as Kl,R as Wl,$ as Xl,W as Yl,X as Ql,E as c}from"./element-plus-ChK2e5qA.js";import{_ as Zl}from"./index-B-cygYOY.js";import{_ as et}from"./picker-COC_GcuI.js";import{a as lt,b as tt,c as at,d as ot,e as it,f as st,g as nt,h as rt,i as dt,j as ut,k as pt,l as mt,m as _t,n as ct,o as ft}from"./staff-C0LmdmFi.js";import{b as gt,g as yt}from"./consumer-BeFFkFD9.js";import{u as bt,p as kt,n as vt}from"./service-CD4Egw8G.js";import{u as Vt}from"./useDictOptions-DB6N0EUo.js";import{e as wt,f as Ue}from"./index-D465kfFn.js";import{a6 as Ut}from"./@element-plus-C4Lf8veM.js";import{u as Ct,a as Pt}from"./vue-router-Cg6aTb_d.js";import{d as Le,s as Ce,r as C,a0 as D,b as xt,w as Pe,c as b,o as _,U as t,L as o,u as i,i as G,a as B,T as $,ab as A,K as w,P as T,S as P,R as n}from"./@vue-ygbFPFRc.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./index-n-Jqn6Y-.js";import"./index-dAc1fhtT.js";import"./index.vue_vue_type_script_setup_true_lang-CCtv5BMP.js";import"./index-DlQH-CEM.js";import"./index-DFyja3d3.js";import"./index.vue_vue_type_script_setup_true_lang-T0yi5BSL.js";import"./@vueuse-yz9uDhpq.js";import"./usePaging-B2jDzebD.js";import"./vuedraggable-RHgmLr3o.js";import"./vue-CQyKTslw.js";import"./sortablejs-BvvSZPRv.js";import"./nprogress-UhqZPtFR.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";const St={class:"staff-edit"},Et={class:"grid grid-cols-2 gap-x-10"},Nt={class:"flex items-center gap-2"},qt={key:0},Bt={key:1,class:"text-gray-400"},Tt={class:"text-gray-500 mb-2"},ht={key:1,class:"text-gray-500"},Dt={key:1,class:"text-gray-500"},$t={key:0},At={key:1,class:"text-gray-400"},Rt={key:0,class:"text-gray-500"},It={key:1},Ot={class:"grid grid-cols-2 gap-x-10 mb-6"},Ft={key:1,class:"relative"},Lt={key:0},zt={key:1,class:"text-gray-400"},jt={class:"slot-price-list"},Mt={class:"w-16"},Gt={class:"w-full"},Jt={class:"w-16"},Ht={class:"space-y-3"},Kt=Le({name:"staffListsEdit"}),ja=Le({...Kt,setup(Wt){const k=Ct(),ie=Pt(),{removeTab:se}=wt(),xe=Ce(),Se=Ce(),Ee=Ce(),ne=C("basic"),F=C(!1),L=C(!1),R=C(!1),I=C(!1),J=C(!1),re=C(!1),z=C(!1),H=C(!1),de=C([]),X=C({}),Ne=C([]),Y=C([]),qe=C(-1),ue=C([]),O=C([]),pe=C(!1);let me;const S=D({account:"",disable:0}),Q=D({account:"",password:""}),u=D({id:"",user_id:0,name:"",avatar:"",mobile:"",category_id:"",price:0,experience_years:0,profile:"",service_desc:"",sort:0,is_recommend:0,status:1,tag_ids:[],packages:[]}),Be=(l,e=!1)=>{!(l!=null&&l.admin_account)||!(l!=null&&l.admin_password)||(Q.account=l.admin_account,Q.password=l.admin_password,J.value=!0,re.value=e)},Te=()=>{J.value=!1,re.value&&(re.value=!1,se(),ie.back())},ze=(l,e,s)=>{if(k.query.id){s();return}const d=Number(e);if(!d||d<=0){s(new Error("请选择系统用户"));return}s()},he=l=>{const e=l.nickname||l.account||`用户${l.id}`,s=l.mobile||l.account||"-";return`${e}（${s} / ID:${l.id}）`},je=l=>l.filter(e=>e&&e.id).map(e=>({id:e.id,label:he(e),raw:e})),Me=l=>{l!=null&&l.id&&(O.value.some(e=>e.id===l.id)||O.value.unshift({id:l.id,label:he(l),raw:l}))},Ge=async l=>{var s;const e=l.trim();if(!e){O.value=[];return}pe.value=!0;try{const d=await gt({keyword:e,page_no:1,page_size:20}),f=(d==null?void 0:d.lists)??((s=d==null?void 0:d.data)==null?void 0:s.lists)??(d==null?void 0:d.data)??d??[];O.value=Array.isArray(f)?je(f):[]}catch{O.value=[]}finally{pe.value=!1}},Je=l=>{me&&window.clearTimeout(me);const e=l.trim();if(!e){O.value=[];return}me=window.setTimeout(()=>{Ge(e)},300)},He=async()=>{const l=Number(u.user_id);if(l)try{const e=await yt({id:l}),s=(e==null?void 0:e.data)??e;Me(s)}catch{}},r=D({id:0,name:"",category_id:"",price:0,original_price:0,description:"",slot_prices:[],booking_type:0,allowed_time_slots:[]}),v=D({banner_mode:1,banner_small_height:400,banner_large_height:600,banner_indicator_style:1,banner_autoplay:1,banner_interval:3e3}),V=D({id:0,type:1,file_url:"",cover_url:"",is_autoplay:0}),Ke=D({user_id:[{validator:ze,trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],category_id:[{required:!0,message:"请选择服务分类",trigger:"change"}],price:[{required:!0,message:"请输入服务价格",trigger:"blur"}]}),We=D({name:[{required:!0,message:"请输入套餐名称",trigger:"blur"}],category_id:[{required:!0,message:"请选择所属分类",trigger:"change"}],price:[{required:!0,message:"请输入套餐价格",trigger:"blur"}],booking_type:[{required:!0,message:"请选择预约类型",trigger:"change"}]}),Xe=D({type:[{required:!0,message:"请选择类型",trigger:"change"}],file_url:[{required:!0,message:"请上传文件",trigger:"change"}],cover_url:[{validator:(l,e,s)=>{V.type===2&&!e?s(new Error("视频需要上传封面图")):s()},trigger:"change"}]}),h=[{value:1,label:"早礼"},{value:2,label:"午宴"},{value:3,label:"晚宴"}],_e={1:"早礼",2:"午宴",3:"晚宴"},Ye={1:"风格",2:"特长",3:"其他"},j=l=>{if(Array.isArray(l))return l.map(e=>Number(e)).filter(e=>!Number.isNaN(e));if(typeof l=="string"&&l)try{const e=JSON.parse(l);if(Array.isArray(e))return e.map(s=>Number(s)).filter(s=>!Number.isNaN(s))}catch{return[]}return[]},Z=l=>{if(Array.isArray(l))return l;if(typeof l=="string"&&l)try{const e=JSON.parse(l);if(Array.isArray(e))return e}catch{return[]}return[]},Qe=l=>{if(l.booking_type!==1)return[];const e=j(l.allowed_time_slots);return e.length?e:h.map(s=>s.value)},De=(l,e)=>l.map(s=>{const d=e.find(f=>Number(f.time_slot)===s);return{time_slot:s,price:(d==null?void 0:d.price)??null}}),ce=l=>l.filter(e=>e.price!==null&&e.price!==void 0&&e.price!=="").map(e=>({time_slot:Number(e.time_slot),price:Number(e.price)})),ee=()=>{if(r.booking_type!==1){r.slot_prices=[];return}const l=r.allowed_time_slots.length?r.allowed_time_slots:h.map(s=>s.value),e=Z(r.slot_prices);r.slot_prices=De(l,e)},le=()=>{Object.assign(r,{id:0,name:"",category_id:"",price:0,original_price:0,description:"",slot_prices:[],booking_type:0,allowed_time_slots:[]}),z.value=!1},{optionsData:fe}=Vt({categories:{api:vt},packages:{api:()=>kt({global_only:1})}}),Ze=xt(()=>{var e;const l=u.packages.map(s=>s.package_id);return((e=fe.packages)==null?void 0:e.filter(s=>!l.includes(s.id)))||[]}),el=l=>{const e=new Set;Object.values(l).forEach(s=>{s.forEach(d=>{d!=null&&d.id&&e.add(Number(d.id))})}),u.tag_ids.length&&(u.tag_ids=u.tag_ids.filter(s=>e.has(Number(s))))},$e=async()=>{const l=Number(u.category_id);if(!l){X.value={},u.tag_ids=[];return}const e=await bt({group_by_type:1,category_id:l});X.value=e||{},el(X.value)},te=async()=>{if(k.query.id)try{const l=await ft({staff_id:k.query.id});Y.value=l||[]}catch(l){console.error("获取轮播图列表失败",l)}},ll=l=>{l.banner_mode!==void 0&&(v.banner_mode=l.banner_mode),l.banner_small_height!==void 0&&(v.banner_small_height=l.banner_small_height),l.banner_large_height!==void 0&&(v.banner_large_height=l.banner_large_height),l.banner_indicator_style!==void 0&&(v.banner_indicator_style=l.banner_indicator_style),l.banner_autoplay!==void 0&&(v.banner_autoplay=l.banner_autoplay),l.banner_interval!==void 0&&(v.banner_interval=l.banner_interval)},tl=async()=>{const l=await lt({id:k.query.id});Object.keys(u).forEach(e=>{l[e]!==void 0&&(u[e]=l[e])}),S.account=l.admin_account||"",S.disable=Number(l.admin_disable||0),await He(),await $e(),l.packages&&(u.packages=l.packages.map(e=>{var f,m,E,M,N;const s=e.booking_type??((f=e.package)==null?void 0:f.booking_type)??0;let d=j(e.allowed_time_slots??((m=e.package)==null?void 0:m.allowed_time_slots));return s===1&&d.length===0&&(d=h.map(g=>g.value)),{package_id:e.package_id,package_name:((E=e.package)==null?void 0:E.name)||"",price:e.price??((M=e.package)==null?void 0:M.price)??0,original_price:e.original_price??((N=e.package)==null?void 0:N.original_price)??null,custom_price:e.custom_price,custom_slot_prices:e.custom_slot_prices||[],booking_type:s,allowed_time_slots:d,status:e.status??1,is_new:!1}})),await ge(),ll(l),await te()},ge=async()=>{if(k.query.id)try{const l=await tt({staff_id:k.query.id,include_global:!1});Ne.value=l.staff_packages||[]}catch(l){console.error("获取专属套餐失败",l)}},al=l=>{de.value=l},ol=()=>{de.value.forEach(l=>{const e=l.booking_type??0;let s=j(l.allowed_time_slots);e===1&&s.length===0&&(s=h.map(d=>d.value)),u.packages.push({package_id:l.id,package_name:l.name,price:l.price||0,original_price:l.original_price||null,custom_price:null,custom_slot_prices:[],booking_type:e,allowed_time_slots:s,status:1,is_new:!0})}),F.value=!1,de.value=[]},il=l=>{u.packages.splice(l,1)},sl=async l=>{if(!k.query.id){c.error("请先保存人员基本信息");return}if(l.is_new){c.warning("新关联套餐请先点击页面底部保存");return}const e=l.booking_type===1?j(l.allowed_time_slots):[];if(l.booking_type===1&&e.length===0){c.error("请选择允许场次");return}const s=l.booking_type===1?ce(Z(l.custom_slot_prices)):[];for(const d of s)if(Number.isNaN(d.price)||d.price<0){c.error("价格不能为负数");return}try{await at({staff_id:k.query.id,package_id:l.package_id,price:l.price,original_price:l.original_price,custom_price:l.custom_price,custom_slot_prices:s,booking_type:l.booking_type??0,allowed_time_slots:e,status:l.status??1}),l.is_new=!1,c.success("保存成功")}catch(d){c.error(d.message||"保存失败")}},nl=l=>{const e=u.packages[l];if(e.booking_type!==1){c.warning("全天套餐无需配置场次价格");return}qe.value=l;const s=Qe(e),d=Z(e.custom_slot_prices);ue.value=De(s,d),L.value=!0},rl=()=>{const l=ce(ue.value);for(const e of l)if(Number.isNaN(e.price)||e.price<0){c.error("价格不能为负数");return}u.packages[qe.value].custom_slot_prices=l,L.value=!1},dl=l=>{if(l.booking_type===0){l.allowed_time_slots=[],l.custom_slot_prices=[];return}(!l.allowed_time_slots||l.allowed_time_slots.length===0)&&(l.allowed_time_slots=h.map(e=>e.value))},ul=()=>{le(),R.value=!0},pl=l=>{le(),z.value=!0,r.id=l.id,r.name=l.name||"",r.category_id=l.category_id||"",r.price=l.price||0,r.original_price=l.original_price||0,r.description=l.description||"",r.booking_type=l.booking_type??0,r.allowed_time_slots=j(l.allowed_time_slots),r.slot_prices=Z(l.slot_prices),r.booking_type===1&&r.allowed_time_slots.length===0&&(r.allowed_time_slots=h.map(e=>e.value)),ee(),R.value=!0},ml=async l=>{if(!k.query.id){c.error("请先保存人员基本信息");return}await Ue.confirm(`确定要删除专属套餐「${l.name||""}」吗？`);try{await ot({staff_id:k.query.id,package_id:l.id}),c.success("删除成功"),await ge()}catch(e){c.error(e.message||"删除失败")}},_l=async()=>{var e;if(await((e=Se.value)==null?void 0:e.validate()),!k.query.id){c.error("请先保存人员基本信息");return}if(r.booking_type===1&&r.allowed_time_slots.length===0){c.error("请选择允许场次");return}r.booking_type===0&&(r.allowed_time_slots=[]);const l=r.booking_type===1?ce(r.slot_prices):[];for(const s of l)if(Number.isNaN(s.price)||s.price<0){c.error("价格不能为负数");return}try{const s={staff_id:k.query.id,...r,slot_prices:l};z.value?(await it({...s,package_id:r.id}),c.success("更新成功")):(await st(s),c.success("创建成功")),R.value=!1,le(),await ge()}catch(s){c.error(s.message||(z.value?"更新失败":"创建失败"))}},cl=async()=>{var d;if(await((d=xe.value)==null?void 0:d.validate()),u.packages.find(f=>f.booking_type===1&&(!f.allowed_time_slots||f.allowed_time_slots.length===0))){c.error("请选择允许场次");return}const e={...u,packages:u.packages.map(f=>({package_id:f.package_id,price:f.price,original_price:f.original_price,custom_price:f.custom_price,custom_slot_prices:f.custom_slot_prices||[],booking_type:f.booking_type??0,allowed_time_slots:f.booking_type===1?f.allowed_time_slots||[]:[],status:f.status??1}))};if(k.query.id){await nt(e),se(),ie.back();return}const s=await rt(e);if(s!=null&&s.admin_account&&(s!=null&&s.admin_password)){S.account=s.admin_account,S.disable=0,Be(s,!0);return}se(),ie.back()},fl=async()=>{if(!k.query.id){c.error("请先保存人员基本信息");return}await Ue.confirm("确定要重置后台账号密码？");const l=await dt({id:k.query.id});l!=null&&l.admin_account&&(l!=null&&l.admin_password)&&(S.account=l.admin_account,S.disable=0,Be(l))};k.query.id&&tl(),Pe(()=>r.booking_type,l=>{if(l===0){r.allowed_time_slots=[],ee();return}(!r.allowed_time_slots||r.allowed_time_slots.length===0)&&(r.allowed_time_slots=h.map(e=>e.value)),ee()}),Pe(()=>r.allowed_time_slots,()=>{r.booking_type===1&&ee()},{deep:!0}),Pe(()=>u.category_id,()=>{$e()});const gl=()=>{if(!k.query.id){c.error("请先保存人员基本信息");return}ye(),I.value=!0},yl=l=>{ye(),H.value=!0,V.id=l.id,V.type=l.type,V.file_url=l.file_url,V.cover_url=l.cover_url||"",V.is_autoplay=l.is_autoplay||0,I.value=!0},ye=()=>{Object.assign(V,{id:0,type:1,file_url:"",cover_url:"",is_autoplay:0}),H.value=!1},bl=async()=>{var l;if(await((l=Ee.value)==null?void 0:l.validate()),!k.query.id){c.error("请先保存人员基本信息");return}try{const e={...V,staff_id:k.query.id};H.value?(await ut(e),c.success("编辑成功")):(await pt(e),c.success("添加成功")),I.value=!1,await te()}catch(e){c.error(e.message||(H.value?"编辑失败":"添加失败"))}},kl=async l=>{await Ue.confirm("确定要删除该轮播图吗？");try{await mt({id:l.id}),c.success("删除成功"),await te()}catch(e){c.error(e.message||"删除失败")}},Ae=async(l,e)=>{const s=[...Y.value],d=e==="up"?l-1:l+1;if(d<0||d>=s.length)return;[s[l],s[d]]=[s[d],s[l]];const f=s.map((m,E)=>({id:m.id,sort:E}));try{await _t({staff_id:k.query.id,sort_data:f}),c.success("排序成功"),await te()}catch(m){c.error(m.message||"排序失败")}},vl=async()=>{if(!k.query.id){c.error("请先保存人员基本信息");return}try{await ct({staff_id:k.query.id,...v}),c.success("配置保存成功")}catch(l){c.error(l.message||"配置保存失败")}};return(l,e)=>{const s=xl,d=Sl,f=Tl,m=Bl,E=Dl,M=hl,N=$l,g=Al,be=et,Re=Rl,x=Il,q=Fl,K=Ol,ae=ql,ke=zl,ve=Ll,y=Ml,Ve=Gl,oe=jl,Ie=Jl,Oe=Hl,Vl=Kl,wl=Nl,we=El,Ul=Zl,W=Wl,Cl=Xl,Fe=Ql,Pl=Yl;return _(),b("div",St,[t(d,{class:"!border-none",shadow:"never"},{default:o(()=>[t(s,{content:l.$route.query.id?"编辑人员":"新增人员",onBack:e[0]||(e[0]=a=>l.$router.back())},null,8,["content"])]),_:1}),t(d,{class:"mt-4 !border-none",shadow:"never"},{default:o(()=>[t(we,{ref_key:"formRef",ref:xe,class:"ls-form",model:i(u),"label-width":"100px",rules:i(Ke)},{default:o(()=>[t(wl,{modelValue:i(ne),"onUpdate:modelValue":e[21]||(e[21]=a=>G(ne)?ne.value=a:null)},{default:o(()=>[t(ae,{label:"基本信息",name:"basic"},{default:o(()=>[B("div",Et,[t(m,{label:"姓名",prop:"name"},{default:o(()=>[t(f,{modelValue:i(u).name,"onUpdate:modelValue":e[1]||(e[1]=a=>i(u).name=a),placeholder:"请输入姓名",maxlength:"50"},null,8,["modelValue"])]),_:1}),t(m,{label:"绑定用户",prop:"user_id"},{default:o(()=>[t(M,{modelValue:i(u).user_id,"onUpdate:modelValue":e[2]||(e[2]=a=>i(u).user_id=a),filterable:"",remote:"","reserve-keyword":"","remote-method":Je,loading:i(pe),placeholder:"输入昵称/账号/手机号搜索",class:"w-full"},{default:o(()=>[(_(!0),b($,null,A(i(O),a=>(_(),w(E,{key:a.id,label:a.label,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),t(m,{label:"手机号",prop:"mobile"},{default:o(()=>[t(f,{modelValue:i(u).mobile,"onUpdate:modelValue":e[3]||(e[3]=a=>i(u).mobile=a),placeholder:"请输入手机号",maxlength:"11"},null,8,["modelValue"])]),_:1}),t(m,{label:"后台账号"},{default:o(()=>[B("div",Nt,[i(S).account?(_(),b("span",qt,P(i(S).account),1)):(_(),b("span",Bt,"保存后自动生成")),i(S).account?(_(),w(N,{key:2,type:i(S).disable?"danger":"success"},{default:o(()=>[n(P(i(S).disable?"禁用":"启用"),1)]),_:1},8,["type"])):T("",!0),i(S).account?(_(),w(g,{key:3,type:"primary",link:"",onClick:fl},{default:o(()=>e[42]||(e[42]=[n(" 重置密码 ")])),_:1})):T("",!0)])]),_:1}),t(m,{label:"头像",prop:"avatar"},{default:o(()=>[t(be,{modelValue:i(u).avatar,"onUpdate:modelValue":e[4]||(e[4]=a=>i(u).avatar=a),limit:1},null,8,["modelValue"])]),_:1}),t(m,{label:"服务分类",prop:"category_id"},{default:o(()=>[t(Re,{modelValue:i(u).category_id,"onUpdate:modelValue":e[5]||(e[5]=a=>i(u).category_id=a),options:i(fe).categories,props:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},placeholder:"选择服务分类",class:"w-full"},null,8,["modelValue","options"])]),_:1}),t(m,{label:"服务价格",prop:"price"},{default:o(()=>[t(x,{modelValue:i(u).price,"onUpdate:modelValue":e[6]||(e[6]=a=>i(u).price=a),min:0,precision:2,class:"w-full"},null,8,["modelValue"])]),_:1}),t(m,{label:"从业年限",prop:"experience_years"},{default:o(()=>[t(x,{modelValue:i(u).experience_years,"onUpdate:modelValue":e[7]||(e[7]=a=>i(u).experience_years=a),min:0,max:50,class:"w-full"},null,8,["modelValue"])]),_:1}),t(m,{label:"排序",prop:"sort"},{default:o(()=>[t(x,{modelValue:i(u).sort,"onUpdate:modelValue":e[8]||(e[8]=a=>i(u).sort=a),min:0,max:9999,class:"w-full"},null,8,["modelValue"])]),_:1}),t(m,{label:"是否推荐",prop:"is_recommend"},{default:o(()=>[t(K,{modelValue:i(u).is_recommend,"onUpdate:modelValue":e[9]||(e[9]=a=>i(u).is_recommend=a)},{default:o(()=>[t(q,{value:1},{default:o(()=>e[43]||(e[43]=[n("是")])),_:1}),t(q,{value:0},{default:o(()=>e[44]||(e[44]=[n("否")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"状态",prop:"status"},{default:o(()=>[t(K,{modelValue:i(u).status,"onUpdate:modelValue":e[10]||(e[10]=a=>i(u).status=a)},{default:o(()=>[t(q,{value:1},{default:o(()=>e[45]||(e[45]=[n("启用")])),_:1}),t(q,{value:0},{default:o(()=>e[46]||(e[46]=[n("禁用")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),t(m,{label:"个人简介",prop:"profile"},{default:o(()=>[t(f,{modelValue:i(u).profile,"onUpdate:modelValue":e[11]||(e[11]=a=>i(u).profile=a),type:"textarea",rows:3,placeholder:"请输入个人简介",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(m,{label:"服务说明",prop:"service_desc"},{default:o(()=>[t(f,{modelValue:i(u).service_desc,"onUpdate:modelValue":e[12]||(e[12]=a=>i(u).service_desc=a),type:"textarea",rows:3,placeholder:"请输入服务说明",maxlength:"1000","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),t(ae,{label:"标签设置",name:"tags"},{default:o(()=>[t(m,{label:"风格标签"},{default:o(()=>[t(ve,{modelValue:i(u).tag_ids,"onUpdate:modelValue":e[13]||(e[13]=a=>i(u).tag_ids=a)},{default:o(()=>[(_(!0),b($,null,A(i(X),(a,p)=>(_(),b("div",{key:p,class:"mb-4"},[B("div",Tt,P(Ye[p]||p),1),(_(!0),b($,null,A(a,U=>(_(),w(ke,{key:U.id,value:U.id,label:U.name},null,8,["value","label"]))),128))]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(ae,{label:"服务套餐",name:"packages"},{default:o(()=>[t(m,{label:"关联全局套餐"},{default:o(()=>[t(oe,{data:i(u).packages,border:""},{default:o(()=>[t(y,{label:"套餐名称",prop:"package_name","min-width":"150"}),t(y,{label:"默认价格",width:"150"},{default:o(({row:a})=>[t(x,{modelValue:a.price,"onUpdate:modelValue":p=>a.price=p,min:0,precision:2,size:"small","controls-position":"right",placeholder:"默认价格"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(y,{label:"原价",width:"150"},{default:o(({row:a})=>[t(x,{modelValue:a.original_price,"onUpdate:modelValue":p=>a.original_price=p,min:0,precision:2,size:"small","controls-position":"right",placeholder:"选填"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(y,{label:"个人价格",width:"150"},{default:o(({row:a})=>[t(x,{modelValue:a.custom_price,"onUpdate:modelValue":p=>a.custom_price=p,min:0,precision:2,size:"small","controls-position":"right",placeholder:"不填则使用默认"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(y,{label:"场次价格",width:"100"},{default:o(({row:a,$index:p})=>[a.booking_type===1?(_(),w(g,{key:0,type:"primary",link:"",onClick:U=>nl(p)},{default:o(()=>{var U;return[n(" 配置"+P((U=a.custom_slot_prices)!=null&&U.length?`(${a.custom_slot_prices.length})`:""),1)]}),_:2},1032,["onClick"])):(_(),b("span",ht,"全天"))]),_:1}),t(y,{label:"预约类型",width:"140"},{default:o(({row:a})=>[t(M,{modelValue:a.booking_type,"onUpdate:modelValue":p=>a.booking_type=p,size:"small",class:"w-full",onChange:p=>dl(a)},{default:o(()=>[t(E,{label:"全天套餐",value:0}),t(E,{label:"分场次套餐",value:1})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(y,{label:"允许场次","min-width":"180"},{default:o(({row:a})=>[a.booking_type===1?(_(),w(ve,{key:0,modelValue:a.allowed_time_slots,"onUpdate:modelValue":p=>a.allowed_time_slots=p,size:"small"},{default:o(()=>[(_(),b($,null,A(h,p=>t(ke,{key:p.value,value:p.value,label:p.label},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])):(_(),b("span",Dt,"全天"))]),_:1}),t(y,{label:"状态",width:"100"},{default:o(({row:a})=>[t(Ve,{modelValue:a.status,"onUpdate:modelValue":p=>a.status=p,"active-value":1,"inactive-value":0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(y,{label:"操作",width:"140"},{default:o(({row:a,$index:p})=>[t(g,{type:"primary",link:"",onClick:U=>sl(a)},{default:o(()=>e[47]||(e[47]=[n("保存")])),_:2},1032,["onClick"]),t(g,{type:"danger",link:"",onClick:U=>il(p)},{default:o(()=>e[48]||(e[48]=[n("移除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(g,{class:"mt-4",onClick:e[14]||(e[14]=a=>F.value=!0)},{default:o(()=>e[49]||(e[49]=[n("添加套餐")])),_:1})]),_:1}),t(Ie,{"content-position":"left"},{default:o(()=>e[50]||(e[50]=[n("专属套餐")])),_:1}),t(m,{label:"专属套餐"},{default:o(()=>[t(oe,{data:i(Ne),border:""},{default:o(()=>[t(y,{label:"套餐名称",prop:"name","min-width":"150"}),t(y,{label:"价格",prop:"price",width:"100"},{default:o(({row:a})=>[n("¥"+P(a.price),1)]),_:1}),t(y,{label:"场次价格",width:"100"},{default:o(({row:a})=>{var p;return[(p=a.slot_prices)!=null&&p.length?(_(),b("span",$t,P(a.slot_prices.length)+"个场次",1)):(_(),b("span",At,"未配置"))]}),_:1}),t(y,{label:"预约类型",width:"120"},{default:o(({row:a})=>[a.booking_type===0?(_(),w(N,{key:0,type:"info"},{default:o(()=>e[51]||(e[51]=[n("全天套餐")])),_:1})):(_(),w(N,{key:1,type:"warning"},{default:o(()=>e[52]||(e[52]=[n("分场次套餐")])),_:1}))]),_:1}),t(y,{label:"允许场次","min-width":"160"},{default:o(({row:a})=>[a.booking_type!==1?(_(),b("span",Rt,"全天")):(_(),b("span",It,[(_(!0),b($,null,A(j(a.allowed_time_slots),p=>(_(),w(N,{key:p,class:"mr-1"},{default:o(()=>[n(P(_e[p]||p),1)]),_:2},1024))),128))]))]),_:1}),t(y,{label:"状态",prop:"is_show",width:"100"},{default:o(({row:a})=>[t(N,{type:a.is_show?"success":"info"},{default:o(()=>[n(P(a.is_show?"上架":"下架"),1)]),_:2},1032,["type"])]),_:1}),t(y,{label:"操作",width:"140"},{default:o(({row:a})=>[t(g,{type:"primary",link:"",onClick:p=>pl(a)},{default:o(()=>e[53]||(e[53]=[n("编辑")])),_:2},1032,["onClick"]),t(g,{type:"danger",link:"",onClick:p=>ml(a)},{default:o(()=>e[54]||(e[54]=[n("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),t(g,{class:"mt-4",type:"primary",onClick:ul},{default:o(()=>e[55]||(e[55]=[n(" 创建专属套餐 ")])),_:1})]),_:1})]),_:1}),t(ae,{label:"轮播图配置",name:"banner"},{default:o(()=>[B("div",Ot,[t(m,{label:"展示模式"},{default:o(()=>[t(K,{modelValue:i(v).banner_mode,"onUpdate:modelValue":e[15]||(e[15]=a=>i(v).banner_mode=a)},{default:o(()=>[t(q,{value:1},{default:o(()=>e[56]||(e[56]=[n("小图模式")])),_:1}),t(q,{value:2},{default:o(()=>e[57]||(e[57]=[n("大图模式")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"指示器样式"},{default:o(()=>[t(M,{modelValue:i(v).banner_indicator_style,"onUpdate:modelValue":e[16]||(e[16]=a=>i(v).banner_indicator_style=a),class:"w-full"},{default:o(()=>[t(E,{label:"圆点",value:1}),t(E,{label:"数字",value:2}),t(E,{label:"进度条",value:3}),t(E,{label:"无",value:0})]),_:1},8,["modelValue"])]),_:1}),i(v).banner_mode===1?(_(),w(m,{key:0,label:"小图初始高度"},{default:o(()=>[t(x,{modelValue:i(v).banner_small_height,"onUpdate:modelValue":e[17]||(e[17]=a=>i(v).banner_small_height=a),min:200,max:800,class:"w-full"},{append:o(()=>e[58]||(e[58]=[n("rpx")])),_:1},8,["modelValue"])]),_:1})):T("",!0),t(m,{label:i(v).banner_mode===1?"展开后高度":"固定高度"},{default:o(()=>[t(x,{modelValue:i(v).banner_large_height,"onUpdate:modelValue":e[18]||(e[18]=a=>i(v).banner_large_height=a),min:300,class:"w-full"},{append:o(()=>e[59]||(e[59]=[n("rpx")])),_:1},8,["modelValue"])]),_:1},8,["label"]),t(m,{label:"自动轮播"},{default:o(()=>[t(Ve,{modelValue:i(v).banner_autoplay,"onUpdate:modelValue":e[19]||(e[19]=a=>i(v).banner_autoplay=a),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),i(v).banner_autoplay===1?(_(),w(m,{key:1,label:"轮播间隔"},{default:o(()=>[t(x,{modelValue:i(v).banner_interval,"onUpdate:modelValue":e[20]||(e[20]=a=>i(v).banner_interval=a),min:1e3,max:1e4,step:500,class:"w-full"},{append:o(()=>e[60]||(e[60]=[n("毫秒")])),_:1},8,["modelValue"])]),_:1})):T("",!0)]),t(g,{type:"primary",onClick:vl},{default:o(()=>e[61]||(e[61]=[n("保存配置")])),_:1}),t(Ie,{"content-position":"left"},{default:o(()=>e[62]||(e[62]=[n("轮播图列表")])),_:1}),t(oe,{data:i(Y),border:"","row-key":"id"},{default:o(()=>[t(y,{label:"排序",width:"60"},{default:o(({$index:a})=>[n(P(a+1),1)]),_:1}),t(y,{label:"预览",width:"120"},{default:o(({row:a})=>[a.type===1?(_(),w(Oe,{key:0,src:a.file_url,fit:"cover",style:{width:"80px",height:"60px"},"preview-src-list":[a.file_url]},null,8,["src","preview-src-list"])):(_(),b("div",Ft,[t(Oe,{src:a.cover_url,fit:"cover",style:{width:"80px",height:"60px"}},null,8,["src"]),t(Vl,{class:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-white text-2xl"},{default:o(()=>[t(i(Ut))]),_:1})]))]),_:1}),t(y,{label:"类型",width:"100"},{default:o(({row:a})=>[t(N,{type:a.type===1?"success":"warning"},{default:o(()=>[n(P(a.type===1?"图片":"视频"),1)]),_:2},1032,["type"])]),_:1}),t(y,{label:"视频自动播放",width:"120"},{default:o(({row:a})=>[a.type===2?(_(),b("span",Lt,[t(N,{type:a.is_autoplay?"success":"info"},{default:o(()=>[n(P(a.is_autoplay?"是":"否"),1)]),_:2},1032,["type"])])):(_(),b("span",zt,"-"))]),_:1}),t(y,{label:"操作",width:"200"},{default:o(({row:a,$index:p})=>[t(g,{type:"primary",link:"",onClick:U=>yl(a)},{default:o(()=>e[63]||(e[63]=[n("编辑")])),_:2},1032,["onClick"]),t(g,{type:"danger",link:"",onClick:U=>kl(a)},{default:o(()=>e[64]||(e[64]=[n("删除")])),_:2},1032,["onClick"]),p>0?(_(),w(g,{key:0,type:"primary",link:"",onClick:U=>Ae(p,"up")},{default:o(()=>e[65]||(e[65]=[n(" 上移 ")])),_:2},1032,["onClick"])):T("",!0),p<i(Y).length-1?(_(),w(g,{key:1,type:"primary",link:"",onClick:U=>Ae(p,"down")},{default:o(()=>e[66]||(e[66]=[n(" 下移 ")])),_:2},1032,["onClick"])):T("",!0)]),_:1})]),_:1},8,["data"]),t(g,{class:"mt-4",type:"primary",onClick:gl},{default:o(()=>e[67]||(e[67]=[n("添加轮播图")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])]),_:1}),t(Ul,null,{default:o(()=>[t(g,{type:"primary",onClick:cl},{default:o(()=>e[68]||(e[68]=[n("保存")])),_:1})]),_:1}),t(W,{modelValue:i(F),"onUpdate:modelValue":e[23]||(e[23]=a=>G(F)?F.value=a:null),title:"选择套餐",width:"600px"},{footer:o(()=>[t(g,{onClick:e[22]||(e[22]=a=>F.value=!1)},{default:o(()=>e[69]||(e[69]=[n("取消")])),_:1}),t(g,{type:"primary",onClick:ol},{default:o(()=>e[70]||(e[70]=[n("确定")])),_:1})]),default:o(()=>[t(oe,{data:i(Ze),onSelectionChange:al,ref:"packageTableRef"},{default:o(()=>[t(y,{type:"selection",width:"55"}),t(y,{label:"套餐名称",prop:"name"}),t(y,{label:"分类",prop:"category_name"}),t(y,{label:"价格",prop:"price",width:"100"},{default:o(({row:a})=>[n("¥"+P(a.price),1)]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"]),t(W,{modelValue:i(L),"onUpdate:modelValue":e[25]||(e[25]=a=>G(L)?L.value=a:null),title:"场次价格配置",width:"600px"},{footer:o(()=>[t(g,{onClick:e[24]||(e[24]=a=>L.value=!1)},{default:o(()=>e[71]||(e[71]=[n("取消")])),_:1}),t(g,{type:"primary",onClick:rl},{default:o(()=>e[72]||(e[72]=[n("确定")])),_:1})]),default:o(()=>[e[73]||(e[73]=B("div",{class:"text-xs text-gray-500 mb-2"},"未填写的场次将使用默认价格",-1)),B("div",jt,[(_(!0),b($,null,A(i(ue),(a,p)=>(_(),b("div",{key:p,class:"flex items-center gap-4 mb-4"},[B("span",Mt,P(_e[a.time_slot]||a.time_slot),1),t(x,{modelValue:a.price,"onUpdate:modelValue":U=>a.price=U,min:0,precision:2,placeholder:"价格",style:{width:"150px"}},null,8,["modelValue","onUpdate:modelValue"])]))),128))])]),_:1},8,["modelValue"]),t(W,{modelValue:i(R),"onUpdate:modelValue":e[34]||(e[34]=a=>G(R)?R.value=a:null),title:i(z)?"编辑专属套餐":"创建专属套餐",width:"700px",onClosed:le},{footer:o(()=>[t(g,{onClick:e[33]||(e[33]=a=>R.value=!1)},{default:o(()=>e[76]||(e[76]=[n("取消")])),_:1}),t(g,{type:"primary",onClick:_l},{default:o(()=>[n(P(i(z)?"保存":"创建"),1)]),_:1})]),default:o(()=>[t(we,{ref_key:"staffPackageFormRef",ref:Se,model:i(r),rules:i(We),"label-width":"100px"},{default:o(()=>[t(m,{label:"套餐名称",prop:"name"},{default:o(()=>[t(f,{modelValue:i(r).name,"onUpdate:modelValue":e[26]||(e[26]=a=>i(r).name=a),placeholder:"请输入套餐名称"},null,8,["modelValue"])]),_:1}),t(m,{label:"所属分类",prop:"category_id"},{default:o(()=>[t(Re,{modelValue:i(r).category_id,"onUpdate:modelValue":e[27]||(e[27]=a=>i(r).category_id=a),options:i(fe).categories,props:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},placeholder:"选择服务分类",class:"w-full"},null,8,["modelValue","options"])]),_:1}),t(m,{label:"默认价格",prop:"price"},{default:o(()=>[t(x,{modelValue:i(r).price,"onUpdate:modelValue":e[28]||(e[28]=a=>i(r).price=a),min:0,precision:2,class:"w-full"},null,8,["modelValue"])]),_:1}),t(m,{label:"原价",prop:"original_price"},{default:o(()=>[t(x,{modelValue:i(r).original_price,"onUpdate:modelValue":e[29]||(e[29]=a=>i(r).original_price=a),min:0,precision:2,class:"w-full"},null,8,["modelValue"])]),_:1}),t(m,{label:"预约类型",prop:"booking_type"},{default:o(()=>[t(K,{modelValue:i(r).booking_type,"onUpdate:modelValue":e[30]||(e[30]=a=>i(r).booking_type=a)},{default:o(()=>[t(q,{value:0},{default:o(()=>e[74]||(e[74]=[n("全天套餐")])),_:1}),t(q,{value:1},{default:o(()=>e[75]||(e[75]=[n("分场次套餐")])),_:1})]),_:1},8,["modelValue"])]),_:1}),i(r).booking_type===1?(_(),w(m,{key:0,label:"允许场次",prop:"allowed_time_slots"},{default:o(()=>[t(ve,{modelValue:i(r).allowed_time_slots,"onUpdate:modelValue":e[31]||(e[31]=a=>i(r).allowed_time_slots=a)},{default:o(()=>[(_(),b($,null,A(h,a=>t(ke,{key:a.value,value:a.value,label:a.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})):T("",!0),i(r).booking_type===1?(_(),w(m,{key:1,label:"场次价格"},{default:o(()=>[B("div",Gt,[(_(!0),b($,null,A(i(r).slot_prices,(a,p)=>(_(),b("div",{key:p,class:"flex items-center gap-4 mb-2"},[B("span",Jt,P(_e[a.time_slot]||a.time_slot),1),t(x,{modelValue:a.price,"onUpdate:modelValue":U=>a.price=U,min:0,precision:2,placeholder:"价格",style:{width:"120px"}},null,8,["modelValue","onUpdate:modelValue"])]))),128))])]),_:1})):T("",!0),t(m,{label:"套餐说明",prop:"description"},{default:o(()=>[t(f,{modelValue:i(r).description,"onUpdate:modelValue":e[32]||(e[32]=a=>i(r).description=a),type:"textarea",rows:3,placeholder:"请输入套餐说明"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),t(W,{modelValue:i(I),"onUpdate:modelValue":e[40]||(e[40]=a=>G(I)?I.value=a:null),title:i(H)?"编辑轮播图":"添加轮播图",width:"600px",onClosed:ye},{footer:o(()=>[t(g,{onClick:e[39]||(e[39]=a=>I.value=!1)},{default:o(()=>e[79]||(e[79]=[n("取消")])),_:1}),t(g,{type:"primary",onClick:bl},{default:o(()=>e[80]||(e[80]=[n("确定")])),_:1})]),default:o(()=>[t(we,{ref_key:"bannerFormRef",ref:Ee,model:i(V),rules:i(Xe),"label-width":"100px"},{default:o(()=>[t(m,{label:"类型",prop:"type"},{default:o(()=>[t(K,{modelValue:i(V).type,"onUpdate:modelValue":e[35]||(e[35]=a=>i(V).type=a)},{default:o(()=>[t(q,{value:1},{default:o(()=>e[77]||(e[77]=[n("图片")])),_:1}),t(q,{value:2},{default:o(()=>e[78]||(e[78]=[n("视频")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"文件",prop:"file_url"},{default:o(()=>[t(be,{modelValue:i(V).file_url,"onUpdate:modelValue":e[36]||(e[36]=a=>i(V).file_url=a),limit:1,type:i(V).type===1?"image":"video"},null,8,["modelValue","type"])]),_:1}),i(V).type===2?(_(),w(m,{key:0,label:"封面图",prop:"cover_url"},{default:o(()=>[t(be,{modelValue:i(V).cover_url,"onUpdate:modelValue":e[37]||(e[37]=a=>i(V).cover_url=a),limit:1,type:"image"},null,8,["modelValue"])]),_:1})):T("",!0),i(V).type===2?(_(),w(m,{key:1,label:"自动播放"},{default:o(()=>[t(Ve,{modelValue:i(V).is_autoplay,"onUpdate:modelValue":e[38]||(e[38]=a=>i(V).is_autoplay=a),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})):T("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),t(W,{modelValue:i(J),"onUpdate:modelValue":e[41]||(e[41]=a=>G(J)?J.value=a:null),title:"后台账号信息",width:"420px",onClose:Te},{footer:o(()=>[t(g,{type:"primary",onClick:Te},{default:o(()=>e[83]||(e[83]=[n("我已记录")])),_:1})]),default:o(()=>[B("div",Ht,[t(Cl,{type:"warning","show-icon":"",closable:!1},{title:o(()=>e[81]||(e[81]=[n("请及时保存账号与密码")])),default:o(()=>e[82]||(e[82]=[n("关闭后密码不会再次展示，可通过“重置密码”重新生成。")])),_:1}),t(Pl,{column:1,border:""},{default:o(()=>[t(Fe,{label:"账号"},{default:o(()=>[n(P(i(Q).account),1)]),_:1}),t(Fe,{label:"密码"},{default:o(()=>[n(P(i(Q).password),1)]),_:1})]),_:1})])]),_:1},8,["modelValue"])])}}});export{ja as default};

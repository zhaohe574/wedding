import{H as Q,B as W,C as X,h as Y,g as Z,T as ee,U as te,v as ae,J as oe,K as le,i as se,D as ne,E as v}from"./element-plus-ChK2e5qA.js";import{b as re,d as ie}from"./index-D465kfFn.js";import{_ as de}from"./picker-mSew3b7I.js";import{I as me}from"./@element-plus-C4Lf8veM.js";import{D as ue}from"./vuedraggable-RHgmLr3o.js";import{p as ce,a as O}from"./service-CD4Egw8G.js";import{d as pe,b as _e,r as U,l as fe,c,o as d,U as l,L as r,a as s,K as y,P as p,u as n,R as w,S as _,T as P,ab as F,i as ve}from"./@vue-ygbFPFRc.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";import"./index-n-Jqn6Y-.js";import"./index.vue_vue_type_script_setup_true_lang-CCtv5BMP.js";import"./article-Be81dFL2.js";import"./usePaging-B2jDzebD.js";import"./vue-CQyKTslw.js";import"./sortablejs-BvvSZPRv.js";const ye={class:"package-list"},xe={class:"package-item mb-4 p-4 bg-gray-50 rounded-lg"},ge={class:"flex items-start"},be={class:"drag-handle cursor-move mr-3 mt-2"},he={class:"mr-4 flex-shrink-0"},ke={class:"w-[120px] h-[80px] rounded overflow-hidden bg-gray-200 flex items-center justify-center"},we={class:"flex-1 min-w-0"},Ve={class:"flex items-center gap-2 flex-wrap mb-2"},Ae={class:"font-medium text-gray-900"},Ee={key:0,class:"px-2 py-0.5 bg-primary/10 rounded text-xs text-primary"},Ue={key:0,class:"text-xs text-gray-500 mb-2"},Ce={class:"text-primary font-medium"},De={key:0,class:"line-through ml-2"},Be={key:1,class:"ml-2"},Ie={key:1,class:"text-xs text-gray-400 mb-2 line-clamp-2"},Re={class:"ml-4 flex flex-col gap-2 flex-shrink-0"},Ne={class:"mt-2"},Oe=pe({__name:"attr",props:{content:{type:Object,default:()=>({})},styles:{type:Object,default:()=>({})}},emits:["update:content"],setup(S,{emit:j}){const V=j,x=S,o=_e({get:()=>x.content,set:a=>{V("update:content",a)}});function T(){var a;Array.isArray((a=x.content)==null?void 0:a.data)||V("update:content",{...x.content,data:[]})}const g=U([]),b=U(""),h=U(!1);fe(()=>{T(),z()});async function z(){try{const a=await ce({});g.value=Array.isArray(a)?a:(a==null?void 0:a.lists)??(a==null?void 0:a.data)??[]}catch(a){console.error("加载公共套餐列表失败",a),g.value=[]}}function C(a,e){return{package_id:a.id,is_show:e??"1",sort:0}}async function K(a,e){if(e){h.value=!0;try{const i=await O({id:e});if(!i||!i.id){v.error("获取套餐详情失败");return}const m=Array.isArray(o.value.data)?[...o.value.data]:[],f=m[a];m[a]={...C(i,(f==null?void 0:f.is_show)??"1")},o.value={...o.value,data:m}}catch(i){console.error("获取套餐详情失败",i),v.error((i==null?void 0:i.message)||"获取套餐详情失败，请检查后端接口")}finally{h.value=!1}}}async function L(a){if(a){h.value=!0,b.value="";try{const e=await O({id:a});if(!e||!e.id){v.error("获取套餐详情失败");return}const i=Array.isArray(o.value.data)?[...o.value.data]:[];i.push(C(e)),o.value={...o.value,data:i},v.success("添加成功")}catch(e){console.error("获取套餐详情失败",e),v.error((e==null?void 0:e.message)||"获取套餐详情失败，请检查后端接口")}finally{h.value=!1}}}function M(a){const e=Array.isArray(o.value.data)?[...o.value.data]:[];e.splice(a,1),o.value={...o.value,data:e}}return(a,e)=>{const i=X,m=W,f=Y,D=Z,$=de,A=Q,E=te,G=ee,B=re,H=ae,I=le,R=oe,J=se,q=ne;return d(),c("div",null,[l(q,{"label-width":"80px"},{default:r(()=>[l(A,{shadow:"never",class:"!border-none flex mt-2"},{default:r(()=>[e[7]||(e[7]=s("div",{class:"flex items-end mb-4"},[s("div",{class:"text-base text-[#101010] font-medium"},"基础设置")],-1)),l(m,{label:"组件标题"},{default:r(()=>[l(i,{modelValue:n(o).title,"onUpdate:modelValue":e[0]||(e[0]=t=>n(o).title=t),placeholder:"请输入标题",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(m,{label:"显示数量"},{default:r(()=>[l(f,{modelValue:n(o).show_count,"onUpdate:modelValue":e[1]||(e[1]=t=>n(o).show_count=t),min:1,max:20,style:{width:"300px"}},null,8,["modelValue"])]),_:1}),l(m,{label:"查看更多"},{default:r(()=>[l(D,{modelValue:n(o).show_more,"onUpdate:modelValue":e[2]||(e[2]=t=>n(o).show_more=t),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),n(o).show_more?(d(),y(m,{key:0,label:"更多链接"},{default:r(()=>[l($,{modelValue:n(o).more_link,"onUpdate:modelValue":e[3]||(e[3]=t=>n(o).more_link=t)},null,8,["modelValue"])]),_:1})):p("",!0)]),_:1}),l(A,{shadow:"never",class:"!border-none flex mt-2"},{default:r(()=>[e[11]||(e[11]=s("div",{class:"flex items-end mb-4"},[s("div",{class:"text-base text-[#101010] font-medium"},"展示样式")],-1)),l(G,{modelValue:n(o).style,"onUpdate:modelValue":e[4]||(e[4]=t=>n(o).style=t)},{default:r(()=>[l(E,{value:1},{default:r(()=>e[8]||(e[8]=[w("横向滑动")])),_:1}),l(E,{value:2},{default:r(()=>e[9]||(e[9]=[w("纵向列表")])),_:1}),l(E,{value:3},{default:r(()=>e[10]||(e[10]=[w("大卡片")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(A,{shadow:"never",class:"!border-none flex mt-2"},{default:r(()=>[e[14]||(e[14]=s("div",{class:"flex items-end mb-4"},[s("div",{class:"text-base text-[#101010] font-medium"},"套餐列表"),s("div",{class:"text-xs text-tx-secondary ml-2"},"从已存在的公共套餐中选择，无需手动录入")],-1)),s("div",ye,[l(n(ue),{"model-value":Array.isArray(n(o).data)?n(o).data:[],"onUpdate:modelValue":e[5]||(e[5]=t=>V("update:content",{...x.content,data:t})),"item-key":(t,k)=>t&&t.package_id?t.package_id:"i"+k,animation:"300",handle:".drag-handle"},{item:r(({element:t,index:k})=>{var N;return[s("div",xe,[s("div",ge,[s("div",be,[l(B,{name:"el-icon-Rank",size:18,color:"#999"})]),s("div",he,[s("div",ke,[t.image?(d(),y(H,{key:0,src:t.image,fit:"cover",class:"w-full h-full"},null,8,["src"])):(d(),y(B,{key:1,name:"el-icon-Picture",size:24,color:"#999"}))])]),s("div",we,[s("div",Ve,[s("span",Ae,_(t.name||"未选择"),1),t.tag?(d(),c("span",Ee,_(t.tag),1)):p("",!0)]),t.name?(d(),c("div",Ue,[s("span",Ce,"¥"+_(t.price),1),t.original_price?(d(),c("span",De,"¥"+_(t.original_price),1)):p("",!0),(N=t.services)!=null&&N.length?(d(),c("span",Be," · 包含"+_(t.services.length)+"项服务 ",1)):p("",!0)])):p("",!0),t.desc?(d(),c("div",Ie,_(t.desc),1)):p("",!0),l(m,{label:"更换套餐",class:"!mb-0","label-width":"80px"},{default:r(()=>[l(R,{"model-value":t.package_id||"",placeholder:"选择公共套餐",filterable:"",clearable:"",style:{width:"220px"},onChange:u=>K(k,u)},{default:r(()=>[(d(!0),c(P,null,F(n(g),u=>(d(),y(I,{key:u.id,label:u.name,value:u.id},null,8,["label","value"]))),128))]),_:2},1032,["model-value","onChange"])]),_:2},1024)]),s("div",Re,[l(D,{modelValue:t.is_show,"onUpdate:modelValue":u=>t.is_show=u,"active-value":"1","inactive-value":"0","active-text":"显示"},null,8,["modelValue","onUpdate:modelValue"]),l(J,{type:"danger",text:"",icon:n(me),onClick:u=>M(k)},{default:r(()=>e[12]||(e[12]=[w(" 删除 ")])),_:2},1032,["icon","onClick"])])])])]}),_:1},8,["model-value","item-key"]),s("div",Ne,[e[13]||(e[13]=s("span",{class:"text-sm text-gray-500 mr-2"},"添加套餐：",-1)),l(R,{modelValue:n(b),"onUpdate:modelValue":e[6]||(e[6]=t=>ve(b)?b.value=t:null),placeholder:"请选择要展示的公共套餐",filterable:"",clearable:"",style:{width:"280px"},onChange:L},{default:r(()=>[(d(!0),c(P,null,F(n(g),t=>(d(),y(I,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])]),_:1})]),_:1})])}}}),ht=ie(Oe,[["__scopeId","data-v-cf85ca43"]]);export{ht as default};

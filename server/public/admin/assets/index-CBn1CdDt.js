import{D as Q,B as Z,C as ee,J as te,K as ae,V as le,i as oe,H as se,G as ne,I as ie,L as re,M as de,N as ue,O as pe,P as _e,W as ce,X as me,R as fe}from"./element-plus-ChK2e5qA.js";import{i as ve,j as be,k as ge,l as ye,m as we}from"./financial-BtVBj2RS.js";import{d as xe,r as c,a0 as he,l as Ve,c as f,o as _,U as e,L as t,T as L,ab as P,K as D,R as r,a as p,S as n,O as T,M as ze}from"./@vue-ygbFPFRc.js";import{d as ke}from"./index-D465kfFn.js";import"./@element-plus-C4Lf8veM.js";import"./lodash-es-C1lm3Iro.js";import"./dayjs-Bnps4p3p.js";import"./@popperjs-D_chPuIy.js";import"./async-validator-9PlIezaS.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./nprogress-UhqZPtFR.js";import"./vue-router-Cg6aTb_d.js";import"./pinia-CfRoOCaL.js";import"./axios-DIsA03vz.js";import"./lodash-CMKdTQec.js";import"./@vueuse-yz9uDhpq.js";import"./css-color-function-rr4n3v1N.js";import"./balanced-match-BdS7OldZ.js";import"./color-DYO1E7y4.js";import"./clone-Ddk2tjDh.js";import"./color-convert-DsNsD289.js";import"./color-name-Dju3oUBS.js";import"./color-string-pUQDDJII.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-BWi338pc.js";import"./clipboard-7pJsftR6.js";import"./echarts-DRRUpF4H.js";import"./tslib-BDyQ-Jie.js";import"./zrender-DDSL_IW4.js";import"./highlight.js-BLB-XFKK.js";import"./@highlightjs-DS9t1Xn3.js";const Ee={class:"financial-flow"},Ce={class:"stat-value"},De={class:"stat-value text-success"},Te={class:"stat-value text-danger"},Fe={key:0},Se={key:1,class:"text-muted"},Ue={key:0},Oe={key:1,class:"text-muted"},Be={class:"flex justify-end mt-4"},Le=xe({__name:"index",setup(Pe){const h=c(!1),F=c([]),S=c(0),V=c([]),y=c(!1),i=c({}),v=c({}),U=c([]),O=c([]),o=he({page_no:1,page_size:15,flow_sn:"",flow_type:"",biz_type:"",direction:"",start_date:"",end_date:""}),m=s=>(Number(s)||0).toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}),R=s=>({1:"success",2:"danger",3:"warning",4:"info",5:""})[s]||"",M=s=>{s?(o.start_date=s[0],o.end_date=s[1]):(o.start_date="",o.end_date="")},z=()=>{o.page_no=1,k(),B()},N=()=>{o.flow_sn="",o.flow_type="",o.biz_type="",o.direction="",o.start_date="",o.end_date="",V.value=[],z()},k=async()=>{h.value=!0;try{const s=await ve(o);F.value=s.lists||[],S.value=s.count||0}catch(s){console.error(s)}finally{h.value=!1}},B=async()=>{try{const s={};o.start_date&&o.end_date&&(s.start_date=o.start_date,s.end_date=o.end_date);const a=await be(s);v.value=a||{}}catch(s){console.error(s)}},I=async()=>{try{const[s,a]=await Promise.all([ge(),ye()]);U.value=s||[],O.value=a||[]}catch(s){console.error(s)}},Y=async s=>{try{const a=await we({id:s.id});i.value=a||s,y.value=!0}catch{i.value=s,y.value=!0}};return Ve(()=>{I(),k(),B()}),(s,a)=>{const j=ee,b=Z,w=ae,E=te,K=le,C=oe,q=Q,g=se,x=ne,G=ie,d=de,H=ue,J=re,W=_e,u=me,X=ce,$=fe,A=pe;return _(),f("div",Ee,[e(g,{class:"!border-none mb-4",shadow:"never"},{default:t(()=>[e(q,{model:o,inline:""},{default:t(()=>[e(b,{label:"流水编号"},{default:t(()=>[e(j,{modelValue:o.flow_sn,"onUpdate:modelValue":a[0]||(a[0]=l=>o.flow_sn=l),placeholder:"请输入流水编号",clearable:""},null,8,["modelValue"])]),_:1}),e(b,{label:"流水类型"},{default:t(()=>[e(E,{modelValue:o.flow_type,"onUpdate:modelValue":a[1]||(a[1]=l=>o.flow_type=l),placeholder:"全部",clearable:""},{default:t(()=>[(_(!0),f(L,null,P(U.value,l=>(_(),D(w,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"业务类型"},{default:t(()=>[e(E,{modelValue:o.biz_type,"onUpdate:modelValue":a[2]||(a[2]=l=>o.biz_type=l),placeholder:"全部",clearable:""},{default:t(()=>[(_(!0),f(L,null,P(O.value,l=>(_(),D(w,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"方向"},{default:t(()=>[e(E,{modelValue:o.direction,"onUpdate:modelValue":a[3]||(a[3]=l=>o.direction=l),placeholder:"全部",clearable:""},{default:t(()=>[e(w,{label:"收入",value:1}),e(w,{label:"支出",value:-1})]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"时间范围"},{default:t(()=>[e(K,{modelValue:V.value,"onUpdate:modelValue":a[4]||(a[4]=l=>V.value=l),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",onChange:M},null,8,["modelValue"])]),_:1}),e(b,null,{default:t(()=>[e(C,{type:"primary",onClick:z},{default:t(()=>a[8]||(a[8]=[r("查询")])),_:1}),e(C,{onClick:N},{default:t(()=>a[9]||(a[9]=[r("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(G,{gutter:16,class:"mb-4"},{default:t(()=>[e(x,{span:6},{default:t(()=>[e(g,{class:"stat-card",shadow:"never"},{default:t(()=>[a[10]||(a[10]=p("div",{class:"stat-label"},"流水笔数",-1)),p("div",Ce,n(v.value.total_count),1)]),_:1})]),_:1}),e(x,{span:6},{default:t(()=>[e(g,{class:"stat-card",shadow:"never"},{default:t(()=>[a[11]||(a[11]=p("div",{class:"stat-label"},"总收入",-1)),p("div",De,"¥"+n(m(v.value.total_income)),1)]),_:1})]),_:1}),e(x,{span:6},{default:t(()=>[e(g,{class:"stat-card",shadow:"never"},{default:t(()=>[a[12]||(a[12]=p("div",{class:"stat-label"},"总支出",-1)),p("div",Te,"¥"+n(m(v.value.total_expense)),1)]),_:1})]),_:1}),e(x,{span:6},{default:t(()=>[e(g,{class:"stat-card",shadow:"never"},{default:t(()=>[a[13]||(a[13]=p("div",{class:"stat-label"},"净额",-1)),p("div",{class:T(["stat-value",v.value.net_amount>=0?"text-success":"text-danger"])}," ¥"+n(m(v.value.net_amount)),3)]),_:1})]),_:1})]),_:1}),e(g,{class:"!border-none",shadow:"never"},{default:t(()=>[ze((_(),D(J,{data:F.value,stripe:""},{default:t(()=>[e(d,{prop:"flow_sn",label:"流水编号","min-width":"160"}),e(d,{prop:"flow_type_text",label:"流水类型",width:"100"},{default:t(({row:l})=>[e(H,{type:R(l.flow_type)},{default:t(()=>[r(n(l.flow_type_text),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"biz_type_text",label:"业务类型",width:"100"}),e(d,{prop:"biz_sn",label:"业务编号","min-width":"140"}),e(d,{prop:"amount",label:"金额",width:"120",align:"right"},{default:t(({row:l})=>[p("span",{class:T(l.direction==1?"text-success":"text-danger")},n(l.direction==1?"+":"-")+"¥"+n(m(l.amount)),3)]),_:1}),e(d,{prop:"pay_way_text",label:"支付方式",width:"100"}),e(d,{label:"关联用户",width:"120"},{default:t(({row:l})=>[l.user?(_(),f("span",Fe,n(l.user.nickname),1)):(_(),f("span",Se,"-"))]),_:1}),e(d,{label:"关联人员",width:"100"},{default:t(({row:l})=>[l.staff?(_(),f("span",Ue,n(l.staff.name),1)):(_(),f("span",Oe,"-"))]),_:1}),e(d,{prop:"remark",label:"备注","min-width":"150","show-overflow-tooltip":""}),e(d,{prop:"create_time",label:"创建时间",width:"170"}),e(d,{label:"操作",width:"80",fixed:"right"},{default:t(({row:l})=>[e(C,{type:"primary",link:"",onClick:Re=>Y(l)},{default:t(()=>a[14]||(a[14]=[r("详情")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[A,h.value]]),p("div",Be,[e(W,{"current-page":o.page_no,"onUpdate:currentPage":a[5]||(a[5]=l=>o.page_no=l),"page-size":o.page_size,"onUpdate:pageSize":a[6]||(a[6]=l=>o.page_size=l),total:S.value,"page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:z,onCurrentChange:k},null,8,["current-page","page-size","total"])])]),_:1}),e($,{modelValue:y.value,"onUpdate:modelValue":a[7]||(a[7]=l=>y.value=l),title:"流水详情",width:"600px"},{default:t(()=>[e(X,{column:2,border:""},{default:t(()=>[e(u,{label:"流水编号"},{default:t(()=>[r(n(i.value.flow_sn),1)]),_:1}),e(u,{label:"流水类型"},{default:t(()=>[r(n(i.value.flow_type_text),1)]),_:1}),e(u,{label:"业务类型"},{default:t(()=>[r(n(i.value.biz_type_text),1)]),_:1}),e(u,{label:"业务编号"},{default:t(()=>[r(n(i.value.biz_sn||"-"),1)]),_:1}),e(u,{label:"金额"},{default:t(()=>[p("span",{class:T(i.value.direction==1?"text-success":"text-danger")},n(i.value.direction==1?"+":"-")+"¥"+n(m(i.value.amount)),3)]),_:1}),e(u,{label:"支付方式"},{default:t(()=>[r(n(i.value.pay_way_text),1)]),_:1}),e(u,{label:"变动前余额"},{default:t(()=>[r("¥"+n(m(i.value.balance_before)),1)]),_:1}),e(u,{label:"变动后余额"},{default:t(()=>[r("¥"+n(m(i.value.balance_after)),1)]),_:1}),e(u,{label:"第三方交易号",span:2},{default:t(()=>[r(n(i.value.transaction_id||"-"),1)]),_:1}),e(u,{label:"备注",span:2},{default:t(()=>[r(n(i.value.remark||"-"),1)]),_:1}),e(u,{label:"创建时间",span:2},{default:t(()=>[r(n(i.value.create_time),1)]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),vt=ke(Le,[["__scopeId","data-v-8c1c1c8d"]]);export{vt as default};

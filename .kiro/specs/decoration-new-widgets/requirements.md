# 需求文档：装修组件扩展功能

## 简介

本需求文档定义了婚庆小程序装修系统的9个新增组件，旨在提升用户体验、增强营销转化能力、建立品牌信任感，并提供更丰富的页面装修选项。

## 术语表

- **装修组件（Widget）**：可在管理后台配置并在前端页面展示的可视化模块
- **装修系统（Decoration System）**：管理员通过可视化界面配置页面布局和内容的系统
- **页面作用域（Page Scope）**：组件可以应用的页面范围（home=首页, user=个人中心, news=资讯页）
- **动态数据加载**：组件配置只保存引用ID，前端渲染时后端动态查询最新业务数据
- **组件样式（Style）**：组件的展示形式，如网格、列表、横向滑动等
- **跳转链接（Link）**：组件中可配置的页面跳转目标
- **UniApp**：跨平台应用开发框架，支持小程序、H5、App
- **TuniaoUI**：UniApp 的 Vue 3 UI 组件库

## 需求列表

### 需求 1：快捷入口组件

**用户故事**：作为用户，我想在首页和个人中心快速访问常用功能，以便提高操作效率。

#### 验收标准

1. WHEN 管理员添加快捷入口组件 THEN 系统 SHALL 提供图标选择、标题配置、跳转链接配置功能
2. WHEN 管理员配置快捷入口数量 THEN 系统 SHALL 支持配置 4-12 个入口项
3. WHEN 管理员选择展示样式 THEN 系统 SHALL 提供网格布局（每行 4/5 个）和横向滑动两种样式
4. WHEN 用户查看快捷入口 THEN 系统 SHALL 显示图标、标题，并支持点击跳转
5. WHEN 用户点击快捷入口 THEN 系统 SHALL 根据配置的链接类型跳转到对应页面（内部页面、外部链接、小程序页面）
6. THE 系统 SHALL 支持配置每个入口的显示/隐藏状态
7. THE 系统 SHALL 支持拖拽排序功能
8. THE 系统 SHALL 在首页和个人中心页面显示该组件

### 需求 2：优惠券领取组件

**用户故事**：作为用户，我想在首页看到可领取的优惠券，以便获取优惠并促进下单。

#### 验收标准

1. WHEN 管理员添加优惠券组件 THEN 系统 SHALL 从优惠券库中选择要展示的优惠券
2. WHEN 管理员配置展示样式 THEN 系统 SHALL 提供卡片式、横向滑动、弹窗式三种样式
3. WHEN 管理员配置显示数量 THEN 系统 SHALL 支持设置显示 1-10 张优惠券
4. WHEN 用户查看优惠券 THEN 系统 SHALL 显示优惠券面额、使用条件、有效期、领取状态
5. WHEN 用户点击领取按钮 THEN 系统 SHALL 验证用户登录状态并领取优惠券到账户
6. WHEN 用户已领取优惠券 THEN 系统 SHALL 显示"已领取"状态并禁用领取按钮
7. WHEN 优惠券已领完 THEN 系统 SHALL 显示"已抢光"状态
8. THE 系统 SHALL 支持配置"查看更多"链接跳转到优惠券中心
9. THE 系统 SHALL 只保存优惠券ID引用，前端渲染时动态查询最新优惠券数据
10. THE 系统 SHALL 在首页和个人中心页面显示该组件

### 需求 3：数据统计卡片组件

**用户故事**：作为用户，我想在首页看到平台的关键数据统计，以便建立对平台的信任感。

#### 验收标准

1. WHEN 管理员添加数据统计组件 THEN 系统 SHALL 提供预设的统计指标选择（累计服务人数、好评率、服务年限、员工数量等）
2. WHEN 管理员配置展示样式 THEN 系统 SHALL 提供横向滑动卡片、网格布局（2列/3列）两种样式
3. WHEN 管理员配置统计项 THEN 系统 SHALL 支持添加 2-6 个统计指标
4. WHEN 管理员配置每个统计项 THEN 系统 SHALL 支持设置图标、标题、数值、单位、描述文字
5. WHEN 用户查看数据统计 THEN 系统 SHALL 以醒目的方式展示数值，并配有图标和说明
6. THE 系统 SHALL 支持配置数值的动画效果（数字滚动）
7. THE 系统 SHALL 支持配置背景颜色和卡片样式
8. THE 系统 SHALL 在首页显示该组件

### 需求 4：常见问题（FAQ）组件

**用户故事**：作为用户，我想快速找到常见问题的答案，以便自助解决疑问而无需联系客服。

#### 验收标准

1. WHEN 管理员添加 FAQ 组件 THEN 系统 SHALL 提供问题和答案的配置界面
2. WHEN 管理员配置展示样式 THEN 系统 SHALL 提供折叠面板、列表式两种样式
3. WHEN 管理员添加问题 THEN 系统 SHALL 支持添加 3-20 个常见问题
4. WHEN 管理员配置每个问题 THEN 系统 SHALL 支持设置问题标题、答案内容（支持富文本）、显示顺序
5. WHEN 用户查看 FAQ THEN 系统 SHALL 默认折叠所有答案，只显示问题标题
6. WHEN 用户点击问题 THEN 系统 SHALL 展开该问题的答案，并折叠其他已展开的问题
7. THE 系统 SHALL 支持配置问题分类（预约相关、支付相关、服务相关、退款相关）
8. THE 系统 SHALL 支持搜索功能，用户可搜索关键词快速定位问题
9. THE 系统 SHALL 在首页和个人中心页面显示该组件

### 需求 5：服务流程组件

**用户故事**：作为用户，我想了解完整的服务流程，以便清楚知道预约到服务完成的每个步骤。

#### 验收标准

1. WHEN 管理员添加服务流程组件 THEN 系统 SHALL 提供流程步骤的配置界面
2. WHEN 管理员配置展示样式 THEN 系统 SHALL 提供时间轴样式、步骤卡片样式、横向流程图三种样式
3. WHEN 管理员配置流程步骤 THEN 系统 SHALL 支持添加 3-8 个流程步骤
4. WHEN 管理员配置每个步骤 THEN 系统 SHALL 支持设置步骤图标、标题、描述文字、顺序
5. WHEN 用户查看服务流程 THEN 系统 SHALL 清晰展示每个步骤及其说明
6. THE 系统 SHALL 支持配置流程线的颜色和样式
7. THE 系统 SHALL 支持配置步骤图标的样式（圆形、方形）
8. THE 系统 SHALL 在首页显示该组件

### 需求 6：公告通知组件

**用户故事**：作为用户，我想及时看到系统公告和重要通知，以便了解最新的活动和政策变化。

#### 验收标准

1. WHEN 管理员添加公告通知组件 THEN 系统 SHALL 从系统公告库中选择要展示的公告
2. WHEN 管理员配置展示样式 THEN 系统 SHALL 提供横向滚动、纵向滚动、静态展示三种样式
3. WHEN 管理员配置显示数量 THEN 系统 SHALL 支持设置显示 1-5 条公告
4. WHEN 管理员配置公告 THEN 系统 SHALL 支持设置公告图标、标题、跳转链接
5. WHEN 用户查看公告 THEN 系统 SHALL 显示公告图标和标题，滚动样式下自动轮播
6. WHEN 用户点击公告 THEN 系统 SHALL 跳转到公告详情页或配置的链接
7. THE 系统 SHALL 支持配置滚动速度和方向
8. THE 系统 SHALL 支持配置公告的背景颜色和文字颜色
9. THE 系统 SHALL 只保存公告ID引用，前端渲染时动态查询最新公告数据
10. THE 系统 SHALL 在首页、个人中心、资讯页显示该组件

### 需求 7：热门话题组件

**用户故事**：作为用户，我想看到动态社区的热门话题，以便快速找到感兴趣的内容。

#### 验收标准

1. WHEN 管理员添加热门话题组件 THEN 系统 SHALL 从话题库中选择要展示的话题或自动获取热门话题
2. WHEN 管理员配置展示样式 THEN 系统 SHALL 提供标签云、横向滑动、列表式三种样式
3. WHEN 管理员配置显示数量 THEN 系统 SHALL 支持设置显示 5-20 个话题
4. WHEN 管理员配置话题来源 THEN 系统 SHALL 支持手动选择话题或自动获取热门话题（按参与人数排序）
5. WHEN 用户查看热门话题 THEN 系统 SHALL 显示话题名称、参与人数、话题图标
6. WHEN 用户点击话题 THEN 系统 SHALL 跳转到该话题的动态列表页
7. THE 系统 SHALL 支持配置话题标签的颜色和样式
8. THE 系统 SHALL 只保存话题ID引用，前端渲染时动态查询最新话题数据
9. THE 系统 SHALL 在首页和资讯页显示该组件

### 需求 8：门店地图组件

**用户故事**：作为用户，我想查看门店位置并获取导航，以便方便到店咨询和体验服务。

#### 验收标准

1. WHEN 管理员添加门店地图组件 THEN 系统 SHALL 提供门店信息配置界面
2. WHEN 管理员配置门店信息 THEN 系统 SHALL 支持添加门店名称、地址、经纬度、联系电话、营业时间
3. WHEN 管理员配置展示样式 THEN 系统 SHALL 提供地图+列表、纯地图、纯列表三种样式
4. WHEN 管理员配置多个门店 THEN 系统 SHALL 支持添加 1-10 个门店
5. WHEN 用户查看门店地图 THEN 系统 SHALL 在地图上标注所有门店位置
6. WHEN 用户点击地图标注 THEN 系统 SHALL 显示门店详细信息（名称、地址、电话、营业时间）
7. WHEN 用户点击导航按钮 THEN 系统 SHALL 调用地图应用进行导航
8. WHEN 用户点击电话按钮 THEN 系统 SHALL 拨打门店电话
9. THE 系统 SHALL 支持根据用户位置自动排序显示最近的门店
10. THE 系统 SHALL 在首页显示该组件

### 需求 9：婚礼倒计时组件

**用户故事**：作为已下单用户，我想在个人中心看到距离婚期的倒计时，以便时刻提醒自己做好准备。

#### 验收标准

1. WHEN 用户有已支付订单 THEN 系统 SHALL 自动获取订单中的服务日期作为婚期
2. WHEN 用户查看婚礼倒计时 THEN 系统 SHALL 显示距离婚期的天数、小时、分钟
3. WHEN 管理员配置展示样式 THEN 系统 SHALL 提供大字倒计时、卡片式倒计时、进度条式三种样式
4. WHEN 用户有多个订单 THEN 系统 SHALL 显示最近一个订单的婚期倒计时
5. WHEN 用户没有订单或订单已完成 THEN 系统 SHALL 隐藏该组件或显示默认提示
6. THE 系统 SHALL 支持配置倒计时的背景图片和文字颜色
7. THE 系统 SHALL 支持配置祝福语文案
8. THE 系统 SHALL 在个人中心页面显示该组件

## 通用需求

### 需求 10：组件通用配置

**用户故事**：作为管理员，我想对所有装修组件进行统一的基础配置，以便灵活控制组件的显示和样式。

#### 验收标准

1. THE 系统 SHALL 为每个组件提供启用/禁用开关
2. THE 系统 SHALL 为每个组件提供页面作用域配置（home/user/news）
3. THE 系统 SHALL 为每个组件提供上下边距配置
4. THE 系统 SHALL 为每个组件提供背景颜色配置
5. THE 系统 SHALL 支持组件的拖拽排序
6. THE 系统 SHALL 支持组件的复制和删除
7. THE 系统 SHALL 在保存时验证组件配置的完整性

### 需求 11：组件数据动态加载

**用户故事**：作为管理员，我希望修改业务数据后装修组件能自动显示最新数据，以便无需重新配置装修页面。

#### 验收标准

1. WHEN 组件引用业务数据（优惠券、公告、话题）THEN 系统 SHALL 只保存引用ID和控制信息
2. WHEN 前端渲染组件 THEN 系统 SHALL 根据引用ID动态查询最新的业务数据
3. WHEN 业务数据被删除 THEN 系统 SHALL 自动过滤该项，不影响其他数据显示
4. THE 系统 SHALL 使用批量查询避免 N+1 查询问题
5. THE 系统 SHALL 限制单次批量查询最大数量为 50 个

### 需求 12：组件响应式适配

**用户故事**：作为用户，我希望在不同设备上都能正常查看装修组件，以便获得良好的浏览体验。

#### 验收标准

1. THE 系统 SHALL 确保所有组件在小程序端正常显示
2. THE 系统 SHALL 确保所有组件在 H5 端正常显示
3. THE 系统 SHALL 确保所有组件在不同屏幕尺寸下自适应布局
4. THE 系统 SHALL 使用 rpx 单位确保不同设备的一致性
5. THE 系统 SHALL 确保组件在深色模式下的可读性

### 需求 13：组件性能优化

**用户故事**：作为用户，我希望页面加载速度快，以便快速浏览内容。

#### 验收标准

1. THE 系统 SHALL 对组件图片进行懒加载
2. THE 系统 SHALL 对长列表组件使用虚拟滚动
3. THE 系统 SHALL 缓存组件配置数据减少请求次数
4. THE 系统 SHALL 限制单个页面的组件数量不超过 20 个
5. THE 系统 SHALL 确保页面首屏加载时间不超过 2 秒

## 非功能性需求

### 性能需求

1. 组件配置保存响应时间应在 1 秒内
2. 前端页面加载时间应在 2 秒内
3. 批量查询业务数据应在 500ms 内完成
4. 支持至少 1000 个并发用户访问

### 安全需求

1. 所有组件配置数据应进行输入验证
2. 跳转链接应进行白名单验证，防止恶意跳转
3. 富文本内容应进行 XSS 过滤
4. 管理员操作应记录操作日志

### 兼容性需求

1. 支持微信小程序（基础库 2.0+）
2. 支持 H5（Chrome 80+, Safari 13+）
3. 支持 iOS 12+ 和 Android 8+
4. 支持屏幕宽度 320px - 1920px

### 可维护性需求

1. 组件代码应遵循项目编码规范
2. 组件应提供完整的 TypeScript 类型定义
3. 组件应提供详细的注释说明
4. 新增组件应遵循现有组件的目录结构

## 约束条件

1. 必须基于现有的装修系统架构开发
2. 必须使用 TuniaoUI 组件库
3. 必须遵循动态数据加载机制
4. 必须支持页面作用域过滤功能
5. 组件配置数据必须存储在 `la_decorate_page` 表的 `data` 字段中
6. 组件必须包含 `attr.vue`、`content.vue`、`options.ts` 三个文件

## 验收标准

1. 所有 9 个组件均已实现并通过功能测试
2. 组件在管理后台可正常配置和预览
3. 组件在前端页面正常显示和交互
4. 组件支持动态数据加载
5. 组件支持页面作用域过滤
6. 组件通过性能测试（加载时间、响应时间）
7. 组件通过兼容性测试（小程序、H5、不同设备）
8. 代码通过 Code Review
9. 提供完整的技术文档

## 参考资料

- 现有装修组件实现：`admin/src/views/decoration/component/widgets/`
- 装修数据动态加载文档：`doc/装修组件动态数据加载功能实现.md`
- 页面类型过滤文档：`doc/装修页面组件按页面类型过滤功能实现.md`
- TuniaoUI 文档：https://vue3.tuniaokj.com
- UniApp 文档：https://uniapp.dcloud.net.cn/

---

**文档版本**：v1.0  
**创建日期**：2026-01-22  
**维护者**：开发团队

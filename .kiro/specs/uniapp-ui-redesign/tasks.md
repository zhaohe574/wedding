# 实施计划：UniApp前端UI重构

## 概述

本实施计划将UI重构分解为一系列增量步骤，每个步骤都建立在前一步的基础上。重点是先建立设计系统基础，然后重构组件，最后重构页面。

## 任务

- [x] 1. 建立设计系统基础
  - 更新Tailwind配置，添加完整的设计令牌
  - 更新主题Store，支持新的颜色系统
  - 实现主题工具函数的增强版本
  - _需求：1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 2.1, 2.2, 2.3, 2.4, 3.1, 3.2, 3.3_

- [x] 1.1 更新Tailwind配置文件
  - 在`uniapp/tailwind.config.js`中添加完整的颜色系统
  - 添加辅助色（secondary: #EC4899）、CTA色（cta: #F97316）、点缀色（accent: #FFD700）
  - 为每个颜色添加5个亮度变体（light-3, light-5, light-7, light-9, dark-2）
  - 确保所有颜色都映射到CSS变量
  - 验证字号配置符合设计规范（24rpx-44rpx）
  - 添加间距配置（xs: 8rpx, sm: 16rpx, md: 24rpx, lg: 32rpx, xl: 48rpx, 2xl: 64rpx）
  - _需求：1.1, 1.2, 1.3, 1.4, 1.6, 2.1, 2.4, 3.2, 3.3_

- [x] 1.2 增强主题Store
  - 在`uniapp/src/stores/theme.ts`中添加新的颜色属性（secondaryColor, ctaColor, accentColor）
  - 更新getTheme方法，从装修系统获取完整的主题配置
  - 更新generateVars调用，包含所有新颜色
  - 添加setSecondaryColor、setCtaColor、setAccentColor方法
  - 确保主题更新时触发响应式更新
  - _需求：1.1, 1.5, 1.7_

- [x] 1.3 更新主题工具函数
  - 在`uniapp/src/utils/theme.ts`中验证generateVarsMap正确生成5个变体
  - 确保generateVars支持多个颜色类型（primary, secondary, cta, accent）
  - 添加颜色验证函数，确保输入是有效的十六进制颜色
  - 添加对比度计算函数，用于无障碍检查
  - _需求：1.2, 1.5_

- [ ]* 1.4 编写设计系统单元测试
  - 测试Tailwind配置包含所有必需的颜色和间距
  - 测试generateVarsMap生成5个变体
  - 测试generateVars生成正确的CSS变量字符串
  - 测试主题Store的getTheme和setTheme方法
  - 测试颜色验证和对比度计算函数
  - _需求：1.1, 1.2, 1.3, 1.4, 1.5, 1.6_

- [ ]* 1.5 编写设计系统属性测试
  - **属性1：主题色变体生成完整性**
  - **验证：需求 1.2**
  - **属性2：CSS变量全局可配置性**
  - **验证：需求 1.5**
  - **属性4：间距系统8rpx基准**
  - **验证：需求 3.1**

- [ ] 2. 检查点 - 设计系统基础
  - 确保所有测试通过
  - 验证主题色可以通过装修系统动态修改
  - 验证CSS变量在页面中正确应用
  - 如有问题，询问用户

- [x] 3. 重构基础组件
  - 创建或更新按钮组件
  - 创建或更新卡片组件
  - 创建或更新导航栏组件
  - 创建或更新表单组件
  - _需求：4.1-4.8, 5.1-5.7, 6.1-6.7, 8.1-8.7_

- [x] 3.1 创建按钮组件封装
  - 在`uniapp/src/components/base/`创建`BaseButton.vue`
  - 支持三种类型：primary、secondary、cta
  - 支持三种尺寸：lg（88rpx）、md（72rpx）、sm（56rpx）
  - 实现圆角样式（48rpx）
  - 实现点击反馈动画（scale 0.98, opacity 0.9）
  - 添加过渡动画（transition: all 0.2s ease）
  - 使用图鸟UI的tn-button作为基础，添加自定义样式
  - _需求：4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8_

- [x] 3.2 创建卡片组件
  - 在`uniapp/src/components/base/`创建`BaseCard.vue`
  - 支持两种类型：standard、glass
  - 实现标准卡片样式（白色背景，16rpx圆角，阴影）
  - 实现玻璃态卡片样式（半透明背景，模糊效果）
  - 实现hover效果（向上移动4rpx，增强阴影）
  - 确保玻璃态卡片的文字对比度达到4.5:1
  - _需求：5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7_

- [x] 3.3 创建导航栏组件封装
  - 在`uniapp/src/components/base/`创建`BaseNavbar.vue`
  - 封装图鸟UI的tn-navbar
  - 自动从主题Store获取背景色和文字色
  - 支持返回按钮配置
  - 支持固定定位
  - 高度设置为88rpx
  - _需求：6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7_

- [x] 3.4 创建表单组件封装
  - 在`uniapp/src/components/base/`创建`BaseInput.vue`
  - 封装图鸟UI的tn-input
  - 设置高度为88rpx，内边距24rpx
  - 实现焦点状态样式（白色背景，主色边框）
  - 添加过渡动画
  - 创建`BasePicker.vue`和`BaseDatePicker.vue`
  - _需求：8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7_

- [ ]* 3.5 编写基础组件单元测试
  - 测试按钮的三种类型渲染正确的样式
  - 测试按钮的三种尺寸
  - 测试按钮的点击事件和禁用状态
  - 测试卡片的两种类型
  - 测试导航栏的配置选项
  - 测试输入框的焦点状态
  - _需求：4.1-4.8, 5.1-5.7, 6.1-6.7, 8.1-8.7_

- [ ]* 3.6 编写基础组件属性测试
  - **属性5：按钮类型样式映射**
  - **验证：需求 4.2, 4.3, 4.4**
  - **属性6：按钮点击视觉反馈**
  - **验证：需求 4.7**
  - **属性7：卡片类型样式映射**
  - **验证：需求 5.2, 5.3, 5.4, 5.5, 5.6**
  - **属性8：玻璃态卡片对比度**
  - **验证：需求 5.7**
  - **属性9：表单输入框焦点状态**
  - **验证：需求 8.4**

- [ ] 4. 检查点 - 基础组件
  - 确保所有测试通过
  - 在示例页面中验证组件外观和交互
  - 验证组件在不同主题色下的表现
  - 如有问题，询问用户


- [x] 5. 重构业务组件
  - 创建底部标签栏组件
  - 创建人员卡片组件
  - 创建动态卡片组件
  - 创建订单卡片组件
  - _需求：7.1-7.7, 9.1-9.7_

- [x] 5.1 重构底部标签栏
  - 在`uniapp/src/components/tabbar/`创建`CustomTabbar.vue`
  - 使用图鸟UI图标替代图片图标
  - 设置高度为120rpx + 安全区域
  - 设置图标尺寸为48rpx × 48rpx
  - 实现选中状态样式（主色图标和文字）
  - 实现未选中状态样式（灰色图标和文字）
  - 更新`uniapp/src/pages.json`中的tabbar配置
  - _需求：7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7_

- [x] 5.2 创建人员卡片组件
  - 在`uniapp/src/components/business/`创建`StaffCard.vue`
  - 实现卡片布局（头像、姓名、评分、价格、标签、收藏按钮）
  - 使用标准卡片样式
  - 头像设置为圆形，80rpx × 80rpx
  - 评分使用星级图标 + 数字 + 评价数
  - 价格使用CTA色（橙色）
  - 标签使用浅紫背景 + 紫色文字
  - 收藏按钮使用心形图标，支持切换状态
  - _需求：9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7_

- [x] 5.3 创建动态卡片组件
  - 在`uniapp/src/components/business/`创建`DynamicCard.vue`
  - 实现卡片布局（用户信息、内容、图片、话题、位置、互动栏）
  - 用户头像设置为圆形，64rpx × 64rpx
  - 关注按钮使用紫色背景，圆角
  - 话题标签使用紫色文字，可点击
  - 图片使用九宫格布局，间距8rpx
  - 互动栏使用图标 + 数字，灰色
  - 点赞按钮支持动画效果
  - _需求：9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7_

- [x] 5.4 创建订单卡片组件
  - 在`uniapp/src/components/business/`创建`OrderCard.vue`
  - 实现卡片布局（状态标签、人员信息、服务信息、价格、操作按钮）
  - 定义订单状态色彩常量
  - 状态标签使用对应的颜色
  - 人员信息包含头像、姓名、服务类型
  - 价格信息包含原价、优惠、实付
  - 根据订单状态显示不同的操作按钮
  - _需求：13.1, 13.2, 13.3, 13.4, 13.5, 13.6, 13.7_

- [ ]* 5.5 编写业务组件单元测试
  - 测试tabbar的图标切换
  - 测试人员卡片的数据渲染
  - 测试动态卡片的九宫格布局
  - 测试订单卡片的状态色彩
  - 测试收藏和点赞的状态切换
  - _需求：7.1-7.7, 9.1-9.7, 13.1-13.7_

- [ ]* 5.6 编写业务组件属性测试
  - **属性10：图标系统一致性**
  - **验证：需求 9.2, 9.6**

- [ ] 6. 检查点 - 业务组件
  - 确保所有测试通过
  - 在示例页面中验证组件外观和交互
  - 验证图标系统的一致性
  - 如有问题，询问用户

- [x] 7. 重构装修组件
  - 更新搜索栏组件
  - 更新轮播图组件
  - 更新导航菜单组件
  - 创建人员推荐组件
  - 创建服务套餐组件
  - _需求：15.1-15.8_

- [x] 7.1 更新搜索栏组件
  - 在`uniapp/src/components/widgets/search/`更新`search.vue`
  - 应用新的样式规范（高度72rpx，圆角36rpx）
  - 使用图鸟UI图标
  - 支持样式配置（背景色、文字色、圆角）
  - 热词使用紫色文字
  - _需求：15.5_

- [x] 7.2 更新轮播图组件
  - 在`uniapp/src/components/widgets/banner/`更新`banner.vue`
  - 应用新的样式规范（默认高度320rpx，圆角16rpx）
  - 指示器使用紫色圆点
  - 支持样式配置（高度、圆角、间距）
  - _需求：15.5_

- [x] 7.3 更新导航菜单组件
  - 在`uniapp/src/components/widgets/nav/`更新`nav.vue`
  - 应用新的样式规范（网格布局，图标64rpx）
  - 使用图鸟UI图标
  - 支持4列或5列布局
  - 文字使用26rpx，居中
  - _需求：15.5_

- [x] 7.4 创建人员推荐组件
  - 在`uniapp/src/components/widgets/`创建`staff-showcase/staff-showcase.vue`
  - 实现横向滚动布局
  - 标题使用32rpx，字重600
  - 使用StaffCard组件显示人员
  - 卡片间距16rpx
  - 支持"查看更多"链接
  - _需求：15.7_

- [x] 7.5 创建服务套餐组件
  - 在`uniapp/src/components/widgets/`创建`service-packages/service-packages.vue`
  - 实现网格布局（2列或3列）
  - 图片比例16:9
  - 价格使用CTA色（橙色），加粗
  - 原价使用删除线，灰色
  - 支持样式配置
  - _需求：15.7_

- [ ]* 7.6 编写装修组件单元测试
  - 测试组件接收正确的props
  - 测试样式配置生效
  - 测试内容渲染正确
  - _需求：15.1-15.8_

- [ ]* 7.7 编写装修系统属性测试
  - **属性11：装修配置实时应用**
  - **验证：需求 15.8**

- [ ] 8. 检查点 - 装修组件
  - 确保所有测试通过
  - 在首页验证装修组件的显示
  - 测试装修系统的配置更新
  - 如有问题，询问用户

- [x] 9. 重构首页
  - 更新首页布局
  - 应用新的背景渐变
  - 集成所有装修组件
  - 优化性能
  - _需求：10.1-10.9, 19.1-19.7_

- [x] 9.1 更新首页布局和样式
  - 在`uniapp/src/pages/index/index.vue`中更新页面结构
  - 应用浅紫色渐变背景（#FAF5FF → #FFFFFF）
  - 设置区块间距为32rpx
  - 设置内容边距为24rpx
  - 使用BaseNavbar组件
  - 确保所有装修组件正确渲染
  - _需求：10.1, 10.2, 10.3, 10.4, 10.5, 10.6, 10.7, 10.8, 10.9_

- [x] 9.2 优化首页性能
  - 为图片启用懒加载
  - 使用z-paging实现虚拟滚动
  - 优化组件渲染性能
  - 减少不必要的重渲染
  - _需求：19.1, 19.2, 19.3, 19.4, 19.5, 19.6, 19.7_

- [ ]* 9.3 编写首页集成测试
  - 测试页面加载流程
  - 测试装修组件的渲染
  - 测试主题切换
  - 测试性能指标
  - _需求：10.1-10.9, 19.1-19.7_

- [ ] 10. 检查点 - 首页
  - 确保所有测试通过
  - 验证首页在不同设备上的显示
  - 验证性能指标达标
  - 如有问题，询问用户

- [ ] 11. 重构人员详情页
  - 更新页面布局
  - 实现玻璃态效果
  - 集成人员卡片组件
  - 实现标签页切换
  - _需求：11.1-11.8_

- [ ] 11.1 更新人员详情页布局
  - 在`packages/pages/staff_detail/staff_detail.vue`中更新页面结构
  - 实现头图布局（高度400rpx）
  - 在头图上添加玻璃态导航栏
  - 实现人员信息卡片（玻璃态效果，悬浮在头图上）
  - 添加收藏和分享按钮
  - 实现标签页切换（简介、作品、评价）
  - 作品使用九宫格布局，间距8rpx
  - 底部操作栏固定，高度120rpx + 安全区域
  - _需求：11.1, 11.2, 11.3, 11.4, 11.5, 11.6, 11.7, 11.8_

- [ ]* 11.2 编写人员详情页测试
  - 测试页面数据加载
  - 测试标签页切换
  - 测试收藏功能
  - 测试分享功能
  - _需求：11.1-11.8_

- [-] 12. 重构动态广场页
  - 更新页面布局
  - 集成动态卡片组件
  - 实现筛选和排序
  - 优化列表性能
  - _需求：12.1-12.9_

- [x] 12.1 更新动态广场页布局
  - 在`uniapp/src/pages/dynamic/dynamic.vue`中更新页面结构
  - 实现顶部标签栏（关注/推荐/话题）
  - 实现排序筛选（最新/最热/话题筛选）
  - 使用DynamicCard组件显示动态
  - 实现下拉刷新和上拉加载
  - 优化长列表性能（使用z-paging）
  - _需求：12.1, 12.2, 12.3, 12.4, 12.5, 12.6, 12.7, 12.8, 12.9_

- [ ]* 12.2 编写动态广场页测试
  - 测试标签切换
  - 测试筛选功能
  - 测试点赞和评论
  - 测试列表加载
  - _需求：12.1-12.9_

- [ ] 13. 重构订单页面
  - 更新页面布局
  - 集成订单卡片组件
  - 实现状态筛选
  - 优化列表性能
  - _需求：13.1-13.7_

- [ ] 13.1 更新订单页面布局
  - 在`uniapp/src/pages/order/order.vue`中更新页面结构
  - 实现顶部标签栏（全部/待支付/已支付/已完成）
  - 使用OrderCard组件显示订单
  - 实现下拉刷新和上拉加载
  - 实现空状态显示
  - 优化列表性能
  - _需求：13.1, 13.2, 13.3, 13.4, 13.5, 13.6, 13.7_

- [ ]* 13.2 编写订单页面测试
  - 测试标签切换
  - 测试订单列表加载
  - 测试订单操作
  - _需求：13.1-13.7_

- [ ] 14. 重构购物车页面
  - 更新页面布局
  - 实现档期冲突检测
  - 实现费用计算
  - 实现方案保存
  - _需求：14.1-14.8_

- [ ] 14.1 更新购物车页面布局
  - 在`packages/pages/cart/cart.vue`中更新页面结构
  - 实现全选和单选功能
  - 实现管理模式（显示删除按钮）
  - 实现档期冲突检测和提示
  - 实现费用明细（固定底部，玻璃态背景）
  - 实现保存方案功能
  - 底部高度设置为160rpx + 安全区域
  - _需求：14.1, 14.2, 14.3, 14.4, 14.5, 14.6, 14.7, 14.8_

- [ ]* 14.2 编写购物车页面测试
  - 测试选择功能
  - 测试冲突检测
  - 测试费用计算
  - 测试方案保存
  - _需求：14.1-14.8_

- [ ] 15. 检查点 - 页面重构
  - 确保所有测试通过
  - 验证所有页面在不同设备上的显示
  - 验证页面间的导航流程
  - 如有问题，询问用户

- [ ] 16. 实施响应式和无障碍
  - 实现响应式布局
  - 实施无障碍优化
  - 实施动效系统
  - _需求：16.1-16.7, 17.1-17.8, 18.1-18.8_

- [ ] 16.1 实现响应式布局
  - 在所有页面和组件中添加响应式断点
  - 手机端（< 768px）使用单列布局
  - 平板端（768px - 1024px）使用双列布局
  - PC端（> 1024px）使用三列或更多列布局
  - 适配不同屏幕的安全区域
  - _需求：16.1, 16.2, 16.3, 16.4, 16.5, 16.6, 16.7_

- [ ] 16.2 实施无障碍优化
  - 确保所有文字对比度达标（正文4.5:1，大号3:1）
  - 确保所有触摸目标尺寸不小于88rpx × 88rpx
  - 为所有图片添加alt文本
  - 为所有表单输入框添加标签
  - 确保颜色不是唯一的信息指示器
  - 添加prefers-reduced-motion支持
  - _需求：18.1, 18.2, 18.3, 18.4, 18.5, 18.6, 18.7, 18.8_

- [ ] 16.3 实施动效系统
  - 为颜色和透明度变化添加快速过渡（0.15s）
  - 为按钮和卡片hover添加标准过渡（0.2s）
  - 为页面切换添加慢速过渡（0.3s）
  - 实现卡片hover效果（向上移动4rpx，增强阴影）
  - 实现按钮点击效果（缩放0.98，透明度0.9）
  - 禁止无限循环动画和超过500ms的过渡
  - 添加prefers-reduced-motion支持
  - _需求：17.1, 17.2, 17.3, 17.4, 17.5, 17.6, 17.7, 17.8_

- [ ]* 16.4 编写响应式和无障碍测试
  - **属性12：响应式布局断点**
  - **验证：需求 16.1, 16.2, 16.3**
  - **属性13：过渡动画时长规范**
  - **验证：需求 17.1, 17.2, 17.3, 17.7**
  - **属性14：文字对比度达标**
  - **验证：需求 18.1, 18.2**
  - **属性15：触摸目标尺寸达标**
  - **验证：需求 18.4**

- [ ] 17. 检查点 - 响应式和无障碍
  - 确保所有测试通过
  - 在不同设备和视口尺寸下验证布局
  - 使用无障碍工具检查合规性
  - 如有问题，询问用户

- [ ] 18. 性能优化和最终测试
  - 实施性能优化措施
  - 运行完整的测试套件
  - 进行视觉回归测试
  - 进行性能测试
  - _需求：19.1-19.7_

- [ ] 18.1 实施性能优化
  - 为所有图片启用懒加载
  - 在列表页使用缩略图，详情页使用原图
  - 为所有长列表使用z-paging虚拟滚动
  - 优化CSS变量的使用
  - 减少不必要的组件重渲染
  - 优化图片尺寸和格式
  - _需求：19.1, 19.2, 19.3, 19.4, 19.5, 19.6, 19.7_

- [ ]* 18.2 运行完整测试套件
  - 运行所有单元测试
  - 运行所有属性测试
  - 运行所有集成测试
  - 确保测试覆盖率达标
  - _需求：所有需求_

- [ ]* 18.3 进行视觉回归测试
  - 使用Playwright截图对比
  - 测试首页在不同主题色下的渲染
  - 测试按钮在不同状态下的外观
  - 测试卡片在hover状态下的效果
  - 测试响应式布局在不同视口下的表现
  - _需求：所有UI相关需求_

- [ ]* 18.4 进行性能测试
  - 使用Lighthouse测试性能指标
  - 确保FCP < 1.8s
  - 确保LCP < 2.5s
  - 确保TTI < 3.8s
  - 确保TBT < 200ms
  - 确保CLS < 0.1
  - _需求：19.1-19.7_

- [ ]* 18.5 编写性能属性测试
  - **属性16：图片懒加载启用**
  - **验证：需求 19.1**

- [ ] 19. 最终检查点
  - 确保所有测试通过
  - 验证所有需求已实现
  - 验证所有页面在所有平台正常工作
  - 准备部署文档

- [ ] 20. 文档和交付
  - 更新README文档
  - 创建组件使用文档
  - 创建设计系统文档
  - 创建部署指南
  - _需求：20.1-20.7_

- [ ] 20.1 更新README文档
  - 在`uniapp/README.md`中添加UI重构说明
  - 说明新的设计系统
  - 说明组件使用方法
  - 说明主题配置方法
  - _需求：20.7_

- [ ] 20.2 创建组件文档
  - 在`uniapp/docs/components/`创建组件使用文档
  - 为每个基础组件提供使用示例
  - 为每个业务组件提供使用示例
  - 为每个装修组件提供配置说明
  - _需求：20.6, 20.7_

- [ ] 20.3 创建设计系统文档
  - 在`uniapp/docs/design-system/`创建设计系统文档
  - 说明颜色系统的使用
  - 说明字体系统的使用
  - 说明间距系统的使用
  - 提供设计令牌参考表
  - _需求：20.7_

- [ ] 20.4 创建部署指南
  - 在`uniapp/docs/`创建部署指南
  - 说明构建流程
  - 说明环境配置
  - 说明平台特定的注意事项
  - _需求：20.7_

- [ ] 21. 最终验收
  - 与用户一起验收所有功能
  - 确认所有需求已满足
  - 收集反馈并进行必要的调整
  - 完成项目交付

## 注意事项

- 标记为`*`的任务是可选的测试任务，可以根据项目进度决定是否实施
- 每个检查点都应该确保所有测试通过，并与用户确认进度
- 如果遇到问题，应该及时与用户沟通，不要继续下一个任务
- 所有代码都应该遵循Vue 3 Composition API和TypeScript规范
- 所有组件都应该有中文注释
- 所有样式都应该优先使用Tailwind原子类

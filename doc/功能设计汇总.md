# 婚庆小程序功能设计汇总

**项目名称:** 婚庆服务预约小程序  
**创建日期:** 2026-01-19  
**基于框架:** LikeAdmin PHP (ThinkPHP 8.0 + Vue 3 + UniApp + TuniaoUI)

---

## 一、项目简介

基于 LikeAdmin 快速开发框架，开发婚庆公司使用的小程序系统。

**核心价值**
- 用户端：便捷查看工作人员信息、档期，实现线上预约和支付
- 工作人员端：移动化管理个人档期、订单、收益和作品展示
- 管理端：PC端完整管理功能 + 小程序端移动数据看板
- 社区互动：工作人员发布作品动态，用户观看、点赞、评论

---

## 二、技术架构

### 2.1 后端技术栈
- 框架：ThinkPHP 8.0
- 语言：PHP >= 8.0
- 数据库：MySQL
- 缓存：Redis
- 架构：Controller → Logic → Service → Model

### 2.2 前端技术栈
- 管理后台：Vue 3.5 + Element Plus + Vite
- 小程序端：UniApp + TuniaoUI (图鸟UI)
- PC前台：Nuxt 3.6 + Element Plus
- CSS：Tailwind CSS + SCSS

### 2.3 UI组件库
- 小程序端：TuniaoUI - 原生 Vue 3 支持，60+ 组件
- 管理后台：Element Plus - Vue 3 官方推荐
- 官网：https://vue3.tuniaokj.com

---

## 三、用户角色

### 3.1 普通用户（客户）
- 浏览人员信息、查看档期、购物车管理
- 在线预约下单、订单管理、支付、评价
- 动态社区互动、收藏管理

### 3.2 工作人员
- 档期管理、订单管理（确认/拒绝）
- 动态发布与管理、个人资料与作品管理
- 收益统计与提现

### 3.3 小程序管理员（移动端）
- 数据看板、订单监控、人员业绩
- 财务数据、内容审核、快捷操作

### 3.4 PC管理后台
- 综合数据看板、人员管理、订单管理、档期管理
- 动态管理、评价管理、财务管理、营销管理
- 用户管理、系统设置

---

## 四、核心业务流程

### 4.1 预约流程
```
浏览人员 → 查看档期 → 加入购物车 → 填写信息 → 
提交订单 → 工作人员确认 → 用户支付 → 服务完成 → 评价
```

### 4.2 订单状态流转
```
待确认 → 待支付 → 已支付 → 服务中 → 已完成 → 已评价
```

### 4.3 支付方式
- 线上支付：微信支付、余额支付、组合支付
- 线下支付：用户上传凭证 → 管理员审核 → 确认收款

---

## 五、功能模块

### 5.1 人员展示
- 人员分类、列表、详情
- 筛选（价格、评分、档期）、排序
- 作品展示、评价展示、档期日历
- 收藏、加入购物车、立即预约、分享

### 5.2 购物车
- 多人员组合预约
- 档期冲突检测
- 费用明细计算
- 批量操作管理
- **分享购物车**：支持分享给未婚伴侣/闺蜜，共同挑选人员、协同支付
- **伴侣协同增强**：
  - 实时共改：双方同时修改档期、备注，冲突即时提示
  - 权限粒度：只读/可改/支付权可分别授权
  - 微信一键拉群：把双方父母、闺蜜、策划师拉进"婚礼筹备群"，群内直接分享小程序卡片
- **保存方案**：
  - 支持保存多个预约方案（方案A、方案B）
  - 方案对比功能（价格、人员、档期对比）
  - 方案分享（分享给伴侣或家人参考）
- **预算计算器**：
  - 实时显示总价、优惠金额、实付金额
  - 费用明细展开（各项服务费用清单）
  - 预算超支提醒
  - 优惠券自动匹配推荐

### 5.3 订单管理
- 订单列表（按状态分类）
- 订单详情（完整信息、服务人员列表、费用明细）
- 支付流程（线上/线下支付、凭证上传审核）
- 退款流程（整单/部分退款、线上/线下退款）
- 订单评价（多维度评分、图文评价、匿名选项）
- **婚礼倒计时时间轴**：
  - 根据婚期自动生成任务清单（选婚纱、拍婚照、发请帖等）
  - 任务同步到手机日历
  - 到期自动推送提醒
  - 任务完成进度可视化
- **订单变更**：
  - 改期申请（修改服务日期，需工作人员确认）
  - 换人申请（更换服务人员，差价多退少补）
  - 加项申请（增加服务项目，补差价）
  - 变更记录（完整的变更历史记录）
  - 变更审核（工作人员/管理员审核）
- **订单暂停**：
  - 特殊情况延期（疫情、突发事件等）
  - 暂停原因说明
  - 暂停期限设置
  - 自动恢复提醒
- **订单转让**：
  - 转让给他人（转让原因、接收人信息）
  - 转让审核（管理员审核）
  - 转让记录（转让历史追溯）

### 5.4 档期管理
- 日历视图（月历展示、状态标识）
- 批量设置（批量设置档期、复制上月档期）
- 规则配置（提前预约天数、单日接单数、间隔时间）
- 档期统计（利用率、收入预估）
- **防重复接单**：分布式锁机制，多端同时预约时二次确认弹窗，防止超卖
- **备选方案推荐**：档期冲突时自动推荐同价位替代人员，降低用户流失
- **一键导入外部日历**：
  - 支持读取飞书/钉钉/iCal 链接
  - 自动屏蔽商拍、商业活动档期
  - 避免手工二次录入
- **档期锁定**：
  - VIP客户优先锁定档期（锁定时长可配置）
  - 锁定期内其他用户无法预约
  - 锁定到期自动释放
  - 锁定记录追溯
- **档期预留**：
  - 内部预留档期（公司活动、培训等）
  - 预留原因说明
  - 预留期限设置
  - 预留档期不对外展示
- **档期共享**：
  - 多人员联合服务（摄影师+化妆师组合）
  - 共享档期同步（一人确认，其他人自动占用）
  - 组合套餐优惠
  - 组合人员推荐

### 5.5 动态社区
- 动态发布（图文/视频、话题标签、审核机制）
- 动态互动（点赞、评论、分享）
- 话题管理（话题创建、热门话题）
- 内容审核（敏感词过滤、违规处理）
- **模板化发片**：
  - 内置 9 宫格、对比图、横版封面模板
  - 一键套版，15 秒生成"小红书风"封面
  - 降低工作人员发片门槛
- **客片交付系统**：
  - 婚礼结束 7 天内自动创建"云相册"
  - 自动推送给新人
  - 新人确认后打款尾款
  - 减少"催片"客服量

### 5.6 评价系统
- 多维度评分（综合评分、服务态度、专业水平、性价比）
- 图文评价（文字评价、图片上传、标签快选）
- 评价管理（审核、隐藏、删除、优质评价标记）
- 数据分析（评分分布、好评率、关键词分析）
- **评价风控**：
  - 管理员手动审核（图片、文字内容）
  - 敏感词过滤（自动标记待审核）
  - 工作人员申诉通道
  - 恶意差评识别与处理机制
- **视频评价**：
  - 15 秒竖屏口碑视频
  - 瀑布流呈现
  - 管理员手动审核
- **一键问细节**：
  - 复用微信开放能力，跳转微信客服会话
  - 自动带上上下文（人员信息、档期、预算）
  - 减少用户重复打字
- **评价有礼**：
  - 评价后自动发放优惠券
  - 优惠券类型可配置（满减券、折扣券）
  - 评价奖励规则设置
- **晒单奖励**：
  - 上传照片额外奖励积分/优惠券
  - 照片数量要求（至少3张）
  - 照片质量审核
  - 优质晒单额外奖励
- **评价置顶**：
  - 优质评价自动置顶展示
  - 管理员手动置顶
  - 置顶规则配置（评分、字数、图片数）
  - 置顶标识显示

### 5.7 财务管理
- 收入报表（订单收入、支付方式分析）
- 退款管理（退款审核、退款统计）
- 成本利润（成本统计、利润分析）
- 财务对账（对账报表、数据导出）

### 5.8 营销管理
- 优惠券（创建、发放、使用统计）
- 活动管理（满减、折扣、组合优惠）
- 积分系统（积分规则、积分兑换）
- 推荐有礼（推荐奖励、关系查询）
- **社交裂变**：
  - 请帖模板带小程序码，宾客扫码点赞、打赏
  - 分享返佣（二级分销）插件
  - 社交传播数据统计与分析

### 5.9 用户管理
- 用户列表（搜索筛选、批量操作）
- 用户详情（基本信息、消费统计、订单记录）
- 用户分析（用户画像、增长分析、留存分析）
- RFM模型（用户分层、营销策略）
- **企业微信 SCRM**：
  - 用户手机号同步到企业微信
  - 支持打标签（"已到店"、"已付订金"等）
  - 群发婚礼案例
  - 提高二销转化率

### 5.10 合同与协议管理
- **合同模板管理**：
  - 合同模板创建与编辑
  - 模板变量配置（自动填充订单信息）
  - 模板版本管理
  - 模板预览与测试
- **合同归档与查询**：
  - 合同列表查询（按订单、用户、时间）
  - 合同详情查看
  - 合同下载（PDF格式）
  - 合同打印
- **违约条款自动提醒**：
  - 违约条款配置（取消时间、退款比例）
  - 自动计算违约金
  - 违约提醒通知
- **合同到期提醒**：
  - 服务日期临近提醒
  - 合同履约提醒
  - 到期自动归档

### 5.11 客户跟进与CRM
- **客户意向等级**：
  - A/B/C/D级客户分类
  - 自动评级（根据行为数据）
  - 手动调整等级
  - 等级标识显示
- **跟进记录**：
  - 通话记录（时长、内容摘要）
  - 到店记录（到店时间、接待人员）
  - 试妆记录（试妆效果、客户反馈）
  - 跟进时间轴展示
- **自动分配销售顾问**：
  - 按区域自动分配
  - 按负载均衡分配
  - 按专长匹配分配
  - 分配规则配置
- **客户流失预警**：
  - 长时间未跟进预警（超过7天）
  - 流失风险评估
  - 自动提醒销售顾问
  - 挽回策略推荐
- **客户生命周期管理**：
  - 客户阶段标识（潜在、意向、成交、复购）
  - 阶段自动流转
  - 各阶段营销策略
  - 生命周期价值分析

### 5.12 现场服务管理
- **服务签到打卡**：
  - 工作人员到场签到（GPS定位）
  - 签到时间记录
  - 迟到预警
  - 签到统计
- **现场照片实时上传**：
  - 服务过程照片上传
  - 照片自动归档到订单
  - 照片实时同步给客户
  - 照片质量检测
- **服务进度实时同步**：
  - 服务节点打卡（化妆完成、拍摄完成等）
  - 进度实时推送给客户
  - 进度可视化展示
  - 延误预警
- **突发情况上报**：
  - 现场问题快速上报
  - 问题分类（设备故障、人员缺席等）
  - 紧急联系人通知
  - 问题处理跟踪
- **现场物料清单核对**：
  - 物料清单模板
  - 出发前核对
  - 现场核对确认
  - 物料缺失预警

### 5.13 消息通知增强
- **短信通知**：
  - 重要节点短信提醒（订单确认、支付成功、服务前1天）
  - 短信模板管理
  - 短信发送记录
  - 短信余额监控
- **企业微信通知**：
  - 企业微信消息推送
  - 工作人员订单通知
  - 管理员异常预警
  - 消息模板配置
- **服务提醒**：
  - 婚期前7天提醒（准备事项）
  - 婚期前3天提醒（确认细节）
  - 婚期前1天提醒（最终确认）
  - 提醒时间可配置
- **档期变更通知**：
  - 档期修改通知
  - 档期取消通知
  - 档期释放通知（候补用户）
  - 通知方式多样（小程序、短信、企业微信）
- **支付成功通知**：
  - 用户支付成功通知
  - 工作人员收款通知
  - 管理员财务通知
  - 支付凭证推送

### 5.14 售后服务
- **售后工单系统**：
  - 工单创建（用户端、管理端）
  - 工单分类（投诉、咨询、售后）
  - 工单分配（自动/手动）
  - 工单处理流程
  - 工单状态追踪
- **投诉处理流程**：
  - 投诉提交（文字、图片、视频）
  - 投诉分级（一般、严重、紧急）
  - 投诉处理时限
  - 投诉处理结果反馈
  - 投诉统计分析
- **补拍/重拍申请**：
  - 补拍申请提交
  - 申请原因说明
  - 审核流程
  - 补拍档期安排
  - 补拍费用结算
- **服务质量回访**：
  - 自动回访任务生成
  - 回访问卷配置
  - 回访记录管理
  - 回访数据分析
  - 问题闭环处理
- **问题升级机制**：
  - 问题升级规则（超时未处理自动升级）
  - 升级通知（上级管理员）
  - 升级处理优先级
  - 升级记录追溯

### 5.15 系统设置
- 基础设置（小程序信息、公司信息）
- 业务配置（订单设置、预约规则、档期规则）
- 支付配置（支付方式、支付规则、线下支付设置）
- 内容管理（协议、轮播图、公告、帮助中心）
- 权限管理（管理员、角色、菜单权限）
- 系统管理（日志、备份、缓存、文件管理）
- **风控设置**：
  - 防跳单机制（水印、联系方式保护）
  - 内容审核配置（敏感词库、图片鉴黄开关）
  - 分布式锁配置（Redis锁超时时间、重试策略）

---

## 六、高级功能模块

### 6.1 运营增长工具

**漏斗诊断仪表盘**
- 转化漏斗：访问 → 详情页 → 加购 → 下单 → 支付
- 逐层流失率统计（同比、环比）
- 异常环节自动标红
- 优化建议推荐

**竞品价格监控**
- 爬取本地竞品小程序公开套餐价
- 每日自动更新
- 异常低价自动预警
- 价格趋势分析

**数据看板**
- 实时订单监控
- 人员业绩排行
- 财务数据统计
- 用户增长曲线

### 6.2 供给端质量管理

**服务者评级模型**
- 综合指标：接单率、差评率、退单率、响应时长
- 每月自动升降级
- 等级绑定流量位排序权重
- 评级历史记录

### 6.3 合规与存证

**申诉区块链存证**
- 申诉过程时间戳记录
- 图片 hash 存证
- 防止双方事后删改证据
- 司法效力支持

**电子凭证归档**
- 订单、退款、分账、回退四流合一
- 自动生成 OFD 电子凭证
- 接入税务数字账户
- 减少人工打印
- 支持电子签章

**数据合规**
- 用户隐私保护（数据脱敏）
- GDPR 合规（数据导出、删除权）
- 操作日志审计
- 敏感操作二次验证

---

## 七、风险控制与解决方案

### 6.1 业务风险控制

**防跳单机制**
- 风险：用户线下截屏比价，绕过平台直接联系工作人员
- 方案：
  - 工作人员联系方式脱敏显示（仅显示部分）
  - 订单确认后才显示完整联系方式
  - 图片添加平台水印
  - 建立信用评分体系，跳单行为记录黑名单

**防超卖机制**
- 风险：多端同时预约导致档期重复接单，现场无法履约
- 方案：
  - Redis 分布式锁，锁定档期查询到下单的整个流程
  - 数据库乐观锁（version 字段）
  - 下单前二次确认弹窗，实时检测档期状态
  - 超卖赔偿机制（自动推荐替代人员 + 补偿优惠券）

**评价风控机制**
- 风险：低俗图片、恶意差评影响平台形象，被投诉下架
- 方案：
  - 管理员手动审核（图片、文字内容）
  - 敏感词过滤（自定义词库，自动标记待审核）
  - 工作人员申诉通道（申诉理由 + 证据上传）
    - 申诉次数限流：同一条差评最多申诉 3 次，超过自动拒绝
    - 字段设计：`la_review_appeal.appeal_times`（申诉次数）、`la_review_appeal.max_appeal_limit=3`
  - 恶意差评识别（异常评分模式、短时间多次差评）
  - 评价审核机制（首次评价需审核，信用高的用户自动通过）

**用户流失控制**
- 风险：档期冲突时用户直接流失到竞品
- 方案：
  - 智能推荐同价位替代人员
  - 提供优惠券挽留（"该人员档期已满，选择推荐人员立减50元"）
  - 档期预约提醒（档期释放时自动通知）
  - 候补订单机制（支持排队等待档期释放）
    - 释放触发器：工作人员批量关闭/改期时，自动通知候补用户
    - 预留锁档：候补用户收到通知后，预留 15 分钟锁档时间
    - 字段设计：`la_schedule.queue_lock_until`（锁档截止时间）、`la_waitlist.notify_status`（通知状态）

**吉日冲突提醒**
- 风险：热门吉日（五一、国庆等）档期爆满，用户体验差
- 方案：
  - 实时拥堵提示：选择日期时显示"已约满%"
  - 视图聚合：`la_schedule` 聚合 `hot_date_utilization` 视图
  - 拥堵标签：红色（>80%）、黄色（50-80%）、绿色（<50%）
  - 接口设计：`/api/schedule/hotDate` 返回日期拥堵状态

### 6.2 技术风险控制

**高并发处理**
- Redis 缓存热点数据（人员信息、档期状态）
- 消息队列异步处理（订单创建、通知发送）
- 数据库读写分离、分库分表

**数据安全**
- 用户敏感信息加密存储
- API 接口签名验证
- 防 SQL 注入、XSS 攻击
- 定期数据备份

**系统稳定性**
- 服务降级策略（非核心功能降级）
- 熔断机制（第三方服务异常时熔断）
- 限流策略（接口访问频率限制）
- 监控告警（异常日志、性能指标）

**支付与分账闭环**
- 风险：已分账订单退款时，直接退款会导致微信报错
- 方案：
  - 退款前检查分账状态，已分账订单必须先调用"分账回退"接口
  - 字段设计：`la_refund.profit_sharing_returned`（分账是否已回退，布尔值）
  - 流程：检查 `profit_sharing_returned` → 调用微信 `profitsharing/return` → 标记为 true → 执行退款
  - 异常处理：分账回退失败时，记录日志并人工介入

**营销裂变结算闭环**
- 风险：婚庆服务有履约期，用户退款后佣金需回滚
- 方案：
  - 结算周期：T+90（订单完成后 90 天才可提现）
  - 退款扣除：用户退款时，自动扣除已发放的佣金
  - 字段设计：
    - `la_commission.settle_type`（结算类型：T+90）
    - `la_commission.refund_deduct`（退款扣除金额）
    - `la_commission.settle_status`（结算状态：待结算/可提现/已提现/已扣除）
  - 提现条件：订单状态="已完成" 且 过退货期（90天）

---

## 七、数据库设计

### 7.1 核心数据表（55张）

**用户相关（3张）**
- la_user - 用户表
- la_user_auth - 用户授权表
- la_user_account_log - 账户日志表

**工作人员相关（3张）**
- la_staff - 工作人员表
- la_staff_work - 作品表
- la_staff_certificate - 证书表

**服务相关（4张）**
- la_service_category - 服务分类表
- la_service_package - 服务套餐表
- la_style_tag - 风格标签表
- la_staff_tag - 标签关联表

**档期相关（4张）**
- la_schedule - 档期表
  - 新增字段：`queue_lock_until`（候补锁档截止时间）、`lock_type`（锁定类型：0=正常, 1=VIP锁定, 2=内部预留）、`lock_expire_time`（锁定到期时间）
- la_schedule_rule - 档期规则表
- la_schedule_lock - 档期锁定表（VIP客户锁定记录）
- la_schedule_share - 档期共享表（多人员联合服务）

**购物车相关（2张）**
- la_cart - 购物车表
- la_cart_plan - 购物车方案表（保存多个预约方案）

**订单相关（7张）**
- la_order - 订单主表
- la_order_item - 订单项表
- la_order_log - 订单日志表
- la_order_change - 订单变更表（改期、换人、加项记录）
- la_order_pause - 订单暂停表
- la_order_transfer - 订单转让表
- la_refund - 退款表
  - 新增字段：`profit_sharing_returned`（分账是否已回退，布尔值）

**动态社区相关（5张）**
- la_moment - 动态表
- la_moment_comment - 评论表
- la_moment_like - 点赞表
- la_moment_topic - 话题表
- la_moment_topic_relation - 话题关联表

**评价相关（4张）**
- la_review - 评价表
  - 新增字段：`is_top`（是否置顶）、`reward_given`（是否已发放奖励）
- la_review_reply - 评价回复表
- la_review_appeal - 评价申诉表
  - 新增字段：`appeal_times`（申诉次数）、`max_appeal_limit`（最大申诉次数，默认3）
- la_review_reward - 评价奖励表（评价有礼、晒单奖励记录）

**合同相关（3张）**
- la_contract - 合同表
- la_contract_template - 合同模板表
- la_contract_sign - 合同签署记录表

**CRM相关（4张）**
- la_customer - 客户表（扩展用户信息，增加意向等级）
- la_follow_record - 跟进记录表
- la_customer_assign - 客户分配表
- la_sales_advisor - 销售顾问表

**现场服务相关（4张）**
- la_service_checkin - 服务签到表
- la_service_photo - 现场照片表
- la_service_progress - 服务进度表
- la_service_material - 物料清单表

**售后相关（3张）**
- la_after_sale_ticket - 售后工单表
- la_complaint - 投诉表
- la_reshoot - 补拍/重拍申请表

**通知相关（2张）**
- la_sms_record - 短信发送记录表
- la_notification_config - 通知配置表

**其他（11张）**
- la_favorite - 收藏表
- la_coupon - 优惠券表
- la_user_coupon - 用户优惠券表
- la_activity - 活动表
- la_notice_record - 消息记录表
- la_subscribe_record - 订阅消息表
- la_config - 系统配置表
- la_dict_data - 字典数据表
- la_waitlist - 候补订单表
  - 新增字段：`notify_status`（通知状态：0=未通知, 1=已通知, 2=已下单, 3=已过期）
- la_commission - 佣金表
  - 新增字段：`settle_type`（结算类型：T+90）、`refund_deduct`（退款扣除金额）、`settle_status`（结算状态）
- la_calendar_event - 黄历事件表（存储吉日信息）

### 6.2 关键字段说明

**订单表关键字段**
- pay_way: 支付方式（1=线上微信, 2=线上余额, 3=线上组合, 4=线下支付）
- pay_voucher: 支付凭证（线下支付时上传的图片）
- pay_voucher_status: 凭证审核状态（0=待审核, 1=已通过, 2=已拒绝）
- order_status: 订单状态（0=待确认, 1=待支付, 2=已支付, 3=服务中, 4=已完成, 5=已取消, 6=已评价, 7=已暂停）
- is_paused: 是否暂停（0=否, 1=是）
- pause_reason: 暂停原因

**退款表关键字段**
- refund_way: 退款方式（1=线上退款, 2=线下退款）
- refund_voucher: 退款凭证（线下退款时管理员上传）
- refund_status: 退款状态（0=待审核, 1=审核通过, 2=审核拒绝, 3=退款中, 4=退款成功, 5=退款失败）

---

## 七、接口设计

### 7.1 小程序端接口（/api/）

**用户模块**
- POST /api/user/login - 用户登录
- GET /api/user/info - 获取用户信息
- POST /api/user/update - 更新用户信息

**人员模块**
- GET /api/staff/category - 人员分类列表
- GET /api/staff/lists - 人员列表
- GET /api/staff/detail - 人员详情
- GET /api/staff/schedule - 人员档期
- GET /api/staff/reviews - 人员评价列表

**购物车模块**
- GET /api/cart/lists - 购物车列表
- POST /api/cart/add - 加入购物车
- POST /api/cart/update - 更新购物车
- POST /api/cart/delete - 删除购物车
- POST /api/cart/checkSchedule - 检测档期冲突

**购物车模块**
- GET /api/cart/lists - 购物车列表
- POST /api/cart/add - 加入购物车
- POST /api/cart/update - 更新购物车
- POST /api/cart/delete - 删除购物车
- POST /api/cart/checkSchedule - 检测档期冲突
- POST /api/cart/savePlan - 保存方案
- GET /api/cart/planLists - 方案列表
- GET /api/cart/planCompare - 方案对比
- POST /api/cart/deletePlan - 删除方案
- GET /api/cart/calculate - 预算计算

**订单模块**
- POST /api/order/create - 创建订单
- GET /api/order/lists - 订单列表
- GET /api/order/detail - 订单详情
- POST /api/order/cancel - 取消订单
- POST /api/order/pay - 发起支付
- POST /api/order/uploadVoucher - 上传支付凭证（线下支付）
- POST /api/order/refund - 申请退款
- POST /api/order/review - 订单评价
- POST /api/order/change - 订单变更申请
- POST /api/order/pause - 订单暂停
- POST /api/order/resume - 订单恢复
- POST /api/order/transfer - 订单转让

**动态模块**
- GET /api/moment/lists - 动态列表
- GET /api/moment/detail - 动态详情
- POST /api/moment/like - 点赞动态
- POST /api/moment/comment - 评论动态
- GET /api/moment/comments - 评论列表

**工作人员端接口**
- GET /api/staff/workbench - 工作台数据
- GET /api/staff/mySchedule - 我的档期
- POST /api/staff/setSchedule - 设置档期
- POST /api/staff/batchSetSchedule - 批量设置档期
- GET /api/staff/myOrders - 我的订单
- POST /api/staff/confirmOrder - 确认订单
- POST /api/staff/rejectOrder - 拒绝订单
- POST /api/staff/publishMoment - 发布动态
- GET /api/staff/myMoments - 我的动态
- GET /api/staff/income - 收益明细

**评价模块**
- GET /api/review/lists - 评价列表
- GET /api/review/detail - 评价详情
- POST /api/review/like - 点赞评价
- POST /api/review/report - 举报评价

**合同模块**
- GET /api/contract/detail - 合同详情
- POST /api/contract/sign - 签署合同
- GET /api/contract/lists - 我的合同列表

**CRM模块**
- GET /api/customer/info - 客户信息
- GET /api/follow/lists - 跟进记录列表
- POST /api/follow/add - 添加跟进记录

**现场服务模块**
- POST /api/service/checkin - 服务签到
- POST /api/service/uploadPhoto - 上传现场照片
- POST /api/service/updateProgress - 更新服务进度
- POST /api/service/reportIssue - 上报突发情况

**售后模块**
- POST /api/afterSale/createTicket - 创建售后工单
- GET /api/afterSale/ticketLists - 工单列表
- GET /api/afterSale/ticketDetail - 工单详情
- POST /api/complaint/submit - 提交投诉
- POST /api/reshoot/apply - 申请补拍/重拍

**小程序管理员端接口**
- GET /api/admin/dashboard - 数据看板
- GET /api/admin/orderMonitor - 订单监控
- GET /api/admin/staffPerformance - 人员业绩
- POST /api/admin/toggleStaffStatus - 启用/禁用人员
- POST /api/admin/auditMoment - 审核动态

### 7.2 管理后台接口（/adminapi/）

**认证模块**
- POST /adminapi/login/account - 管理员登录
- GET /adminapi/login/admin - 获取管理员信息
- POST /adminapi/login/logout - 退出登录

**人员管理**
- GET /adminapi/staff/lists - 人员列表
- GET /adminapi/staff/detail - 人员详情
- POST /adminapi/staff/add - 添加人员
- POST /adminapi/staff/edit - 编辑人员
- POST /adminapi/staff/delete - 删除人员
- POST /adminapi/staff/toggleStatus - 启用/禁用人员

**订单管理**
- GET /adminapi/order/lists - 订单列表
- GET /adminapi/order/detail - 订单详情
- POST /adminapi/order/edit - 编辑订单
- POST /adminapi/order/updateStatus - 修改订单状态
- POST /adminapi/order/auditVoucher - 审核支付凭证
- POST /adminapi/order/auditRefund - 审核退款
- GET /adminapi/order/statistics - 订单统计

**档期管理**
- GET /adminapi/schedule/lists - 全局档期查看
- POST /adminapi/schedule/batchSet - 批量设置档期
- GET /adminapi/schedule/statistics - 档期统计
- POST /adminapi/schedule/lock - 锁定档期（VIP）
- POST /adminapi/schedule/unlock - 解锁档期
- POST /adminapi/schedule/reserve - 预留档期
- POST /adminapi/schedule/share - 档期共享设置

**动态管理**
- GET /adminapi/moment/lists - 动态列表
- GET /adminapi/moment/detail - 动态详情
- POST /adminapi/moment/audit - 审核动态
- POST /adminapi/moment/delete - 删除动态

**评价管理**
- GET /adminapi/review/lists - 评价列表
- GET /adminapi/review/detail - 评价详情
- POST /adminapi/review/audit - 审核评价
- POST /adminapi/review/hide - 隐藏评价
- POST /adminapi/review/top - 置顶评价
- POST /adminapi/review/cancelTop - 取消置顶
- GET /adminapi/review/rewardLists - 评价奖励列表

**财务管理**
- GET /adminapi/finance/income - 收入报表
- GET /adminapi/finance/refund - 退款报表
- GET /adminapi/finance/reconciliation - 财务对账

**营销管理**
- GET /adminapi/coupon/lists - 优惠券列表
- POST /adminapi/coupon/add - 添加优惠券
- POST /adminapi/coupon/send - 发放优惠券
- GET /adminapi/activity/lists - 活动列表
- POST /adminapi/activity/add - 添加活动

**用户管理**
- GET /adminapi/user/lists - 用户列表
- GET /adminapi/user/detail - 用户详情
- GET /adminapi/user/statistics - 用户统计

**合同管理**
- GET /adminapi/contract/lists - 合同列表
- GET /adminapi/contract/detail - 合同详情
- POST /adminapi/contract/add - 添加合同
- POST /adminapi/contract/delete - 删除合同
- GET /adminapi/contract/templateLists - 合同模板列表
- POST /adminapi/contract/templateAdd - 添加合同模板
- POST /adminapi/contract/templateEdit - 编辑合同模板

**CRM管理**
- GET /adminapi/customer/lists - 客户列表
- GET /adminapi/customer/detail - 客户详情
- POST /adminapi/customer/updateLevel - 更新客户等级
- POST /adminapi/customer/assign - 分配销售顾问
- GET /adminapi/follow/lists - 跟进记录列表
- POST /adminapi/follow/add - 添加跟进记录

**现场服务管理**
- GET /adminapi/service/checkinLists - 签到记录列表
- GET /adminapi/service/photoLists - 现场照片列表
- GET /adminapi/service/progressLists - 服务进度列表
- GET /adminapi/service/issueLists - 突发情况列表
- POST /adminapi/service/handleIssue - 处理突发情况

**售后管理**
- GET /adminapi/afterSale/ticketLists - 工单列表
- GET /adminapi/afterSale/ticketDetail - 工单详情
- POST /adminapi/afterSale/assignTicket - 分配工单
- POST /adminapi/afterSale/handleTicket - 处理工单
- GET /adminapi/complaint/lists - 投诉列表
- POST /adminapi/complaint/handle - 处理投诉
- GET /adminapi/reshoot/lists - 补拍申请列表
- POST /adminapi/reshoot/audit - 审核补拍申请

**通知管理**
- GET /adminapi/notification/smsLists - 短信记录列表
- POST /adminapi/notification/sendSms - 发送短信
- GET /adminapi/notification/config - 获取通知配置
- POST /adminapi/notification/setConfig - 设置通知配置

**系统设置**
- GET /adminapi/setting/getBasic - 获取基础设置
- POST /adminapi/setting/setBasic - 设置基础设置
- GET /adminapi/setting/getPayment - 获取支付配置
- POST /adminapi/setting/setPayment - 设置支付配置

---

## 八、UI设计规范

### 8.1 设计理念
- 优雅浪漫：婚庆行业特性，传递幸福与美好
- 专业可信：建立用户信任，展现服务品质
- 简洁高效：流畅的预约流程，清晰的信息架构

### 8.2 色彩系统
- 品牌主色：优雅紫 (#A855F7)
- 辅助色：柔和粉 (#F43F5E)
- 成功色：翠绿 (#10B981)
- 警告色：琥珀 (#F59E0B)
- 错误色：玫瑰红 (#EF4444)

### 8.3 字体系统
- 标题字体：Playfair Display（优雅衬线体）
- 正文字体：Inter（现代无衬线体）
- 字体大小：20rpx ~ 56rpx（基于8px网格）

### 8.4 组件规范
- 按钮：使用 TuniaoUI 的 `<tn-button>` 组件
- 输入框：使用 `<tn-input>` 组件
- 卡片：使用 `<tn-card>` 组件
- 标签：使用 `<tn-tag>` 组件
- 头像：使用 `<tn-avatar>` 组件
- 图标：使用 `<tn-icon>` 组件

### 8.5 设计原则
- 禁止使用 Emoji 作为功能图标
- 所有可交互元素必须有视觉反馈
- 避免使用会导致布局偏移的 hover 效果
- 确保浅色模式下的可读性
- 浮动导航栏留出边距

---

## 九、开发规范

### 9.1 命名规范
- 表名：`la_` 前缀 + snake_case
- 控制器：PascalCase
- API路由：kebab-case
- 前端组件：PascalCase
- 前端文件：kebab-case

### 9.2 代码规范
- 后端遵循 PSR-12 规范
- 前端使用 ESLint + Prettier
- 使用 TypeScript（前端）
- 代码注释使用中文

### 9.3 架构规范
- 后端：Controller → Logic → Service → Model
- 前端：Composition API (`<script setup lang="ts">`)
- 响应：统一 JSON 格式 (`code`, `msg`, `data`, `show`)
- 认证：Token-based authentication

---

**文档版本:** v2.3  
**创建日期:** 2026-01-19  
**更新日期:** 2026-01-23  
**维护者:** 开发团队

**v2.3 更新内容（2026-01-23）:**
- 创建服务分类重构设计文档
  - 分析当前服务分类设计问题（支持多级但实际只需扁平结构）
  - 制定分阶段重构方案（临时修复 → 逻辑简化 → 结构优化）
  - 创建 SQL 文件添加 level 字段（临时解决方案）
  - 规划后续简化工作（移除 pid、level 字段，简化树形逻辑）
  - 详细的实施步骤、风险评估、测试计划和回滚方案
- 文档位置：`doc/服务分类重构设计.md`

**v2.2 更新内容（2026-01-23）:**
- 修复优惠券使用范围设置问题
  - 添加指定分类选择器（多选下拉框）
  - 添加指定人员选择器（多选下拉框，支持搜索）
  - 集成服务分类和工作人员数据接口
  - 优化表单交互体验（根据使用范围动态显示选择器）
  - 添加提示文字说明使用范围的作用

**v2.1 更新内容（2026-01-23）:**
- 修复优惠券详情接口类型错误（TypeError: Argument #1 ($id) must be of type int, string given）
- 修复 CouponController 中 detail()、delete()、toggleStatus()、revoke() 方法的参数类型转换问题
- 在 Controller 层添加显式类型转换 (int)，确保传递给 Logic 层的参数类型正确

**v2.0 更新内容（2026-01-19）:**
- 新增合同与协议管理模块（电子签章、合同模板、违约提醒）
- 新增客户跟进与CRM模块（客户分级、跟进记录、自动分配）
- 新增现场服务管理模块（签到打卡、照片上传、进度同步）
- 新增售后服务模块（工单系统、投诉处理、补拍申请）
- 新增消息通知增强（短信、企业微信、多场景提醒）
- 购物车增加保存方案、预算计算器功能
- 订单增加变更、暂停、转让功能
- 档期增加锁定、预留、共享功能
- 评价增加有礼、晒单奖励、置顶功能
- 数据表从40张扩展到55张
- 新增30+接口支持新功能
